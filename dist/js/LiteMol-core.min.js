var __LiteMol_Core=function(){"use strict";var t;if("undefined"!=typeof window&&window&&window.Promise)t=window.Promise;else if("undefined"!=typeof global&&global&&global.Promise)t=global.Promise;else{var e={};!function(t){function e(t){return"function"==typeof t||"object"==typeof t&&null!==t}function n(t){return"function"==typeof t}function r(t){U=t}function i(t){j=t}function o(){for(var t=0;t<L;t+=2){(0,G[t])(G[t+1]),G[t]=void 0,G[t+1]=void 0}L=0}function s(t,e){var n=this,r=new this.constructor(u);void 0===r[J]&&k(r);var i=n._state;if(i){var o=arguments[i-1];j(function(){I(i,r,o,n._result)})}else _(n,r,t,e);return r}function a(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var n=new e(u);return y(n,t),n}function u(){}function c(){return new TypeError("You cannot resolve a promise with itself")}function h(){return new TypeError("A promises callback cannot return that same promise.")}function f(t){try{return t.then}catch(t){return et.error=t,et}}function d(t,e,n,r){try{t.call(e,n,r)}catch(t){return t}}function l(t,e,n){j(function(t){var r=!1,i=d(n,e,function(n){r||(r=!0,e!==n?y(t,n):v(t,n))},function(e){r||(r=!0,b(t,e))},"Settle: "+(t._label||" unknown promise"));!r&&i&&(r=!0,b(t,i))},t)}function p(t,e){e._state===$?v(t,e._result):e._state===tt?b(t,e._result):_(e,void 0,function(e){y(t,e)},function(e){b(t,e)})}function m(t,e,r){e.constructor===t.constructor&&r===W&&constructor.resolve===Q?p(t,e):r===et?b(t,et.error):void 0===r?v(t,e):n(r)?l(t,e,r):v(t,e)}function y(t,n){t===n?b(t,c()):e(n)?m(t,n,f(n)):v(t,n)}function g(t){t._onerror&&t._onerror(t._result),w(t)}function v(t,e){t._state===K&&(t._result=e,t._state=$,0!==t._subscribers.length&&j(w,t))}function b(t,e){t._state===K&&(t._state=tt,t._result=e,j(g,t))}function _(t,e,n,r){var i=t._subscribers,o=i.length;t._onerror=null,i[o]=e,i[o+$]=n,i[o+tt]=r,0===o&&t._state&&j(w,t)}function w(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r,i,o=t._result,s=0;s<e.length;s+=3)r=e[s],i=e[s+n],r?I(n,r,i,o):i(o);t._subscribers.length=0}}function x(){this.error=null}function C(t,e){try{return t(e)}catch(t){return nt.error=t,nt}}function I(t,e,r,i){var o,s,a,u,c=n(r);if(c){if(o=C(r,i),o===nt?(u=!0,s=o.error,o=null):a=!0,e===o)return void b(e,h())}else o=i,a=!0;e._state!==K||(c&&a?y(e,o):u?b(e,s):t===$?v(e,o):t===tt&&b(e,o))}function S(t,e){try{e(function(e){y(t,e)},function(e){b(t,e)})}catch(e){b(t,e)}}function A(){return rt++}function k(t){t[J]=rt++,t._state=void 0,t._result=void 0,t._subscribers=[]}function E(t){return new ut(this,t).promise}function P(t){var e=this;return new e(z(t)?function(n,r){for(var i=t.length,o=0;o<i;o++)e.resolve(t[o]).then(n,r)}:function(t,e){e(new TypeError("You must pass an array to race."))})}function T(t){var e=this,n=new e(u);return b(n,t),n}function F(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function D(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function M(t){this[J]=A(),this._result=this._state=void 0,this._subscribers=[],u!==t&&("function"!=typeof t&&F(),this instanceof M?S(this,t):D())}function N(t,e){this._instanceConstructor=t,this.promise=new t(u),this.promise[J]||k(this.promise),Array.isArray(e)?(this._input=e,this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?v(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&v(this.promise,this._result))):b(this.promise,R())}function R(){return new Error("Array Methods must be provided an Array")}function O(){var t;if("undefined"!=typeof global)t=global;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;e&&"[object Promise]"===Object.prototype.toString.call(e.resolve())&&!e.cast||(t.Promise=at)}var q;q=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var U,B,z=q,L=0,j=function(t,e){G[L]=t,G[L+1]=e,2===(L+=2)&&(U?U(o):B())},V="undefined"!=typeof window?window:void 0,X=V||{},Y=X.MutationObserver||X.WebKitMutationObserver,Z="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),H="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,G=new Array(1e3);B=Z?function(){return function(){process.nextTick(o)}}():Y?function(){var t=0,e=new Y(o),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}():H?function(){var t=new MessageChannel;return t.port1.onmessage=o,function(){t.port2.postMessage(0)}}():function(){return function(){setTimeout(o,1)}}();var W=s,Q=a,J=Math.random().toString(36).substring(16),K=void 0,$=1,tt=2,et=new x,nt=new x,rt=0,it=E,ot=P,st=T,at=M;M.all=it,M.race=ot,M.resolve=Q,M.reject=st,M._setScheduler=r,M._setAsap=i,M._asap=j,M.prototype={constructor:M,then:W,catch:function(t){return this.then(null,t)}};var ut=N;N.prototype._enumerate=function(){for(var t=this.length,e=this._input,n=0;this._state===K&&n<t;n++)this._eachEntry(e[n],n)},N.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,r=n.resolve;if(r===Q){var i=f(t);if(i===W&&t._state!==K)this._settledAt(t._state,e,t._result);else if("function"!=typeof i)this._remaining--,this._result[e]=t;else if(n===at){var o=new n(u);m(o,t,i),this._willSettleAt(o,e)}else this._willSettleAt(new n(function(e){e(t)}),e)}else this._willSettleAt(r(t),e)},N.prototype._settledAt=function(t,e,n){var r=this.promise;r._state===K&&(this._remaining--,t===tt?b(r,n):this._result[e]=n),0===this._remaining&&v(r,this._result)},N.prototype._willSettleAt=function(t,e){var n=this;_(t,void 0,function(t){n._settledAt($,e,t)},function(t){n._settledAt(tt,e,t)})};var ct=O,ht={Promise:at,polyfill:ct};ct(),t.ES6Promise=ht}(e),t=e.ES6Promise.Promise}var n={};(function(t,e,n){function r(t){return t&&t.Object===Object?t:null}function i(t){for(var e=t.length,n=new Array(e),r=0;r<e;r++)n[r]=t[r];return n}function o(t){return function(){try{return t.apply(this,arguments)}catch(t){return Ct.e=t,Ct}}}function s(t){throw t}function a(t,e){if(St&&e.stack&&"object"==typeof t&&null!==t&&t.stack&&t.stack.indexOf(Pt)===-1){for(var n=[],r=e;r;r=r.source)r.stack&&n.unshift(r.stack);n.unshift(t.stack);var i=n.join("\n"+Pt+"\n");t.stack=u(i)}}function u(t){for(var e=t.split("\n"),n=[],r=0,i=e.length;r<i;r++){var o=e[r];c(o)||h(o)||!o||n.push(o)}return n.join("\n")}function c(t){var e=d(t);if(!e)return!1;var n=e[0],r=e[1];return n===kt&&r>=Et&&r<=oi}function h(t){return t.indexOf("(module.js:")!==-1||t.indexOf("(node.js:")!==-1}function f(){if(St)try{throw new Error}catch(r){var t=r.stack.split("\n"),e=t[0].indexOf("@")>0?t[1]:t[2],n=d(e);if(!n)return;return kt=n[0],n[1]}}function d(t){var e=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(t);if(e)return[e[1],Number(e[2])];var n=/at ([^ ]+):(\d+):(?:\d+)$/.exec(t);if(n)return[n[1],Number(n[2])];var r=/.*@(.+):(\d+)$/.exec(t);return r?[r[1],Number(r[2])]:void 0}function l(t,e,r,i,o,s){var a=ne(t),u=a.length;if(u!==ne(e).length&&!i)return!1;for(var c,h=u;h--;)if(c=a[h],!(i?c in e:$t.call(e,c)))return!1;for(var f=i;++h<u;){c=a[h];var d=t[c],l=e[c];if(!(void 0===n?r(d,l,i,o,s):void 0))return!1;f||(f="constructor"===c)}if(!f){var p=t.constructor,m=e.constructor;if(p!==m&&"constructor"in t&&"constructor"in e&&!("function"==typeof p&&p instanceof p&&"function"==typeof m&&m instanceof m))return!1}return!0}function p(t,e,n){switch(n){case Xt:case Yt:return+t==+e;case Zt:return t.name===e.name&&t.message===e.message;case Ht:return t!==+t?e!==+e:t===+e;case Wt:case Qt:return t===e+""}return!1}function m(t){return!!t&&"object"==typeof t}function y(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=ee}function g(t){return m(t)&&y(t.length)&&!!Jt[te.call(t)]}function v(t,e){for(var n=-1,r=t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}function b(t,e,r,i,o,s){var a=-1,u=t.length,c=e.length;if(u!==c&&!(i&&c>u))return!1;for(;++a<u;){var h=t[a],f=e[a];if(void 0!==n)return!1;if(i){if(!v(e,function(t){return h===t||r(h,t,i,o,s)}))return!1}else if(h!==f&&!r(h,f,i,o,s))return!1}return!0}function _(t,e,n,r,i,o){var s=oe(t),a=oe(e),u=Vt,c=Vt;s||(u=te.call(t),u===jt?u=Gt:u!==Gt&&(s=g(t))),a||(c=te.call(e))===jt&&(c=Gt);var h=u===Gt&&!ie(t),f=c===Gt&&!ie(e),d=u===c;if(d&&!s&&!h)return p(t,e,u);if(!r){var m=h&&$t.call(t,"__wrapped__"),y=f&&$t.call(e,"__wrapped__");if(m||y)return n(m?t.value():t,y?e.value():e,r,i,o)}if(!d)return!1;i||(i=[]),o||(o=[]);for(var v=i.length;v--;)if(i[v]===t)return o[v]===e;i.push(t),o.push(e);var _=(s?b:l)(t,e,n,r,i,o);return i.pop(),o.pop(),_}function w(t,e,n,r,i){return t===e||(null==t||null==e||!re(t)&&!m(e)?t!==t&&e!==e:_(t,e,w,n,r,i))}function x(t,e){for(var n=new Array(t),r=0;r<t;r++)n[r]=e();return n}function C(t,e){this.id=t,this.value=e}function I(t){this._s=t,this.isDisposed=!1}function S(t){this._s=t}function A(t){this._s=t,this._l=t.length,this._i=0}function k(t){this._a=t}function E(t){this._a=t,this._l=D(t),this._i=0}function P(t){return"number"==typeof t&&lt.isFinite(t)}function T(t){var e,r=t[Ot];if(!r&&"string"==typeof t)return e=new S(t),e[Ot]();if(!r&&t.length!==n)return e=new k(t),e[Ot]();if(!r)throw new TypeError("Object is not iterable");return t[Ot]()}function F(t){var e=+t;return 0===e?e:isNaN(e)?e:e<0?-1:1}function D(t){var e=+t.length;return isNaN(e)?0:0!==e&&P(e)?(e=F(e)*Math.floor(Math.abs(e)),e<=0?0:e>mn?mn:e):e}function M(t,e){return Ie(t)||(t=Te),new gn(e,t)}function N(t,e){this.observer=t,this.parent=e}function R(){return!1}function O(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e}function R(){return!1}function O(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e}function R(){return!1}function q(){return[]}function R(){return!1}function q(){return[]}function O(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e}function U(t){return function(e){return t.subscribe(e)}}function B(t){return{"@@iterator":function(){return{next:function(){return{done:!1,value:t}}}}}}function B(t){return{"@@iterator":function(){return{next:function(){return{done:!1,value:t}}}}}}function z(t,e){return function(r){for(var i=r,o=0;o<e;o++){var s=i[t[o]];if(void 0===s)return n;i=s}return i}}function L(t,e,n,r){var i=new ei;return r.push(j(i,e,n)),t.apply(e,r),i.asObservable()}function j(t,e,n){return function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];if(xt(n)){if((i=It(n).apply(e,i))===Ct)return t.onError(i.e);t.onNext(i)}else i.length<=1?t.onNext(i[0]):t.onNext(i);t.onCompleted()}}function V(t,e,n,r){var i=new ei;return r.push(X(i,e,n)),t.apply(e,r),i.asObservable()}function X(t,e,n){return function(){var r=arguments[0];if(r)return t.onError(r);for(var i=arguments.length,o=[],s=1;s<i;s++)o[s-1]=arguments[s];if(xt(n)){var o=It(n).apply(e,o);if(o===Ct)return t.onError(o.e);t.onNext(o)}else o.length<=1?t.onNext(o[0]):t.onNext(o);t.onCompleted()}}function Y(t){return lt.StaticNodeList?t instanceof lt.StaticNodeList||t instanceof lt.NodeList:"[object NodeList]"===Object.prototype.toString.call(t)}function Z(t,e,n){this._e=t,this._n=e,this._fn=n,this._e.addEventListener(this._n,this._fn,!1),this.isDisposed=!1}function H(t,e,n){var r=new ce,i=Object.prototype.toString.call(t);if(Y(t)||"[object HTMLCollection]"===i)for(var o=0,s=t.length;o<s;o++)r.add(H(t.item(o),e,n));else t&&r.add(new Z(t,e,n));return r}function G(t,e){return new Or(t,e)}function W(t,e,n){return new Jr(function(r){var i=t,o=Ce(e);return n.scheduleRecursiveFuture(0,i,function(t,e){if(o>0){var s=n.now();i=new Date(i.getTime()+o),i.getTime()<=s&&(i=new Date(s+o))}r.onNext(t),e(t+1,new Date(i))})})}function Q(t,e,n){return t===e?new Jr(function(t){return n.schedulePeriodic(0,e,function(e){return t.onNext(e),e+1})}):hn(function(){return W(new Date(n.now()+t),e,n)})}function J(t,e,n){return new Jr(function(r){var i,o=!1,s=new ve,a=null,u=[],c=!1;return i=t.materialize().timestamp(n).subscribe(function(t){var i,h;"E"===t.value.kind?(u=[],u.push(t),a=t.value.error,h=!c):(u.push({value:t.value,timestamp:t.timestamp+e}),h=!o,o=!0),h&&(null!==a?r.onError(a):(i=new ge,s.setDisposable(i),i.setDisposable(n.scheduleRecursiveFuture(null,e,function(t,e){var i,s,h,f;if(null===a){c=!0;do{h=null,u.length>0&&u[0].timestamp-n.now()<=0&&(h=u.shift().value),null!==h&&h.accept(r)}while(null!==h);f=!1,s=0,u.length>0?(f=!0,s=Math.max(0,u[0].timestamp-n.now())):o=!1,i=a,c=!1,null!==i?r.onError(i):f&&e(null,s)}}))))}),new be(i,s)},t)}function K(t,e,n){return hn(function(){return J(t,e-n.now(),n)})}function $(t,e,n){var r,i;return xt(e)?i=e:(r=e,i=n),new Jr(function(e){function n(){u.setDisposable(t.subscribe(function(t){var n=It(i)(t);if(n===Ct)return e.onError(n.e);var r=new ge;s.add(r),r.setDisposable(n.subscribe(function(){e.onNext(t),s.remove(r),o()},function(t){e.onError(t)},function(){e.onNext(t),s.remove(r),o()}))},function(t){e.onError(t)},function(){a=!0,u.dispose(),o()}))}function o(){a&&0===s.length&&e.onCompleted()}var s=new ce,a=!1,u=new ve;return r?u.setDisposable(r.subscribe(n,function(t){e.onError(t)},n)):n(),new be(u,s)},t)}function tt(t,e){return new Jr(function(n){var r,i=!1,o=new ve,s=0;return new be(t.subscribe(function(t){var a=It(e)(t);if(a===Ct)return n.onError(a.e);wt(a)&&(a=Dr(a)),i=!0,r=t,s++;var u=s,c=new ge;o.setDisposable(c),c.setDisposable(a.subscribe(function(){i&&s===u&&n.onNext(r),i=!1,c.dispose()},function(t){n.onError(t)},function(){i&&s===u&&n.onNext(r),i=!1,c.dispose()}))},function(t){o.dispose(),n.onError(t),i=!1,s++},function(){o.dispose(),i&&n.onNext(r),n.onCompleted(),i=!1,s++}),o)},t)}function et(t,e,n,r){return xt(e)&&(r=n,n=e,e=wn()),Qe.isObservable(r)||(r=kn(new Yr)),new Jr(function(i){function o(t){function e(){return f=n===h}var n=h,o=new ge;u.setDisposable(o),o.setDisposable(t.subscribe(function(){e()&&a.setDisposable(r.subscribe(i)),o.dispose()},function(t){e()&&i.onError(t)},function(){e()&&a.setDisposable(r.subscribe(i))}))}function s(){var t=!f;return t&&h++,t}var a=new ve,u=new ve,c=new ge;a.setDisposable(c);var h=0,f=!1;return o(e),c.setDisposable(t.subscribe(function(t){if(s()){i.onNext(t);var e=It(n)(t);if(e===Ct)return i.onError(e.e);o(wt(e)?Dr(e):e)}},function(t){s()&&i.onError(t)},function(){s()&&i.onCompleted()})),new be(a,u)},t)}function nt(t,e,n,r){return Ie(n)&&(r=n,n=kn(new Yr)),n instanceof Error&&(n=kn(n)),Ie(r)||(r=Re),Qe.isObservable(n)||(n=kn(new Yr)),new Jr(function(i){function o(){var t=s;h.setDisposable(r.scheduleFuture(null,e,function(){(c=s===t)&&(wt(n)&&(n=Dr(n)),u.setDisposable(n.subscribe(i)))}))}var s=0,a=new ge,u=new ve,c=!1,h=new ve;return u.setDisposable(a),o(),a.setDisposable(t.subscribe(function(t){c||(s++,i.onNext(t),o())},function(t){c||(s++,i.onError(t))},function(){c||(s++,i.onCompleted())})),new be(u,h)},t)}function rt(t,e,n){return new Jr(function(r){function i(t,e){if(c[e]=t,s[e]=!0,a||(a=s.every(yt))){if(o)return r.onError(o);var i=It(n).apply(null,c);if(i===Ct)return r.onError(i.e);r.onNext(i)}u&&c[1]&&r.onCompleted()}var o,s=[!1,!1],a=!1,u=!1,c=new Array(2);return new be(t.subscribe(function(t){i(t,0)},function(t){c[1]?r.onError(t):o=t},function(){u=!0,c[1]&&r.onCompleted()}),e.subscribe(function(t){i(t,1)},function(t){r.onError(t)},function(){u=!0,i(!0,1)}))},t)}function it(t){return{"@@transducer/init":function(){return t},"@@transducer/step":function(t,e){return t.onNext(e)},"@@transducer/result":function(t){return t.onCompleted()}}}var ot={function:!0,object:!0},st=ot[typeof exports]&&exports&&!exports.nodeType?exports:null,at=ot[typeof module]&&module&&!module.nodeType?module:null,ut=r(st&&at&&"object"==typeof global&&global),ct=r(ot[typeof self]&&self),ht=r(ot[typeof window]&&window),ft=at&&at.exports===st?st:null,dt=r(ot[typeof this]&&this),lt=ut||ht!==(dt&&dt.window)&&ht||ct||dt||Function("return this")(),pt={internals:{},config:{Promise:e},helpers:{}},mt=pt.helpers.noop=function(){},yt=pt.helpers.identity=function(t){return t},gt=pt.helpers.defaultNow=Date.now,vt=pt.helpers.defaultComparer=function(t,e){return se(t,e)},bt=pt.helpers.defaultSubComparer=function(t,e){return t>e?1:t<e?-1:0},_t=(pt.helpers.defaultKeySerializer=function(t){return t.toString()},pt.helpers.defaultError=function(t){throw t}),wt=pt.helpers.isPromise=function(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then},xt=pt.helpers.isFunction=function(){var t=function(t){return"function"==typeof t||!1};return t(/x/)&&(t=function(t){return"function"==typeof t&&"[object Function]"==toString.call(t)}),t}(),Ct={e:{}},It=pt.internals.tryCatch=function(t){if(!xt(t))throw new TypeError("fn must be a function");return o(t)};pt.config.longStackSupport=!1;var St=!1,At=It(function(){throw new Error})();St=!!At.e&&!!At.e.stack;var kt,Et=f(),Pt="From previous event:",Tt=pt.EmptyError=function(){this.message="Sequence contains no elements.",Error.call(this)};Tt.prototype=Object.create(Error.prototype),Tt.prototype.name="EmptyError";var Ft=pt.ObjectDisposedError=function(){this.message="Object has been disposed",Error.call(this)};Ft.prototype=Object.create(Error.prototype),Ft.prototype.name="ObjectDisposedError";var Dt=pt.ArgumentOutOfRangeError=function(){this.message="Argument out of range",Error.call(this)};Dt.prototype=Object.create(Error.prototype),Dt.prototype.name="ArgumentOutOfRangeError";var Mt=pt.NotSupportedError=function(t){this.message=t||"This operation is not supported",Error.call(this)};Mt.prototype=Object.create(Error.prototype),Mt.prototype.name="NotSupportedError";var Nt=pt.NotImplementedError=function(t){this.message=t||"This operation is not implemented",Error.call(this)};Nt.prototype=Object.create(Error.prototype),Nt.prototype.name="NotImplementedError";var Rt=pt.helpers.notImplemented=function(){throw new Nt},Ot=(pt.helpers.notSupported=function(){throw new Mt},"function"==typeof Symbol&&Symbol.iterator||"_es6shim_iterator_");lt.Set&&"function"==typeof(new lt.Set)["@@iterator"]&&(Ot="@@iterator");var qt=pt.doneEnumerator={done:!0,value:n},Ut=pt.helpers.isIterable=function(t){return t&&t[Ot]!==n},Bt=pt.helpers.isArrayLike=function(t){return t&&t.length!==n};pt.helpers.iterator=Ot;var zt=pt.internals.bindCallback=function(t,e,n){if(void 0===e)return t;switch(n){case 0:return function(){return t.call(e)};case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}},Lt=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],jt=(Lt.length,"[object Arguments]"),Vt="[object Array]",Xt="[object Boolean]",Yt="[object Date]",Zt="[object Error]",Ht="[object Number]",Gt="[object Object]",Wt="[object RegExp]",Qt="[object String]",Jt={};Jt["[object Float32Array]"]=Jt["[object Float64Array]"]=Jt["[object Int8Array]"]=Jt["[object Int16Array]"]=Jt["[object Int32Array]"]=Jt["[object Uint8Array]"]=Jt["[object Uint8ClampedArray]"]=Jt["[object Uint16Array]"]=Jt["[object Uint32Array]"]=!0,Jt[jt]=Jt[Vt]=Jt["[object ArrayBuffer]"]=Jt[Xt]=Jt[Yt]=Jt[Zt]=Jt["[object Function]"]=Jt["[object Map]"]=Jt[Ht]=Jt[Gt]=Jt[Wt]=Jt["[object Set]"]=Jt[Qt]=Jt["[object WeakMap]"]=!1;var Kt=Object.prototype,$t=Kt.hasOwnProperty,te=Kt.toString,ee=Math.pow(2,53)-1,ne=Object.keys||function(){var t=Object.prototype.hasOwnProperty,e=!{toString:null}.propertyIsEnumerable("toString"),n=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],r=n.length;return function(i){if("object"!=typeof i&&("function"!=typeof i||null===i))throw new TypeError("Object.keys called on non-object");var o,s,a=[];for(o in i)t.call(i,o)&&a.push(o);if(e)for(s=0;s<r;s++)t.call(i,n[s])&&a.push(n[s]);return a}}(),re=pt.internals.isObject=function(t){var e=typeof t;return!!t&&("object"===e||"function"===e)},ie=function(){try{Object({toString:0}+"")}catch(t){return function(){return!1}}return function(t){return"function"!=typeof t.toString&&"string"==typeof(t+"")}}(),oe=Array.isArray||function(t){return m(t)&&y(t.length)&&te.call(t)===Vt},se=pt.internals.isEqual=function(t,e){return w(t,e)},ae=({}.hasOwnProperty,Array.prototype.slice,pt.internals.inherits=function(t,e){function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n}),ue=pt.internals.addProperties=function(t){for(var e=[],n=1,r=arguments.length;n<r;n++)e.push(arguments[n]);for(var i=0,o=e.length;i<o;i++){var s=e[i];for(var a in s)t[a]=s[a]}},ce=(pt.internals.addRef=function(t,e){return new Jr(function(n){return new be(e.getDisposable(),t.subscribe(n))})},pt.CompositeDisposable=function(){var t,e,n=[];if(Array.isArray(arguments[0]))n=arguments[0];else for(e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];this.disposables=n,this.isDisposed=!1,this.length=n.length}),he=ce.prototype;he.add=function(t){this.isDisposed?t.dispose():(this.disposables.push(t),this.length++)},he.remove=function(t){var e=!1;if(!this.isDisposed){var n=this.disposables.indexOf(t);n!==-1&&(e=!0,this.disposables.splice(n,1),this.length--,t.dispose())}return e},he.dispose=function(){if(!this.isDisposed){this.isDisposed=!0;for(var t=this.disposables.length,e=new Array(t),n=0;n<t;n++)e[n]=this.disposables[n];for(this.disposables=[],this.length=0,n=0;n<t;n++)e[n].dispose()}};var fe=pt.Disposable=function(t){this.isDisposed=!1,this.action=t||mt};fe.prototype.dispose=function(){this.isDisposed||(this.action(),this.isDisposed=!0)};var de=fe.create=function(t){return new fe(t)},le=fe.empty={dispose:mt},pe=fe.isDisposable=function(t){return t&&xt(t.dispose)},me=fe.checkDisposed=function(t){if(t.isDisposed)throw new Ft},ye=fe._fixup=function(t){return pe(t)?t:le},ge=pt.SingleAssignmentDisposable=function(){this.isDisposed=!1,this.current=null};ge.prototype.getDisposable=function(){return this.current},ge.prototype.setDisposable=function(t){if(this.current)throw new Error("Disposable has already been assigned");var e=this.isDisposed;!e&&(this.current=t),e&&t&&t.dispose()},ge.prototype.dispose=function(){if(!this.isDisposed){this.isDisposed=!0;var t=this.current;this.current=null,t&&t.dispose()}};var ve=pt.SerialDisposable=function(){this.isDisposed=!1,this.current=null};ve.prototype.getDisposable=function(){return this.current},ve.prototype.setDisposable=function(t){var e=this.isDisposed;if(!e){var n=this.current;this.current=t}n&&n.dispose(),e&&t&&t.dispose()},ve.prototype.dispose=function(){if(!this.isDisposed){this.isDisposed=!0;var t=this.current;this.current=null}t&&t.dispose()};var be=pt.BinaryDisposable=function(t,e){this._first=t,this._second=e,this.isDisposed=!1};be.prototype.dispose=function(){if(!this.isDisposed){this.isDisposed=!0;var t=this._first;this._first=null,t&&t.dispose();var e=this._second;this._second=null,e&&e.dispose()}};var _e=pt.NAryDisposable=function(t){this._disposables=t,this.isDisposed=!1};_e.prototype.dispose=function(){if(!this.isDisposed){this.isDisposed=!0;for(var t=0,e=this._disposables.length;t<e;t++)this._disposables[t].dispose();this._disposables.length=0}};var we=(pt.RefCountDisposable=function(){function t(t){this.disposable=t,this.disposable.count++,this.isInnerDisposed=!1}function e(t){this.underlyingDisposable=t,this.isDisposed=!1,this.isPrimaryDisposed=!1,this.count=0}return t.prototype.dispose=function(){this.disposable.isDisposed||this.isInnerDisposed||(this.isInnerDisposed=!0,0===--this.disposable.count&&this.disposable.isPrimaryDisposed&&(this.disposable.isDisposed=!0,this.disposable.underlyingDisposable.dispose()))},e.prototype.dispose=function(){this.isDisposed||this.isPrimaryDisposed||(this.isPrimaryDisposed=!0,0===this.count&&(this.isDisposed=!0,this.underlyingDisposable.dispose()))},e.prototype.getDisposable=function(){return this.isDisposed?le:new t(this)},e}(),pt.internals.ScheduledItem=function(t,e,n,r,i){this.scheduler=t,this.state=e,this.action=n,this.dueTime=r,this.comparer=i||bt,this.disposable=new ge});we.prototype.invoke=function(){this.disposable.setDisposable(this.invokeCore())},we.prototype.compareTo=function(t){return this.comparer(this.dueTime,t.dueTime)},we.prototype.isCancelled=function(){return this.disposable.isDisposed},we.prototype.invokeCore=function(){return ye(this.action(this.scheduler,this.state))};var xe=pt.Scheduler=function(){function t(){}t.isScheduler=function(e){return e instanceof t};var e=t.prototype;return e.schedule=function(t,e){throw new Nt},e.scheduleFuture=function(e,n,r){var i=n;return i instanceof Date&&(i-=this.now()),i=t.normalize(i),0===i?this.schedule(e,r):this._scheduleFuture(e,i,r)},e._scheduleFuture=function(t,e,n){throw new Nt},t.now=gt,t.prototype.now=gt,t.normalize=function(t){return t<0&&(t=0),t},t}(),Ce=xe.normalize,Ie=xe.isScheduler;!function(t){function e(t,e){function n(e){function r(t,e){return s?o.remove(u):a=!0,i(e,n),le}var s=!1,a=!1,u=t.schedule(e,r);a||(o.add(u),s=!0)}var r=e[0],i=e[1],o=new ce;return i(r,n),o}function n(t,e){function n(e,r){function s(t,e){return a?o.remove(c):u=!0,i(e,n),le}var a=!1,u=!1,c=t.scheduleFuture(e,r,s);u||(o.add(c),a=!0)}var r=e[0],i=e[1],o=new ce;return i(r,n),o}t.scheduleRecursive=function(t,n){return this.schedule([t,n],e)},t.scheduleRecursiveFuture=function(t,e,r){return this.scheduleFuture([t,r],e,n)}}(xe.prototype),function(t){t.schedulePeriodic=function(t,e,n){if(void 0===lt.setInterval)throw new Mt;e=Ce(e);var r=t,i=lt.setInterval(function(){r=n(r)},e);return de(function(){lt.clearInterval(i)})}}(xe.prototype);var Se,Ae,ke=function(t){function e(){t.call(this)}return ae(e,t),e.prototype.schedule=function(t,e){return ye(e(this,t))},e}(xe),Ee=xe.immediate=new ke,Pe=function(t){function e(){for(;r.length>0;){var t=r.dequeue();!t.isCancelled()&&t.invoke()}}function n(){t.call(this)}var r;return ae(n,t),n.prototype.schedule=function(t,n){var i=new we(this,t,n,this.now());if(r)r.enqueue(i);else{r=new Oe(4),r.enqueue(i);var o=It(e)();r=null,o===Ct&&s(o.e)}return i.disposable},n.prototype.scheduleRequired=function(){return!r},n}(xe),Te=xe.currentThread=new Pe,Fe=(pt.internals.SchedulePeriodicRecursive=function(){function t(t){return function(e,n){n(0,t._period);var r=It(t._action)(t._state);r===Ct&&(t._cancel.dispose(),s(r.e)),t._state=r}}function e(t,e,n,r){this._scheduler=t,this._state=e,this._period=n,this._action=r}return e.prototype.start=function(){var e=new ge;return this._cancel=e,e.setDisposable(this._scheduler.scheduleRecursiveFuture(0,this._period,t(this))),e},e}(),function(){var t,e=mt;if(lt.setTimeout)t=lt.setTimeout,e=lt.clearTimeout;else{if(!lt.WScript)throw new Mt;t=function(t,e){lt.WScript.Sleep(e),t()}}return{setTimeout:t,clearTimeout:e}}()),De=Fe.setTimeout,Me=Fe.clearTimeout;!function(){function t(e){if(r)De(function(){t(e)},0);else{var i=n[e];if(i){r=!0;var o=It(i)();Ae(e),r=!1,o===Ct&&s(o.e)}}}var e=1,n={},r=!1;Ae=function(t){delete n[t]};var i=new RegExp("^"+String(toString).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),o="function"==typeof(o=ut&&ft&&ut.setImmediate)&&!i.test(o)&&o;if(xt(o))Se=function(r){var i=e++;return n[i]=r,o(function(){t(i)}),i};else if("undefined"!=typeof process&&"[object process]"==={}.toString.call(process))Se=function(r){var i=e++;return n[i]=r,process.nextTick(function(){t(i)}),i};else if(function(){if(!lt.postMessage||lt.importScripts)return!1;var t=!1,e=lt.onmessage;return lt.onmessage=function(){t=!0},lt.postMessage("","*"),lt.onmessage=e,t}()){var a="ms.rx.schedule"+Math.random(),u=function(e){"string"==typeof e.data&&e.data.substring(0,a.length)===a&&t(e.data.substring(a.length))};lt.addEventListener("message",u,!1),Se=function(t){var r=e++;return n[r]=t,lt.postMessage(a+r,"*"),r}}else if(lt.MessageChannel){var c=new lt.MessageChannel;c.port1.onmessage=function(e){t(e.data)},Se=function(t){var r=e++;return n[r]=t,c.port2.postMessage(r),r}}else Se="document"in lt&&"onreadystatechange"in lt.document.createElement("script")?function(r){var i=lt.document.createElement("script"),o=e++;return n[o]=r,i.onreadystatechange=function(){t(o),i.onreadystatechange=null,i.parentNode.removeChild(i),i=null},lt.document.documentElement.appendChild(i),o}:function(r){var i=e++;return n[i]=r,De(function(){t(i)},0),i}}();var Ne=function(t){function e(){t.call(this)}function n(t,e,n,r){return function(){t.setDisposable(fe._fixup(e(n,r)))}}function r(t){this._id=t,this.isDisposed=!1}function i(t){this._id=t,this.isDisposed=!1}function o(t,e,n){return function(){e(t,n)}}return ae(e,t),r.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,Ae(this._id))},i.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,Me(this._id))},e.prototype.schedule=function(t,e){var i=new ge;return new be(i,new r(Se(n(i,e,this,t))))},e.prototype._scheduleFuture=function(t,e,r){if(0===e)return this.schedule(t,r);var o=new ge;return new be(o,new i(De(n(o,r,this,t),e)))},e.prototype.scheduleLongRunning=function(t,e){var n=de(mt);return Se(o(t,e,n)),n},e}(xe),Re=xe.default=xe.async=new Ne;C.prototype.compareTo=function(t){var e=this.value.compareTo(t.value);return 0===e&&(e=this.id-t.id),e};var Oe=pt.internals.PriorityQueue=function(t){this.items=new Array(t),this.length=0},qe=Oe.prototype;qe.isHigherPriority=function(t,e){return this.items[t].compareTo(this.items[e])<0},qe.percolate=function(t){if(!(t>=this.length||t<0)){var e=t-1>>1;if(!(e<0||e===t)&&this.isHigherPriority(t,e)){var n=this.items[t];this.items[t]=this.items[e],this.items[e]=n,this.percolate(e)}}},qe.heapify=function(t){if(+t||(t=0),!(t>=this.length||t<0)){var e=2*t+1,n=2*t+2,r=t;if(e<this.length&&this.isHigherPriority(e,r)&&(r=e),n<this.length&&this.isHigherPriority(n,r)&&(r=n),r!==t){var i=this.items[t];this.items[t]=this.items[r],this.items[r]=i,this.heapify(r)}}},qe.peek=function(){return this.items[0].value},qe.removeAt=function(t){this.items[t]=this.items[--this.length],this.items[this.length]=n,this.heapify()},qe.dequeue=function(){var t=this.peek();return this.removeAt(0),t},qe.enqueue=function(t){var e=this.length++;this.items[e]=new C(Oe.count++,t),this.percolate(e)},qe.remove=function(t){for(var e=0;e<this.length;e++)if(this.items[e].value===t)return this.removeAt(e),!0;return!1},Oe.count=0;var Ue,Be=pt.Notification=function(){function t(){}return t.prototype._accept=function(t,e,n){throw new Nt},t.prototype._acceptObserver=function(t,e,n){throw new Nt},t.prototype.accept=function(t,e,n){return t&&"object"==typeof t?this._acceptObserver(t):this._accept(t,e,n)},t.prototype.toObservable=function(t){var e=this;return Ie(t)||(t=Ee),new Jr(function(n){return t.schedule(e,function(t,e){e._acceptObserver(n),"N"===e.kind&&n.onCompleted()})})},t}(),ze=function(t){function e(t){this.value=t,this.kind="N"}return ae(e,t),e.prototype._accept=function(t){return t(this.value)},e.prototype._acceptObserver=function(t){return t.onNext(this.value)},e.prototype.toString=function(){return"OnNext("+this.value+")"},e}(Be),Le=function(t){function e(t){this.error=t,this.kind="E"}return ae(e,t),e.prototype._accept=function(t,e){return e(this.error)},e.prototype._acceptObserver=function(t){return t.onError(this.error)},e.prototype.toString=function(){return"OnError("+this.error+")"},e}(Be),je=function(t){function e(){this.kind="C"}return ae(e,t),e.prototype._accept=function(t,e,n){return n()},e.prototype._acceptObserver=function(t){return t.onCompleted()},e.prototype.toString=function(){return"OnCompleted()"},e}(Be),Ve=Be.createOnNext=function(t){return new ze(t)},Xe=Be.createOnError=function(t){return new Le(t)},Ye=Be.createOnCompleted=function(){return new je},Ze=pt.Observer=function(){},He=Ze.create=function(t,e,n){return t||(t=mt),e||(e=_t),n||(n=mt),new We(t,e,n)},Ge=pt.internals.AbstractObserver=function(t){function e(){this.isStopped=!1}return ae(e,t),
e.prototype.next=Rt,e.prototype.error=Rt,e.prototype.completed=Rt,e.prototype.onNext=function(t){!this.isStopped&&this.next(t)},e.prototype.onError=function(t){this.isStopped||(this.isStopped=!0,this.error(t))},e.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.completed())},e.prototype.dispose=function(){this.isStopped=!0},e.prototype.fail=function(t){return!this.isStopped&&(this.isStopped=!0,this.error(t),!0)},e}(Ze),We=pt.AnonymousObserver=function(t){function e(e,n,r){t.call(this),this._onNext=e,this._onError=n,this._onCompleted=r}return ae(e,t),e.prototype.next=function(t){this._onNext(t)},e.prototype.error=function(t){this._onError(t)},e.prototype.completed=function(){this._onCompleted()},e}(Ge),Qe=pt.Observable=function(){function t(t,e){return function(n){var r=n.onError;return n.onError=function(e){a(e,t),r.call(n,e)},e.call(t,n)}}function e(){if(pt.config.longStackSupport&&St){var e=this._subscribe,n=It(s)(new Error).e;this.stack=n.stack.substring(n.stack.indexOf("\n")+1),this._subscribe=t(this,e)}}return Ue=e.prototype,e.isObservable=function(t){return t&&xt(t.subscribe)},Ue.subscribe=Ue.forEach=function(t,e,n){return this._subscribe("object"==typeof t?t:He(t,e,n))},Ue.subscribeOnNext=function(t,e){return this._subscribe(He(void 0!==e?function(n){t.call(e,n)}:t))},Ue.subscribeOnError=function(t,e){return this._subscribe(He(null,void 0!==e?function(n){t.call(e,n)}:t))},Ue.subscribeOnCompleted=function(t,e){return this._subscribe(He(null,null,void 0!==e?function(){t.call(e)}:t))},e}(),Je=pt.internals.ScheduledObserver=function(t){function e(e,n){t.call(this),this.scheduler=e,this.observer=n,this.isAcquired=!1,this.hasFaulted=!1,this.queue=[],this.disposable=new ve}function n(t,e){return function(){t.onNext(e)}}function r(t,e){return function(){t.onError(e)}}function i(t){return function(){t.onCompleted()}}function o(t,e){var n;if(!(t.queue.length>0))return void(t.isAcquired=!1);n=t.queue.shift();var r=It(n)();if(r===Ct)return t.queue=[],t.hasFaulted=!0,s(r.e);e(t)}return ae(e,t),e.prototype.next=function(t){this.queue.push(n(this.observer,t))},e.prototype.error=function(t){this.queue.push(r(this.observer,t))},e.prototype.completed=function(){this.queue.push(i(this.observer))},e.prototype.ensureActive=function(){var t=!1;!this.hasFaulted&&this.queue.length>0&&(t=!this.isAcquired,this.isAcquired=!0),t&&this.disposable.setDisposable(this.scheduler.scheduleRecursive(this,o))},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.disposable.dispose()},e}(Ge),Ke=pt.ObservableBase=function(t){function e(t){return t&&xt(t.dispose)?t:xt(t)?de(t):le}function n(t,n){var r=n[0],i=n[1],o=It(i.subscribeCore).call(i,r);o!==Ct||r.fail(Ct.e)||s(Ct.e),r.setDisposable(e(o))}function r(){t.call(this)}return ae(r,t),r.prototype._subscribe=function(t){var e=new Kr(t),r=[e,this];return Te.scheduleRequired()?Te.schedule(r,n):n(null,r),e},r.prototype.subscribeCore=Rt,r}(Qe),$e=pt.FlatMapObservable=function(t){function e(e,n,r,i){this.resultSelector=xt(r)?r:null,this.selector=zt(xt(n)?n:function(){return n},i,3),this.source=e,t.call(this)}function n(t,e,n,r){this.i=0,this.selector=e,this.resultSelector=n,this.source=r,this.o=t,Ge.call(this)}return ae(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new n(t,this.selector,this.resultSelector,this))},ae(n,Ge),n.prototype._wrapResult=function(t,e,n){return this.resultSelector?t.map(function(t,r){return this.resultSelector(e,t,n,r)},this):t},n.prototype.next=function(t){var e=this.i++,n=It(this.selector)(t,e,this.source);if(n===Ct)return this.o.onError(n.e);wt(n)&&(n=Dr(n)),(Bt(n)||Ut(n))&&(n=Qe.from(n)),this.o.onNext(this._wrapResult(n,t,e))},n.prototype.error=function(t){this.o.onError(t)},n.prototype.completed=function(){this.o.onCompleted()},e}(Ke),tn=pt.internals.Enumerable=function(){};I.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,this._s.isDisposed=!0)};var en=function(t){function e(e){this.sources=e,t.call(this)}function n(t,e){if(!t.isDisposed){var n=It(t.e.next).call(t.e);if(n===Ct)return t.o.onError(n.e);if(n.done)return t.o.onCompleted();var i=n.value;wt(i)&&(i=Dr(i));var o=new ge;t.subscription.setDisposable(o),o.setDisposable(i.subscribe(new r(t,e)))}}function r(t,e){this._state=t,this._recurse=e,Ge.call(this)}return ae(e,t),e.prototype.subscribeCore=function(t){var e=new ve,r={isDisposed:!1,o:t,subscription:e,e:this.sources[Ot]()};return new _e([e,Te.scheduleRecursive(r,n),new I(r)])},ae(r,Ge),r.prototype.next=function(t){this._state.o.onNext(t)},r.prototype.error=function(t){this._state.o.onError(t)},r.prototype.completed=function(){this._recurse(this._state)},e}(Ke);tn.prototype.concat=function(){return new en(this)};var nn=function(t){function e(e){this.sources=e,t.call(this)}function n(t,e){if(!t.isDisposed){var n=It(t.e.next).call(t.e);if(n===Ct)return t.o.onError(n.e);if(n.done)return null!==t.lastError?t.o.onError(t.lastError):t.o.onCompleted();var i=n.value;wt(i)&&(i=Dr(i));var o=new ge;t.subscription.setDisposable(o),o.setDisposable(i.subscribe(new r(t,e)))}}function r(t,e){this._state=t,this._recurse=e,Ge.call(this)}return ae(e,t),e.prototype.subscribeCore=function(t){var e=new ve,r={isDisposed:!1,e:this.sources[Ot](),subscription:e,lastError:null,o:t};return new _e([e,Te.scheduleRecursive(r,n),new I(r)])},ae(r,Ge),r.prototype.next=function(t){this._state.o.onNext(t)},r.prototype.error=function(t){this._state.lastError=t,this._recurse(this._state)},r.prototype.completed=function(){this._state.o.onCompleted()},e}(Ke);tn.prototype.catchError=function(){return new nn(this)};var rn=function(t){function e(t,e){this.v=t,this.c=null==e?-1:e}function n(t){this.v=t.v,this.l=t.c}return ae(e,t),e.prototype[Ot]=function(){return new n(this)},n.prototype.next=function(){return 0===this.l?qt:(this.l>0&&this.l--,{done:!1,value:this.v})},e}(tn),on=tn.repeat=function(t,e){return new rn(t,e)},sn=function(t){function e(t,e,n){this.s=t,this.fn=e?zt(e,n,3):null}function n(t){this.i=-1,this.s=t.s,this.l=this.s.length,this.fn=t.fn}return ae(e,t),e.prototype[Ot]=function(){return new n(this)},n.prototype.next=function(){return++this.i<this.l?{done:!1,value:this.fn?this.fn(this.s[this.i],this.i,this.s):this.s[this.i]}:qt},e}(tn),an=tn.of=function(t,e,n){return new sn(t,e,n)},un=function(t){function e(e){this.source=e,t.call(this)}function n(t){this.o=t,this.a=[],Ge.call(this)}return ae(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new n(t))},ae(n,Ge),n.prototype.next=function(t){this.a.push(t)},n.prototype.error=function(t){this.o.onError(t)},n.prototype.completed=function(){this.o.onNext(this.a),this.o.onCompleted()},e}(Ke);Ue.toArray=function(){return new un(this)},Qe.create=function(t,e){return new Jr(t,e)};var cn=function(t){function e(e){this._f=e,t.call(this)}return ae(e,t),e.prototype.subscribeCore=function(t){var e=It(this._f)();return e===Ct?kn(e.e).subscribe(t):(wt(e)&&(e=Dr(e)),e.subscribe(t))},e}(Ke),hn=Qe.defer=function(t){return new cn(t)},fn=function(t){function e(e){this.scheduler=e,t.call(this)}function n(t,e){this.observer=t,this.scheduler=e}function r(t,e){return e.onCompleted(),le}return ae(e,t),e.prototype.subscribeCore=function(t){return new n(t,this.scheduler).run()},n.prototype.run=function(){var t=this.observer;return this.scheduler===Ee?r(null,t):this.scheduler.schedule(t,r)},e}(Ke),dn=new fn(Ee),ln=Qe.empty=function(t){return Ie(t)||(t=Ee),t===Ee?dn:new fn(t)},pn=function(t){function e(e,n,r){this._iterable=e,this._fn=n,this._scheduler=r,t.call(this)}function n(t,e,n){return function(r,i){var o=It(e.next).call(e);if(o===Ct)return t.onError(o.e);if(o.done)return t.onCompleted();var s=o.value;if(xt(n)&&(s=It(n)(s,r))===Ct)return t.onError(s.e);t.onNext(s),i(r+1)}}return ae(e,t),e.prototype.subscribeCore=function(t){var e=Object(this._iterable),r=T(e);return this._scheduler.scheduleRecursive(0,n(t,r,this._fn))},e}(Ke),mn=Math.pow(2,53)-1;S.prototype[Ot]=function(){return new A(this._s)},A.prototype[Ot]=function(){return this},A.prototype.next=function(){return this._i<this._l?{done:!1,value:this._s.charAt(this._i++)}:qt},k.prototype[Ot]=function(){return new E(this._a)},E.prototype[Ot]=function(){return this},E.prototype.next=function(){return this._i<this._l?{done:!1,value:this._a[this._i++]}:qt};var yn=Qe.from=function(t,e,n,r){if(null==t)throw new Error("iterable cannot be null.");if(e&&!xt(e))throw new Error("mapFn when provided must be a function");if(e)var i=zt(e,n,2);return Ie(r)||(r=Te),new pn(t,i,r)},gn=function(t){function e(e,n){this._args=e,this._scheduler=n,t.call(this)}function n(t,e){var n=e.length;return function(r,i){r<n?(t.onNext(e[r]),i(r+1)):t.onCompleted()}}return ae(e,t),e.prototype.subscribeCore=function(t){return this._scheduler.scheduleRecursive(0,n(t,this._args))},e}(Ke),vn=Qe.fromArray=function(t,e){return Ie(e)||(e=Te),new gn(t,e)},bn=function(t){function e(){t.call(this)}return ae(e,t),e.prototype.subscribeCore=function(t){return le},e}(Ke),_n=new bn,wn=Qe.never=function(){return _n};Qe.of=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new gn(e,Te)},Qe.ofWithScheduler=function(t){for(var e=arguments.length,n=new Array(e-1),r=1;r<e;r++)n[r-1]=arguments[r];return new gn(n,t)};var xn=function(t){function e(e,n){this._o=e,this._keys=Object.keys(e),this._scheduler=n,t.call(this)}function n(t,e,n){return function(r,i){if(r<n.length){var o=n[r];t.onNext([o,e[o]]),i(r+1)}else t.onCompleted()}}return ae(e,t),e.prototype.subscribeCore=function(t){return this._scheduler.scheduleRecursive(0,n(t,this._o,this._keys))},e}(Ke);Qe.pairs=function(t,e){return e||(e=Te),new xn(t,e)};var Cn=function(t){function e(e,n,r){this.start=e,this.rangeCount=n,this.scheduler=r,t.call(this)}function n(t,e,n){return function(r,i){r<e?(n.onNext(t+r),i(r+1)):n.onCompleted()}}return ae(e,t),e.prototype.subscribeCore=function(t){return this.scheduler.scheduleRecursive(0,n(this.start,this.rangeCount,t))},e}(Ke);Qe.range=function(t,e,n){return Ie(n)||(n=Te),new Cn(t,e,n)};var In=function(t){function e(e,n,r){this.value=e,this.repeatCount=null==n?-1:n,this.scheduler=r,t.call(this)}return ae(e,t),e.prototype.subscribeCore=function(t){return new N(t,this).run()},e}(Ke);N.prototype.run=function(){function t(t,r){if((t===-1||t>0)&&(e.onNext(n),t>0&&t--),0===t)return e.onCompleted();r(t)}var e=this.observer,n=this.parent.value;return this.parent.scheduler.scheduleRecursive(this.parent.repeatCount,t)},Qe.repeat=function(t,e,n){return Ie(n)||(n=Te),new In(t,e,n)};var Sn=function(t){function e(e,n){this._value=e,this._scheduler=n,t.call(this)}function n(t,e){var n=e[0],r=e[1];return r.onNext(n),r.onCompleted(),le}return ae(e,t),e.prototype.subscribeCore=function(t){var e=[this._value,t];return this._scheduler===Ee?n(null,e):this._scheduler.schedule(e,n)},e}(Ke),An=(Qe.return=Qe.just=function(t,e){return Ie(e)||(e=Ee),new Sn(t,e)},function(t){function e(e,n){this._error=e,this._scheduler=n,t.call(this)}function n(t,e){var n=e[0];return e[1].onError(n),le}return ae(e,t),e.prototype.subscribeCore=function(t){var e=[this._error,t];return this._scheduler===Ee?n(null,e):this._scheduler.schedule(e,n)},e}(Ke)),kn=Qe.throw=function(t,e){return Ie(e)||(e=Ee),new An(t,e)},En=function(t){function e(e,n){this.source=e,this._fn=n,t.call(this)}return ae(e,t),e.prototype.subscribeCore=function(t){var e=new ge,n=new ve;return n.setDisposable(e),e.setDisposable(this.source.subscribe(new Pn(t,n,this._fn))),n},e}(Ke),Pn=function(t){function e(e,n,r){this._o=e,this._s=n,this._fn=r,t.call(this)}return ae(e,t),e.prototype.next=function(t){this._o.onNext(t)},e.prototype.completed=function(){return this._o.onCompleted()},e.prototype.error=function(t){var e=It(this._fn)(t);if(e===Ct)return this._o.onError(e.e);wt(e)&&(e=Dr(e));var n=new ge;this._s.setDisposable(n),n.setDisposable(e.subscribe(this._o))},e}(Ge);Ue.catch=function(t){return xt(t)?new En(this,t):Tn([this,t])};var Tn=Qe.catch=function(){var t;if(Array.isArray(arguments[0]))t=arguments[0];else{var e=arguments.length;t=new Array(e);for(var n=0;n<e;n++)t[n]=arguments[n]}return an(t).catchError()};Ue.combineLatest=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Array.isArray(e[0])?e[0].unshift(this):e.unshift(this),Mn.apply(this,e)};var Fn=function(t){function e(e,n){this._params=e,this._cb=n,t.call(this)}return ae(e,t),e.prototype.subscribeCore=function(t){for(var e=this._params.length,n=new Array(e),r={hasValue:x(e,R),hasValueAll:!1,isDone:x(e,R),values:new Array(e)},i=0;i<e;i++){var o=this._params[i],s=new ge;n[i]=s,wt(o)&&(o=Dr(o)),s.setDisposable(o.subscribe(new Dn(t,i,this._cb,r)))}return new _e(n)},e}(Ke),Dn=function(t){function e(e,n,r,i){this._o=e,this._i=n,this._cb=r,this._state=i,t.call(this)}function n(t){return function(e,n){return n!==t}}return ae(e,t),e.prototype.next=function(t){if(this._state.values[this._i]=t,this._state.hasValue[this._i]=!0,this._state.hasValueAll||(this._state.hasValueAll=this._state.hasValue.every(yt))){var e=It(this._cb).apply(null,this._state.values);if(e===Ct)return this._o.onError(e.e);this._o.onNext(e)}else this._state.isDone.filter(n(this._i)).every(yt)&&this._o.onCompleted()},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._state.isDone[this._i]=!0,this._state.isDone.every(yt)&&this._o.onCompleted()},e}(Ge),Mn=Qe.combineLatest=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=xt(e[t-1])?e.pop():O;return Array.isArray(e[0])&&(e=e[0]),new Fn(e,r)};Ue.concat=function(){for(var t=[],e=0,n=arguments.length;e<n;e++)t.push(arguments[e]);return t.unshift(this),On.apply(null,t)};var Nn=function(t){function e(e,n){this._s=e,this._fn=n,t.call(this)}return ae(e,t),e.prototype.next=function(t){this._s.o.onNext(t)},e.prototype.error=function(t){this._s.o.onError(t)},e.prototype.completed=function(){this._s.i++,this._fn(this._s)},e}(Ge),Rn=function(t){function e(e){this._sources=e,t.call(this)}function n(t,e){if(!t.disposable.isDisposed){if(t.i===t.sources.length)return t.o.onCompleted();var n=t.sources[t.i];wt(n)&&(n=Dr(n));var r=new ge;t.subscription.setDisposable(r),r.setDisposable(n.subscribe(new Nn(t,e)))}}return ae(e,t),e.prototype.subscribeCore=function(t){var e=new ve,r=de(mt),i={o:t,i:0,subscription:e,disposable:r,sources:this._sources};return new _e([e,r,Ee.scheduleRecursive(i,n)])},e}(Ke),On=Qe.concat=function(){var t;if(Array.isArray(arguments[0]))t=arguments[0];else{t=new Array(arguments.length);for(var e=0,n=arguments.length;e<n;e++)t[e]=arguments[e]}return new Rn(t)};Ue.concatAll=function(){return this.merge(1)};var qn=function(t){function e(e,n){this.source=e,this.maxConcurrent=n,t.call(this)}return ae(e,t),e.prototype.subscribeCore=function(t){var e=new ce;return e.add(this.source.subscribe(new Un(t,this.maxConcurrent,e))),e},e}(Ke),Un=function(t){function e(e,n,r){this.o=e,this.max=n,this.g=r,this.done=!1,this.q=[],this.activeCount=0,t.call(this)}function n(e,n){this.parent=e,this.sad=n,t.call(this)}return ae(e,t),e.prototype.handleSubscribe=function(t){var e=new ge;this.g.add(e),wt(t)&&(t=Dr(t)),e.setDisposable(t.subscribe(new n(this,e)))},e.prototype.next=function(t){this.activeCount<this.max?(this.activeCount++,this.handleSubscribe(t)):this.q.push(t)},e.prototype.error=function(t){this.o.onError(t)},e.prototype.completed=function(){this.done=!0,0===this.activeCount&&this.o.onCompleted()},ae(n,t),n.prototype.next=function(t){this.parent.o.onNext(t)},n.prototype.error=function(t){this.parent.o.onError(t)},n.prototype.completed=function(){this.parent.g.remove(this.sad),this.parent.q.length>0?this.parent.handleSubscribe(this.parent.q.shift()):(this.parent.activeCount--,this.parent.done&&0===this.parent.activeCount&&this.parent.o.onCompleted())},e}(Ge);Ue.merge=function(t){return"number"!=typeof t?Bn(this,t):new qn(this,t)};var Bn=Qe.merge=function(){var t,e,n=[],r=arguments.length;if(arguments[0])if(Ie(arguments[0]))for(t=arguments[0],e=1;e<r;e++)n.push(arguments[e]);else for(t=Ee,e=0;e<r;e++)n.push(arguments[e]);else for(t=Ee,e=1;e<r;e++)n.push(arguments[e]);return Array.isArray(n[0])&&(n=n[0]),M(t,n).mergeAll()},zn=pt.CompositeError=function(t){this.innerErrors=t,this.message="This contains multiple errors. Check the innerErrors",Error.call(this)};zn.prototype=Object.create(Error.prototype),zn.prototype.name="CompositeError";var Ln=function(t){function e(e){this.source=e,t.call(this)}return ae(e,t),e.prototype.subscribeCore=function(t){var e=new ce,n=new ge,r={isStopped:!1,errors:[],o:t};return e.add(n),n.setDisposable(this.source.subscribe(new jn(e,r))),e},e}(Ke),jn=function(t){function e(e,n){this._group=e,this._state=n,t.call(this)}function n(t,e){0===e.length?t.onCompleted():1===e.length?t.onError(e[0]):t.onError(new zn(e))}function r(e,n,r){this._inner=e,this._group=n,this._state=r,t.call(this)}return ae(e,t),e.prototype.next=function(t){var e=new ge;this._group.add(e),wt(t)&&(t=Dr(t)),e.setDisposable(t.subscribe(new r(e,this._group,this._state)))},e.prototype.error=function(t){this._state.errors.push(t),this._state.isStopped=!0,1===this._group.length&&n(this._state.o,this._state.errors)},e.prototype.completed=function(){this._state.isStopped=!0,1===this._group.length&&n(this._state.o,this._state.errors)},ae(r,t),r.prototype.next=function(t){this._state.o.onNext(t)},r.prototype.error=function(t){this._state.errors.push(t),this._group.remove(this._inner),this._state.isStopped&&1===this._group.length&&n(this._state.o,this._state.errors)},r.prototype.completed=function(){this._group.remove(this._inner),this._state.isStopped&&1===this._group.length&&n(this._state.o,this._state.errors)},e}(Ge);Qe.mergeDelayError=function(){var t;if(Array.isArray(arguments[0]))t=arguments[0];else{var e=arguments.length;t=new Array(e);for(var n=0;n<e;n++)t[n]=arguments[n]}return new Ln(M(null,t))};var Vn=function(t){function e(e){this.source=e,t.call(this)}return ae(e,t),e.prototype.subscribeCore=function(t){var e=new ce,n=new ge;return e.add(n),n.setDisposable(this.source.subscribe(new Xn(t,e))),e},e}(Ke),Xn=function(t){function e(e,n){this.o=e,this.g=n,this.done=!1,t.call(this)}function n(e,n){this.parent=e,this.sad=n,t.call(this)}return ae(e,t),e.prototype.next=function(t){var e=new ge;this.g.add(e),wt(t)&&(t=Dr(t)),e.setDisposable(t.subscribe(new n(this,e)))},e.prototype.error=function(t){this.o.onError(t)},e.prototype.completed=function(){this.done=!0,1===this.g.length&&this.o.onCompleted()},ae(n,t),n.prototype.next=function(t){this.parent.o.onNext(t)},n.prototype.error=function(t){this.parent.o.onError(t)},n.prototype.completed=function(){this.parent.g.remove(this.sad),this.parent.done&&1===this.parent.g.length&&this.parent.o.onCompleted()},e}(Ge);Ue.mergeAll=function(){return new Vn(this)};var Yn=function(t){function e(e,n){this._s=e,this._o=wt(n)?Dr(n):n,this._open=!1,t.call(this)}return ae(e,t),e.prototype.subscribeCore=function(t){var e=new ge;e.setDisposable(this._s.subscribe(new Zn(t,this))),wt(this._o)&&(this._o=Dr(this._o));var n=new ge;return n.setDisposable(this._o.subscribe(new Hn(t,this,n))),new be(e,n)},e}(Ke),Zn=function(t){function e(e,n){this._o=e,this._p=n,t.call(this)}return ae(e,t),e.prototype.next=function(t){this._p._open&&this._o.onNext(t)},e.prototype.error=function(t){this._o.onError(t)},e.prototype.onCompleted=function(){this._p._open&&this._o.onCompleted()},e}(Ge),Hn=function(t){function e(e,n,r){this._o=e,this._p=n,this._r=r,t.call(this)}return ae(e,t),e.prototype.next=function(){this._p._open=!0,this._r.dispose()},e.prototype.error=function(t){this._o.onError(t)},e.prototype.onCompleted=function(){this._r.dispose()},e}(Ge);Ue.skipUntil=function(t){return new Yn(this,t)};var Gn=function(t){function e(e){this.source=e,t.call(this)}function n(t,e){this.o=t,this.inner=e,this.stopped=!1,this.latest=0,this.hasLatest=!1,Ge.call(this)}function r(t,e){this.parent=t,this.id=e,Ge.call(this)}return ae(e,t),e.prototype.subscribeCore=function(t){var e=new ve;return new be(this.source.subscribe(new n(t,e)),e)},ae(n,Ge),n.prototype.next=function(t){var e=new ge,n=++this.latest;this.hasLatest=!0,this.inner.setDisposable(e),wt(t)&&(t=Dr(t)),e.setDisposable(t.subscribe(new r(this,n)))},n.prototype.error=function(t){this.o.onError(t)},n.prototype.completed=function(){this.stopped=!0,!this.hasLatest&&this.o.onCompleted()},ae(r,Ge),r.prototype.next=function(t){this.parent.latest===this.id&&this.parent.o.onNext(t)},r.prototype.error=function(t){this.parent.latest===this.id&&this.parent.o.onError(t)},r.prototype.completed=function(){this.parent.latest===this.id&&(this.parent.hasLatest=!1,this.parent.stopped&&this.parent.o.onCompleted())},e}(Ke);Ue.switch=Ue.switchLatest=function(){return new Gn(this)};var Wn=function(t){function e(e,n){this.source=e,this.other=wt(n)?Dr(n):n,t.call(this)}return ae(e,t),e.prototype.subscribeCore=function(t){return new be(this.source.subscribe(t),this.other.subscribe(new Qn(t)))},e}(Ke),Qn=function(t){function e(e){this._o=e,t.call(this)}return ae(e,t),e.prototype.next=function(){this._o.onCompleted()},e.prototype.error=function(t){this._o.onError(t)},e.prototype.onCompleted=mt,e}(Ge);Ue.takeUntil=function(t){return new Wn(this,t)};var Jn=function(t){function e(e,n,r){this._s=e,this._ss=n,this._cb=r,t.call(this)}return ae(e,t),e.prototype.subscribeCore=function(t){for(var e=this._ss.length,n={hasValue:x(e,R),hasValueAll:!1,values:new Array(e)},r=this._ss.length,i=new Array(r+1),o=0;o<r;o++){var s=this._ss[o],a=new ge;wt(s)&&(s=Dr(s)),a.setDisposable(s.subscribe(new Kn(t,o,n))),i[o]=a}var u=new ge;return u.setDisposable(this._s.subscribe(new $n(t,this._cb,n))),i[r]=u,new _e(i)},e}(Ke),Kn=function(t){function e(e,n,r){this._o=e,this._i=n,this._state=r,t.call(this)}return ae(e,t),e.prototype.next=function(t){this._state.values[this._i]=t,this._state.hasValue[this._i]=!0,this._state.hasValueAll=this._state.hasValue.every(yt)},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=mt,e}(Ge),$n=function(t){function e(e,n,r){this._o=e,this._cb=n,this._state=r,t.call(this)}return ae(e,t),e.prototype.next=function(t){var e=[t].concat(this._state.values);if(this._state.hasValueAll){var n=It(this._cb).apply(null,e);if(n===Ct)return this._o.onError(n.e);this._o.onNext(n)}},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onCompleted()},e}(Ge);Ue.withLatestFrom=function(){if(0===arguments.length)throw new Error("invalid arguments");for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=xt(e[t-1])?e.pop():O;return Array.isArray(e[0])&&(e=e[0]),new Jn(this,e,r)};var tr=function(t){function e(e,n){this._s=e,this._cb=n,t.call(this)}return ae(e,t),e.prototype.subscribeCore=function(t){for(var e=this._s.length,n=new Array(e),r=x(e,R),i=x(e,q),o=0;o<e;o++){var s=this._s[o],a=new ge;n[o]=a,wt(s)&&(s=Dr(s)),a.setDisposable(s.subscribe(new er(t,o,this,i,r)))}return new _e(n)},e}(Ke),er=function(t){function e(e,n,r,i,o){this._o=e,this._i=n,this._p=r,this._q=i,this._d=o,t.call(this)}function n(t){return t.length>0}function r(t){return t.shift()}function i(t){return function(e,n){return n!==t}}return ae(e,t),e.prototype.next=function(t){if(this._q[this._i].push(t),this._q.every(n)){var e=this._q.map(r),o=It(this._p._cb).apply(null,e);if(o===Ct)return this._o.onError(o.e);this._o.onNext(o)}else this._d.filter(i(this._i)).every(yt)&&this._o.onCompleted()},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._d[this._i]=!0,this._d.every(yt)&&this._o.onCompleted()},e}(Ge);Ue.zip=function(){if(0===arguments.length)throw new Error("invalid arguments");for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=xt(e[t-1])?e.pop():O;Array.isArray(e[0])&&(e=e[0]);var i=this;return e.unshift(i),new tr(e,r)},Qe.zip=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];Array.isArray(e[0])&&(e=xt(e[1])?e[0].concat(e[1]):e[0]);var r=e.shift();return r.zip.apply(r,e)};var nr=function(t){function e(e,n){this.sources=e,this._cb=n,t.call(this)}return ae(e,t),e.prototype.subscribeCore=function(t){for(var e=this.sources,n=e.length,r=new Array(n),i={q:x(n,q),done:x(n,R),cb:this._cb,o:t},o=0;o<n;o++)!function(t){var n=e[t],o=new ge;(Bt(n)||Ut(n))&&(n=yn(n)),r[t]=o,o.setDisposable(n.subscribe(new rr(i,t)))}(o);return new _e(r)},e}(Ke),rr=function(t){function e(e,n){this._s=e,this._i=n,t.call(this)}function n(t){return t.length>0}function r(t){return t.shift()}function i(t){return function(e,n){return n!==t}}return ae(e,t),e.prototype.next=function(t){if(this._s.q[this._i].push(t),this._s.q.every(n)){var e=this._s.q.map(r),o=It(this._s.cb).apply(null,e);if(o===Ct)return this._s.o.onError(o.e);this._s.o.onNext(o)}else this._s.done.filter(i(this._i)).every(yt)&&this._s.o.onCompleted()},e.prototype.error=function(t){this._s.o.onError(t)},e.prototype.completed=function(){this._s.done[this._i]=!0,this._s.done.every(yt)&&this._s.o.onCompleted()},e}(Ge);Ue.zipIterable=function(){if(0===arguments.length)throw new Error("invalid arguments");for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=xt(e[t-1])?e.pop():O,i=this;return e.unshift(i),new nr(e,r)},Ue.asObservable=function(){return new Jr(U(this),this)};var ir=function(t){function e(e){this.source=e,t.call(this)}return ae(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new or(t))},e}(Ke),or=function(t){function e(e){this._o=e,t.call(this)}return ae(e,t),e.prototype.next=function(t){t.accept(this._o)},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onCompleted()},e}(Ge);Ue.dematerialize=function(){return new ir(this)};var sr=function(t){function e(e,n,r){this.source=e,this.keyFn=n,this.comparer=r,t.call(this)}return ae(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new ar(t,this.keyFn,this.comparer))},e}(Ke),ar=function(t){function e(e,n,r){this.o=e,this.keyFn=n,this.comparer=r,this.hasCurrentKey=!1,this.currentKey=null,t.call(this)}return ae(e,t),e.prototype.next=function(t){var e,n=t;return xt(this.keyFn)&&(n=It(this.keyFn)(t))===Ct?this.o.onError(n.e):this.hasCurrentKey&&(e=It(this.comparer)(this.currentKey,n))===Ct?this.o.onError(e.e):void(this.hasCurrentKey&&e||(this.hasCurrentKey=!0,this.currentKey=n,this.o.onNext(t)))},e.prototype.error=function(t){this.o.onError(t)},e.prototype.completed=function(){this.o.onCompleted()},e}(Ge);Ue.distinctUntilChanged=function(t,e){return e||(e=vt),new sr(this,t,e)};var ur=function(t){function e(e,n,r,i){this.source=e,this._oN=n,this._oE=r,this._oC=i,t.call(this)}function n(t,e){this.o=t,this.t=!e._oN||xt(e._oN)?He(e._oN||mt,e._oE||mt,e._oC||mt):e._oN,this.isStopped=!1,Ge.call(this)}return ae(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new n(t,this))},ae(n,Ge),n.prototype.next=function(t){var e=It(this.t.onNext).call(this.t,t);e===Ct&&this.o.onError(e.e),this.o.onNext(t)},n.prototype.error=function(t){var e=It(this.t.onError).call(this.t,t);if(e===Ct)return this.o.onError(e.e);this.o.onError(t)},n.prototype.completed=function(){var t=It(this.t.onCompleted).call(this.t);if(t===Ct)return this.o.onError(t.e);this.o.onCompleted()},e}(Ke);Ue.do=Ue.tap=Ue.doAction=function(t,e,n){return new ur(this,t,e,n)},Ue.doOnNext=Ue.tapOnNext=function(t,e){return this.tap(void 0!==e?function(n){t.call(e,n)}:t)},Ue.doOnError=Ue.tapOnError=function(t,e){return this.tap(mt,void 0!==e?function(n){t.call(e,n)}:t)},Ue.doOnCompleted=Ue.tapOnCompleted=function(t,e){return this.tap(mt,null,void 0!==e?function(){t.call(e)}:t)};var cr=function(t){function e(e,n,r){this.source=e,this._fn=zt(n,r,0),t.call(this)}function n(t,e){this.isDisposed=!1,this._s=t,this._fn=e}return ae(e,t),e.prototype.subscribeCore=function(t){var e=It(this.source.subscribe).call(this.source,t);return e===Ct&&(this._fn(),s(e.e)),new n(e,this._fn)},n.prototype.dispose=function(){if(!this.isDisposed){var t=It(this._s.dispose).call(this._s);this._fn(),t===Ct&&s(t.e)}},e}(Ke);Ue.finally=function(t,e){return new cr(this,t,e)};var hr=function(t){function e(e){this.source=e,t.call(this)}function n(t){this.o=t,this.isStopped=!1}return ae(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new n(t))},n.prototype.onNext=mt,n.prototype.onError=function(t){this.isStopped||(this.isStopped=!0,this.o.onError(t))},n.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.o.onCompleted())},n.prototype.dispose=function(){this.isStopped=!0},n.prototype.fail=function(t){return!this.isStopped&&(this.isStopped=!0,this.observer.onError(t),!0)},e}(Ke);Ue.ignoreElements=function(){return new hr(this)};var fr=function(t){function e(e,n){this.source=e,t.call(this)}return ae(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new dr(t))},e}(Ke),dr=function(t){function e(e){this._o=e,t.call(this)}return ae(e,t),e.prototype.next=function(t){this._o.onNext(Ve(t))},e.prototype.error=function(t){this._o.onNext(Xe(t)),this._o.onCompleted()},e.prototype.completed=function(){this._o.onNext(Ye()),this._o.onCompleted()},e}(Ge);Ue.materialize=function(){return new fr(this)},Ue.repeat=function(t){return on(this,t).concat()},Ue.retry=function(t){return on(this,t).catchError()};var lr=function(t){function e(t){return{isDisposed:!1,dispose:function(){this.isDisposed||(this.isDisposed=!0,t.isDisposed=!0)}}}function n(e,n){this.source=e,this._notifier=n,t.call(this)}return ae(n,t),n.prototype.subscribeCore=function(t){var n=new ti,r=new ti,i=this._notifier(n),o=i.subscribe(r),s=this.source["@@iterator"](),a={isDisposed:!1},u=new ve;return new _e([o,u,Te.scheduleRecursive(null,function(e,i){if(!a.isDisposed){var o=s.next();if(o.done)return void t.onCompleted();var c=o.value;wt(c)&&(c=Dr(c));var h=new ge,f=new ge;u.setDisposable(new be(f,h)),h.setDisposable(c.subscribe(function(e){t.onNext(e)},function(e){f.setDisposable(r.subscribe(i,function(e){t.onError(e)},function(){t.onCompleted()})),n.onNext(e),h.dispose()},function(){t.onCompleted()}))}}),e(a)])},n}(Ke);Ue.retryWhen=function(t){return new lr(B(this),t)};var pr=function(t){function e(t){return{isDisposed:!1,dispose:function(){this.isDisposed||(this.isDisposed=!0,t.isDisposed=!0)}}}function n(e,n){this.source=e,this._notifier=n,t.call(this)}return ae(n,t),n.prototype.subscribeCore=function(t){var n=new ti,r=new ti,i=this._notifier(n),o=i.subscribe(r),s=this.source["@@iterator"](),a={isDisposed:!1},u=new ve;return new _e([o,u,Te.scheduleRecursive(null,function(e,i){if(!a.isDisposed){var o=s.next();if(o.done)return void t.onCompleted();var c=o.value;wt(c)&&(c=Dr(c));var h=new ge,f=new ge;u.setDisposable(new be(f,h)),h.setDisposable(c.subscribe(function(e){t.onNext(e)},function(e){t.onError(e)},function(){f.setDisposable(r.subscribe(i,function(e){t.onError(e)},function(){t.onCompleted()})),n.onNext(null),h.dispose()}))}}),e(a)])},n}(Ke);Ue.repeatWhen=function(t){return new pr(B(this),t)};var mr=function(t){function e(e,n,r,i){this.source=e,this.accumulator=n,this.hasSeed=r,this.seed=i,t.call(this)}return ae(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new yr(t,this))},e}(Ke),yr=function(t){function e(e,n){this._o=e,this._p=n,this._fn=n.accumulator,this._hs=n.hasSeed,this._s=n.seed,this._ha=!1,this._a=null,this._hv=!1,this._i=0,t.call(this)}return ae(e,t),e.prototype.next=function(t){if(!this._hv&&(this._hv=!0),this._ha?this._a=It(this._fn)(this._a,t,this._i,this._p):(this._a=this._hs?It(this._fn)(this._s,t,this._i,this._p):t,this._ha=!0),this._a===Ct)return this._o.onError(this._a.e);this._o.onNext(this._a),this._i++},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){!this._hv&&this._hs&&this._o.onNext(this._s),this._o.onCompleted()},e}(Ge);Ue.scan=function(){var t,e=!1,n=arguments[0];return 2===arguments.length&&(e=!0,t=arguments[1]),new mr(this,n,e,t)}
;var gr=function(t){function e(e,n){this.source=e,this._c=n,t.call(this)}return ae(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new vr(t,this._c))},e}(Ke),vr=function(t){function e(e,n){this._o=e,this._c=n,this._q=[],t.call(this)}return ae(e,t),e.prototype.next=function(t){this._q.push(t),this._q.length>this._c&&this._o.onNext(this._q.shift())},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onCompleted()},e}(Ge);Ue.skipLast=function(t){if(t<0)throw new Dt;return new gr(this,t)},Ue.startWith=function(){var t,e=0;arguments.length&&Ie(arguments[0])?(t=arguments[0],e=1):t=Ee;for(var n=[],r=e,i=arguments.length;r<i;r++)n.push(arguments[r]);return On.apply(null,[vn(n,t),this])};var br=function(t){function e(e,n){this._o=e,this._c=n,this._q=[],t.call(this)}return ae(e,t),e.prototype.next=function(t){this._q.push(t),this._q.length>this._c&&this._q.shift()},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){for(;this._q.length>0;)this._o.onNext(this._q.shift());this._o.onCompleted()},e}(Ge);Ue.takeLast=function(t){if(t<0)throw new Dt;var e=this;return new Jr(function(n){return e.subscribe(new br(n,t))},e)},Ue.flatMapConcat=Ue.concatMap=function(t,e,n){return new $e(this,t,e,n).merge(1)};var _r=function(t){function e(e,n,r){this.source=e,this.selector=zt(n,r,3),t.call(this)}function n(t,e){return function(n,r,i){return t.call(this,e.selector(n,r,i),r,i)}}function r(t,e,n){this.o=t,this.selector=e,this.source=n,this.i=0,Ge.call(this)}return ae(e,t),e.prototype.internalMap=function(t,r){return new e(this.source,n(t,this),r)},e.prototype.subscribeCore=function(t){return this.source.subscribe(new r(t,this.selector,this))},ae(r,Ge),r.prototype.next=function(t){var e=It(this.selector)(t,this.i++,this.source);if(e===Ct)return this.o.onError(e.e);this.o.onNext(e)},r.prototype.error=function(t){this.o.onError(t)},r.prototype.completed=function(){this.o.onCompleted()},e}(Ke);Ue.map=Ue.select=function(t,e){var n="function"==typeof t?t:function(){return t};return this instanceof _r?this.internalMap(n,e):new _r(this,n,e)},Ue.pluck=function(){var t=arguments.length,e=new Array(t);if(0===t)throw new Error("List of properties cannot be empty.");for(var n=0;n<t;n++)e[n]=arguments[n];return this.map(z(e,t))},Ue.flatMap=Ue.selectMany=Ue.mergeMap=function(t,e,n){return new $e(this,t,e,n).mergeAll()},Ue.flatMapLatest=Ue.switchMap=function(t,e,n){return new $e(this,t,e,n).switchLatest()};var wr=function(t){function e(e,n){this.source=e,this._count=n,t.call(this)}function n(t,e){this._o=t,this._r=e,Ge.call(this)}return ae(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new n(t,this._count))},ae(n,Ge),n.prototype.next=function(t){this._r<=0?this._o.onNext(t):this._r--},n.prototype.error=function(t){this._o.onError(t)},n.prototype.completed=function(){this._o.onCompleted()},e}(Ke);Ue.skip=function(t){if(t<0)throw new Dt;return new wr(this,t)};var xr=function(t){function e(e,n){this.source=e,this._fn=n,t.call(this)}return ae(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new Cr(t,this))},e}(Ke),Cr=function(t){function e(e,n){this._o=e,this._p=n,this._i=0,this._r=!1,t.call(this)}return ae(e,t),e.prototype.next=function(t){if(!this._r){var e=It(this._p._fn)(t,this._i++,this._p);if(e===Ct)return this._o.onError(e.e);this._r=!e}this._r&&this._o.onNext(t)},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onCompleted()},e}(Ge);Ue.skipWhile=function(t,e){return new xr(this,zt(t,e,3))};var Ir=function(t){function e(e,n){this.source=e,this._count=n,t.call(this)}function n(t,e){this._o=t,this._c=e,this._r=e,Ge.call(this)}return ae(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new n(t,this._count))},ae(n,Ge),n.prototype.next=function(t){this._r-- >0&&(this._o.onNext(t),this._r<=0&&this._o.onCompleted())},n.prototype.error=function(t){this._o.onError(t)},n.prototype.completed=function(){this._o.onCompleted()},e}(Ke);Ue.take=function(t,e){if(t<0)throw new Dt;return 0===t?ln(e):new Ir(this,t)};var Sr=function(t){function e(e,n){this.source=e,this._fn=n,t.call(this)}return ae(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new Ar(t,this))},e}(Ke),Ar=function(t){function e(e,n){this._o=e,this._p=n,this._i=0,this._r=!0,t.call(this)}return ae(e,t),e.prototype.next=function(t){if(this._r&&(this._r=It(this._p._fn)(t,this._i++,this._p),this._r===Ct))return this._o.onError(this._r.e);this._r?this._o.onNext(t):this._o.onCompleted()},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onCompleted()},e}(Ge);Ue.takeWhile=function(t,e){return new Sr(this,zt(t,e,3))};var kr=function(t){function e(e,n,r){this.source=e,this.predicate=zt(n,r,3),t.call(this)}function n(t,e){return function(n,r,i){return e.predicate(n,r,i)&&t.call(this,n,r,i)}}function r(t,e,n){this.o=t,this.predicate=e,this.source=n,this.i=0,Ge.call(this)}return ae(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new r(t,this.predicate,this))},e.prototype.internalFilter=function(t,r){return new e(this.source,n(t,this),r)},ae(r,Ge),r.prototype.next=function(t){var e=It(this.predicate)(t,this.i++,this.source);if(e===Ct)return this.o.onError(e.e);e&&this.o.onNext(t)},r.prototype.error=function(t){this.o.onError(t)},r.prototype.completed=function(){this.o.onCompleted()},e}(Ke);Ue.filter=Ue.where=function(t,e){return this instanceof kr?this.internalFilter(t,e):new kr(this,t,e)},Qe.fromCallback=function(t,e,n){return function(){void 0===e&&(e=this);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return L(t,e,n,i)}},Qe.fromNodeCallback=function(t,e,n){return function(){void 0===e&&(e=this);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return V(t,e,n,i)}},Z.prototype.dispose=function(){this.isDisposed||(this._e.removeEventListener(this._n,this._fn,!1),this.isDisposed=!0)},pt.config.useNativeEvents=!1;var Er=function(t){function e(e,n,r){this._el=e,this._n=n,this._fn=r,t.call(this)}function n(t,e){return function(){var n=arguments[0];if(xt(e)&&(n=It(e).apply(null,arguments))===Ct)return t.onError(n.e);t.onNext(n)}}return ae(e,t),e.prototype.subscribeCore=function(t){return H(this._el,this._n,n(t,this._fn))},e}(Ke);Qe.fromEvent=function(t,e,n){return t.addListener?Tr(function(n){t.addListener(e,n)},function(n){t.removeListener(e,n)},n):pt.config.useNativeEvents||"function"!=typeof t.on||"function"!=typeof t.off?new Er(t,e,n).publish().refCount():Tr(function(n){t.on(e,n)},function(n){t.off(e,n)},n)};var Pr=function(t){function e(e,n,r){this._add=e,this._del=n,this._fn=r,t.call(this)}function n(t,e){return function(){var n=arguments[0];if(xt(e)&&(n=It(e).apply(null,arguments))===Ct)return t.onError(n.e);t.onNext(n)}}function r(t,e,n){this._del=t,this._fn=e,this._ret=n,this.isDisposed=!1}return ae(e,t),e.prototype.subscribeCore=function(t){var e=n(t,this._fn),i=this._add(e);return new r(this._del,e,i)},r.prototype.dispose=function(){this.isDisposed||(xt(this._del)&&this._del(this._fn,this._ret),this.isDisposed=!0)},e}(Ke),Tr=Qe.fromEventPattern=function(t,e,n){return new Pr(t,e,n).publish().refCount()},Fr=function(t){function e(e,n){this._p=e,this._s=n,t.call(this)}function n(t,e){var n=e[0],r=e[1];n.onNext(r),n.onCompleted()}function r(t,e){var n=e[0],r=e[1];n.onError(r)}return ae(e,t),e.prototype.subscribeCore=function(t){var e=new ge,i=this,o=this._p;return xt(o)&&(o=It(o)())===Ct?(t.onError(o.e),e):(o.then(function(r){e.setDisposable(i._s.schedule([t,r],n))},function(n){e.setDisposable(i._s.schedule([t,n],r))}),e)},e}(Ke),Dr=Qe.fromPromise=function(t,e){return e||(e=Re),new Fr(t,e)};Ue.toPromise=function(t){if(t||(t=pt.config.Promise),!t)throw new Mt("Promise type not provided nor in Rx.config.Promise");var e=this;return new t(function(t,n){var r;e.subscribe(function(t){r=t},n,function(){t(r)})})},Qe.startAsync=function(t){var e=It(t)();return e===Ct?kn(e.e):Dr(e)};var Mr=function(t){function e(e,n,r){this.source=e,this._fn1=n,this._fn2=r,t.call(this)}return ae(e,t),e.prototype.subscribeCore=function(t){var e=this.source.multicast(this._fn1());return new be(this._fn2(e).subscribe(t),e.connect())},e}(Ke);Ue.multicast=function(t,e){return xt(t)?new Mr(this,t,e):new Rr(this,t)},Ue.publish=function(t){return t&&xt(t)?this.multicast(function(){return new ti},t):this.multicast(new ti)},Ue.share=function(){return this.publish().refCount()},Ue.publishLast=function(t){return t&&xt(t)?this.multicast(function(){return new ei},t):this.multicast(new ei)},Ue.publishValue=function(t,e){return 2===arguments.length?this.multicast(function(){return new ri(e)},t):this.multicast(new ri(t))},Ue.shareValue=function(t){return this.publishValue(t).refCount()},Ue.replay=function(t,e,n,r){return t&&xt(t)?this.multicast(function(){return new ii(e,n,r)},t):this.multicast(new ii(e,n,r))},Ue.shareReplay=function(t,e,n){return this.replay(null,t,e,n).refCount()};var Nr=function(t){function e(e){this.source=e,this._count=0,this._connectableSubscription=null,t.call(this)}function n(t,e){this._p=t,this._s=e,this.isDisposed=!1}return ae(e,t),e.prototype.subscribeCore=function(t){var e=this.source.subscribe(t);return 1==++this._count&&(this._connectableSubscription=this.source.connect()),new n(this,e)},n.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,this._s.dispose(),0==--this._p._count&&this._p._connectableSubscription.dispose())},e}(Ke),Rr=pt.ConnectableObservable=function(t){function e(e,n){this.source=e,this._connection=null,this._source=e.asObservable(),this._subject=n,t.call(this)}function n(t,e){this._p=t,this._s=e}return ae(e,t),n.prototype.dispose=function(){this._s&&(this._s.dispose(),this._s=null,this._p._connection=null)},e.prototype.connect=function(){if(!this._connection){if(this._subject.isStopped)return le;var t=this._source.subscribe(this._subject);this._connection=new n(this,t)}return this._connection},e.prototype._subscribe=function(t){return this._subject.subscribe(t)},e.prototype.refCount=function(){return new Nr(this)},e}(Qe),Or=function(t){function e(e,n){this._dt=e,this._s=n,t.call(this)}function n(t,e){e.onNext(0),e.onCompleted()}return ae(e,t),e.prototype.subscribeCore=function(t){return this._s.scheduleFuture(t,this._dt,n)},e}(Ke),qr=Qe.interval=function(t,e){return Q(t,t,Ie(e)?e:Re)};Qe.timer=function(t,e,r){var i;return Ie(r)||(r=Re),null!=e&&"number"==typeof e?i=e:Ie(e)&&(r=e),(t instanceof Date||"number"==typeof t)&&i===n?G(t,r):t instanceof Date&&i!==n?W(t,e,r):Q(t,i,r)};Ue.delay=function(){var t=arguments[0];if("number"==typeof t||t instanceof Date){var e=t,n=arguments[1];return Ie(n)||(n=Re),e instanceof Date?K(this,e,n):J(this,e,n)}if(Qe.isObservable(t)||xt(t))return $(this,t,arguments[1]);throw new Error("Invalid arguments")};var Ur=function(t){function e(e,n,r){Ie(r)||(r=Re),this.source=e,this._dt=n,this._s=r,t.call(this)}return ae(e,t),e.prototype.subscribeCore=function(t){var e=new ve;return new be(this.source.subscribe(new Br(t,this._dt,this._s,e)),e)},e}(Ke),Br=function(t){function e(e,n,r,i){this._o=e,this._d=n,this._scheduler=r,this._c=i,this._v=null,this._hv=!1,this._id=0,t.call(this)}return ae(e,t),e.prototype.next=function(t){this._hv=!0,this._v=t;var e=++this._id,n=new ge;this._c.setDisposable(n),n.setDisposable(this._scheduler.scheduleFuture(this,this._d,function(n,r){r._hv&&r._id===e&&r._o.onNext(t),r._hv=!1}))},e.prototype.error=function(t){this._c.dispose(),this._o.onError(t),this._hv=!1,this._id++},e.prototype.completed=function(){this._c.dispose(),this._hv&&this._o.onNext(this._v),this._o.onCompleted(),this._hv=!1,this._id++},e}(Ge);Ue.debounce=function(){if(xt(arguments[0]))return tt(this,arguments[0]);if("number"==typeof arguments[0])return new Ur(this,arguments[0],arguments[1]);throw new Error("Invalid arguments")};var zr=function(t){function e(e,n){this.source=e,this._s=n,t.call(this)}return ae(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new Lr(t,this._s))},e}(Ke),Lr=function(t){function e(e,n){this._o=e,this._s=n,t.call(this)}return ae(e,t),e.prototype.next=function(t){this._o.onNext({value:t,timestamp:this._s.now()})},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onCompleted()},e}(Ge);Ue.timestamp=function(t){return Ie(t)||(t=Re),new zr(this,t)};var jr=function(t){function e(e,n){this.source=e,this._sampler=n,t.call(this)}return ae(e,t),e.prototype.subscribeCore=function(t){var e={o:t,atEnd:!1,value:null,hasValue:!1,sourceSubscription:new ge};return e.sourceSubscription.setDisposable(this.source.subscribe(new Xr(e))),new be(e.sourceSubscription,this._sampler.subscribe(new Vr(e)))},e}(Ke),Vr=function(t){function e(e){this._s=e,t.call(this)}return ae(e,t),e.prototype._handleMessage=function(){this._s.hasValue&&(this._s.hasValue=!1,this._s.o.onNext(this._s.value)),this._s.atEnd&&this._s.o.onCompleted()},e.prototype.next=function(){this._handleMessage()},e.prototype.error=function(t){this._s.onError(t)},e.prototype.completed=function(){this._handleMessage()},e}(Ge),Xr=function(t){function e(e){this._s=e,t.call(this)}return ae(e,t),e.prototype.next=function(t){this._s.hasValue=!0,this._s.value=t},e.prototype.error=function(t){this._s.o.onError(t)},e.prototype.completed=function(){this._s.atEnd=!0,this._s.sourceSubscription.dispose()},e}(Ge);Ue.sample=function(t,e){return Ie(e)||(e=Re),"number"==typeof t?new jr(this,qr(t,e)):new jr(this,t)};var Yr=pt.TimeoutError=function(t){this.message=t||"Timeout has occurred",this.name="TimeoutError",Error.call(this)};Yr.prototype=Object.create(Error.prototype),Ue.timeout=function(){var t=arguments[0];if(t instanceof Date||"number"==typeof t)return nt(this,t,arguments[1],arguments[2]);if(Qe.isObservable(t)||xt(t))return et(this,t,arguments[1],arguments[2]);throw new Error("Invalid arguments")},Ue.throttle=function(t,e){Ie(e)||(e=Re);var n=+t||0;if(n<=0)throw new RangeError("windowDuration cannot be less or equal zero.");var r=this;return new Jr(function(t){var i=0;return r.subscribe(function(r){var o=e.now();(0===i||o-i>=n)&&(i=o,t.onNext(r))},function(e){t.onError(e)},function(){t.onCompleted()})},r)};var Zr=function(t){function e(e,n){this.source=e,this.controller=new ti,this.paused=!0,n&&n.subscribe?this.pauser=this.controller.merge(n):this.pauser=this.controller,t.call(this)}return ae(e,t),e.prototype._subscribe=function(t){var e=this.source.publish(),n=e.subscribe(t),r=le,i=this.pauser.startWith(!this.paused).distinctUntilChanged().subscribe(function(t){t?r=e.connect():(r.dispose(),r=le)});return new _e([n,r,i])},e.prototype.pause=function(){this.paused=!0,this.controller.onNext(!1)},e.prototype.resume=function(){this.paused=!1,this.controller.onNext(!0)},e}(Qe);Ue.pausable=function(t){return new Zr(this,t)};var Hr=function(t){function e(e,n){this.source=e,this.controller=new ti,this.paused=!0,n&&n.subscribe?this.pauser=this.controller.merge(n):this.pauser=this.controller,t.call(this)}return ae(e,t),e.prototype._subscribe=function(t){function e(){for(;i.length>0;)t.onNext(i.shift())}var r,i=[];return rt(this.source,this.pauser.startWith(!this.paused).distinctUntilChanged(),function(t,e){return{data:t,shouldFire:e}}).subscribe(function(o){r!==n&&o.shouldFire!==r?(r=o.shouldFire,o.shouldFire&&e()):(r=o.shouldFire,o.shouldFire?t.onNext(o.data):i.push(o.data))},function(n){e(),t.onError(n)},function(){e(),t.onCompleted()})},e.prototype.pause=function(){this.paused=!0,this.controller.onNext(!1)},e.prototype.resume=function(){this.paused=!1,this.controller.onNext(!0)},e}(Qe);Ue.pausableBuffered=function(t){return new Hr(this,t)};var Gr=function(t){function e(e,n,r){t.call(this),this.subject=new Wr(n,r),this.source=e.multicast(this.subject).refCount()}return ae(e,t),e.prototype._subscribe=function(t){return this.source.subscribe(t)},e.prototype.request=function(t){return this.subject.request(null==t?-1:t)},e}(Qe),Wr=function(t){function e(e,n){null==e&&(e=!0),t.call(this),this.subject=new ti,this.enableQueue=e,this.queue=e?[]:null,this.requestedCount=0,this.requestedDisposable=null,this.error=null,this.hasFailed=!1,this.hasCompleted=!1,this.scheduler=n||Te}return ae(e,t),ue(e.prototype,Ze,{_subscribe:function(t){return this.subject.subscribe(t)},onCompleted:function(){this.hasCompleted=!0,this.enableQueue&&0!==this.queue.length?this.queue.push(Be.createOnCompleted()):(this.subject.onCompleted(),this.disposeCurrentRequest())},onError:function(t){this.hasFailed=!0,this.error=t,this.enableQueue&&0!==this.queue.length?this.queue.push(Be.createOnError(t)):(this.subject.onError(t),this.disposeCurrentRequest())},onNext:function(t){this.requestedCount<=0?this.enableQueue&&this.queue.push(Be.createOnNext(t)):(0==this.requestedCount--&&this.disposeCurrentRequest(),this.subject.onNext(t))},_processRequest:function(t){if(this.enableQueue)for(;this.queue.length>0&&(t>0||"N"!==this.queue[0].kind);){var e=this.queue.shift();e.accept(this.subject),"N"===e.kind?t--:(this.disposeCurrentRequest(),this.queue=[])}return t},request:function(t){this.disposeCurrentRequest();var e=this;return this.requestedDisposable=this.scheduler.schedule(t,function(t,n){var r=e._processRequest(n);if(!e.hasCompleted&&!e.hasFailed&&r>0)return e.requestedCount=r,de(function(){e.requestedCount=0})}),this.requestedDisposable},disposeCurrentRequest:function(){this.requestedDisposable&&(this.requestedDisposable.dispose(),this.requestedDisposable=null)}}),e}(Qe);Ue.controlled=function(t,e){return t&&Ie(t)&&(e=t,t=!0),null==t&&(t=!0),new Gr(this,t,e)},Ue.pipe=function(t){function e(){n.resume()}var n=this.pausableBuffered();return t.addListener("drain",e),n.subscribe(function(e){!t.write(e)&&n.pause()},function(e){t.emit("error",e)},function(){!t._isStdio&&t.end(),t.removeListener("drain",e)}),n.resume(),t};var Qr=function(t){function e(e,n){this._o=e,this._xform=n,t.call(this)}return ae(e,t),e.prototype.next=function(t){var e=It(this._xform["@@transducer/step"]).call(this._xform,this._o,t);e===Ct&&this._o.onError(e.e)},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._xform["@@transducer/result"](this._o)},e}(Ge);Ue.transduce=function(t){var e=this;return new Jr(function(n){var r=t(it(n));return e.subscribe(new Qr(n,r))},e)};var Jr=pt.AnonymousObservable=function(t){function e(t){return t&&xt(t.dispose)?t:xt(t)?de(t):le}function n(t,n){var r=n[0],i=n[1],o=It(i.__subscribe).call(i,r);o!==Ct||r.fail(Ct.e)||s(Ct.e),r.setDisposable(e(o))}function r(e,n){this.source=n,this.__subscribe=e,t.call(this)}return ae(r,t),r.prototype._subscribe=function(t){var e=new Kr(t),r=[e,this];return Te.scheduleRequired()?Te.schedule(r,n):n(null,r),e},r}(Qe),Kr=function(t){function e(e){t.call(this),this.observer=e,this.m=new ge}ae(e,t);var n=e.prototype;return n.next=function(t){var e=It(this.observer.onNext).call(this.observer,t);e===Ct&&(this.dispose(),s(e.e))},n.error=function(t){var e=It(this.observer.onError).call(this.observer,t);this.dispose(),e===Ct&&s(e.e)},n.completed=function(){var t=It(this.observer.onCompleted).call(this.observer);this.dispose(),t===Ct&&s(t.e)},n.setDisposable=function(t){this.m.setDisposable(t)},n.getDisposable=function(){return this.m.getDisposable()},n.dispose=function(){t.prototype.dispose.call(this),this.m.dispose()},e}(Ge),$r=function(t,e){this._s=t,this._o=e};$r.prototype.dispose=function(){if(!this._s.isDisposed&&null!==this._o){var t=this._s.observers.indexOf(this._o);this._s.observers.splice(t,1),this._o=null}};var ti=pt.Subject=function(t){function e(){t.call(this),this.isDisposed=!1,this.isStopped=!1,this.observers=[],this.hasError=!1}return ae(e,t),ue(e.prototype,Ze.prototype,{_subscribe:function(t){return me(this),this.isStopped?this.hasError?(t.onError(this.error),le):(t.onCompleted(),le):(this.observers.push(t),new $r(this,t))},hasObservers:function(){return me(this),this.observers.length>0},onCompleted:function(){if(me(this),!this.isStopped){this.isStopped=!0;for(var t=0,e=i(this.observers),n=e.length;t<n;t++)e[t].onCompleted();this.observers.length=0}},onError:function(t){if(me(this),!this.isStopped){this.isStopped=!0,this.error=t,this.hasError=!0;for(var e=0,n=i(this.observers),r=n.length;e<r;e++)n[e].onError(t);this.observers.length=0}},onNext:function(t){if(me(this),!this.isStopped)for(var e=0,n=i(this.observers),r=n.length;e<r;e++)n[e].onNext(t)},dispose:function(){this.isDisposed=!0,this.observers=null}}),e.create=function(t,e){return new ni(t,e)},e}(Qe),ei=pt.AsyncSubject=function(t){function e(){t.call(this),this.isDisposed=!1,this.isStopped=!1,this.hasValue=!1,this.observers=[],this.hasError=!1}return ae(e,t),ue(e.prototype,Ze.prototype,{_subscribe:function(t){return me(this),this.isStopped?(this.hasError?t.onError(this.error):this.hasValue?(t.onNext(this.value),t.onCompleted()):t.onCompleted(),le):(this.observers.push(t),new $r(this,t))},hasObservers:function(){return me(this),this.observers.length>0},onCompleted:function(){var t,e;if(me(this),!this.isStopped){this.isStopped=!0;var n=i(this.observers),e=n.length;if(this.hasValue)for(t=0;t<e;t++){var r=n[t];r.onNext(this.value),r.onCompleted()}else for(t=0;t<e;t++)n[t].onCompleted();this.observers.length=0}},onError:function(t){if(me(this),!this.isStopped){this.isStopped=!0,this.hasError=!0,this.error=t;for(var e=0,n=i(this.observers),r=n.length;e<r;e++)n[e].onError(t);this.observers.length=0}},onNext:function(t){me(this),this.isStopped||(this.value=t,this.hasValue=!0)},dispose:function(){this.isDisposed=!0,this.observers=null,this.error=null,this.value=null}}),e}(Qe),ni=pt.AnonymousSubject=function(t){function e(e,n){this.observer=e,this.observable=n,t.call(this)}return ae(e,t),ue(e.prototype,Ze.prototype,{_subscribe:function(t){return this.observable.subscribe(t)},onCompleted:function(){this.observer.onCompleted()},onError:function(t){this.observer.onError(t)},onNext:function(t){this.observer.onNext(t)}}),e}(Qe),ri=pt.BehaviorSubject=function(t){function e(e){t.call(this),this.value=e,this.observers=[],this.isDisposed=!1,this.isStopped=!1,this.hasError=!1}return ae(e,t),ue(e.prototype,Ze.prototype,{_subscribe:function(t){return me(this),this.isStopped?(this.hasError?t.onError(this.error):t.onCompleted(),le):(this.observers.push(t),t.onNext(this.value),new $r(this,t))},getValue:function(){return me(this),this.hasError&&s(this.error),this.value},hasObservers:function(){return me(this),this.observers.length>0},onCompleted:function(){if(me(this),!this.isStopped){this.isStopped=!0;for(var t=0,e=i(this.observers),n=e.length;t<n;t++)e[t].onCompleted();this.observers.length=0}},onError:function(t){if(me(this),!this.isStopped){this.isStopped=!0,this.hasError=!0,this.error=t;for(var e=0,n=i(this.observers),r=n.length;e<r;e++)n[e].onError(t);this.observers.length=0}},onNext:function(t){if(me(this),!this.isStopped){this.value=t;for(var e=0,n=i(this.observers),r=n.length;e<r;e++)n[e].onNext(t)}},dispose:function(){this.isDisposed=!0,this.observers=null,this.value=null,this.error=null}}),e}(Qe),ii=pt.ReplaySubject=function(t){function e(t,e){return de(function(){e.dispose(),!t.isDisposed&&t.observers.splice(t.observers.indexOf(e),1)})}function n(e,n,i){this.bufferSize=null==e?r:e,this.windowSize=null==n?r:n,this.scheduler=i||Te,this.q=[],this.observers=[],this.isStopped=!1,this.isDisposed=!1,this.hasError=!1,this.error=null,t.call(this)}var r=Math.pow(2,53)-1;return ae(n,t),ue(n.prototype,Ze.prototype,{_subscribe:function(t){me(this);var n=new Je(this.scheduler,t),r=e(this,n);this._trim(this.scheduler.now()),this.observers.push(n);for(var i=0,o=this.q.length;i<o;i++)n.onNext(this.q[i].value);return this.hasError?n.onError(this.error):this.isStopped&&n.onCompleted(),n.ensureActive(),r},hasObservers:function(){return me(this),this.observers.length>0},_trim:function(t){for(;this.q.length>this.bufferSize;)this.q.shift();for(;this.q.length>0&&t-this.q[0].interval>this.windowSize;)this.q.shift()},onNext:function(t){if(me(this),!this.isStopped){var e=this.scheduler.now();this.q.push({interval:e,value:t}),this._trim(e);for(var n=0,r=i(this.observers),o=r.length;n<o;n++){var s=r[n];s.onNext(t),s.ensureActive()}}},onError:function(t){if(me(this),!this.isStopped){this.isStopped=!0,this.error=t,this.hasError=!0;var e=this.scheduler.now();this._trim(e);for(var n=0,r=i(this.observers),o=r.length;n<o;n++){var s=r[n];s.onError(t),s.ensureActive()}this.observers.length=0}},onCompleted:function(){if(me(this),!this.isStopped){this.isStopped=!0;var t=this.scheduler.now();this._trim(t);for(var e=0,n=i(this.observers),r=n.length;e<r;e++){var o=n[e];o.onCompleted(),o.ensureActive()}this.observers.length=0}},dispose:function(){this.isDisposed=!0,this.observers=null}}),n}(Qe);pt.Pauser=function(t){function e(){t.call(this)}return ae(e,t),e.prototype.pause=function(){this.onNext(!1)},e.prototype.resume=function(){this.onNext(!0)},e}(ti),t.Rx=pt;var oi=f()}).call(this,n,t);var r,i=n.Rx;!function(t){t.VERSION={number:"1.1.4",date:"Jan 18 2017"}}(r||(r={}));var r;!function(t){!function(t){!function(t){function e(t){return t.creator&&t.chunkSize}function n(t,e,n,r,i){return t.currentIndex>=t.chunkSize&&(t.currentIndex=0,t.current=t.creator(t.chunkSize),t.parts[t.parts.length]=t.current),t.current[t.currentIndex++]=e,t.current[t.currentIndex++]=n,t.current[t.currentIndex++]=r,t.current[t.currentIndex++]=i,t.elementCount++}function r(t,e,n,r){return t.currentIndex>=t.chunkSize&&(t.currentIndex=0,t.current=t.creator(t.chunkSize),t.parts[t.parts.length]=t.current),t.current[t.currentIndex++]=e,t.current[t.currentIndex++]=n,t.current[t.currentIndex++]=r,t.elementCount++}function i(t,e,n){return t.currentIndex>=t.chunkSize&&(t.currentIndex=0,t.current=t.creator(t.chunkSize),t.parts[t.parts.length]=t.current),t.current[t.currentIndex++]=e,t.current[t.currentIndex++]=n,t.elementCount++}function o(t,e){return t.currentIndex>=t.chunkSize&&(t.currentIndex=0,t.current=t.creator(t.chunkSize),t.parts[t.parts.length]=t.current),t.current[t.currentIndex++]=e,t.elementCount++}function s(t){var e,n=t.creator(t.elementSize*t.elementCount),r=(t.parts.length-1)*t.chunkSize,i=0;if(t.parts.length>1)if(t.parts[0].buffer)for(var o=0;o<t.parts.length-1;o++)n.set(t.parts[o],t.chunkSize*o);else for(var o=0;o<t.parts.length-1;o++){i=t.chunkSize*o,e=t.parts[o];for(var s=0;s<t.chunkSize;s++)n[i+s]=e[s]}if(t.current.buffer&&t.currentIndex>=t.chunkSize)n.set(t.current,t.chunkSize*(t.parts.length-1));else for(var o=0;o<t.currentIndex;o++)n[r+o]=t.current[o];return n}function a(t){return void 0===t&&(t=262144),p(function(t){return new Float32Array(t)},t,3)}function u(t){return void 0===t&&(t=262144),p(function(t){return new Uint32Array(t)},t,3)}function c(t){return void 0===t&&(t=131072),p(function(t){return new Int32Array(t)},t,2)}function h(t){return void 0===t&&(t=131072),p(function(t){return new Int32Array(t)},t,1)}function f(t){return void 0===t&&(t=131072),p(function(t){return new Int32Array(t)},t,1)}function d(t){return void 0===t&&(t=131072),p(function(t){return new Float32Array(t)},t,1)}function l(t){return void 0===t&&(t=131072),p(function(t){return[]},t,1)}function p(t,e,n){(e|=0)<=0&&(e=1);var r=e*n,i=t(r);return{elementSize:n,chunkSize:r,creator:t,current:i,parts:[i],currentIndex:0,elementCount:0}}t.is=e,t.add4=n,t.add3=r,t.add2=i,t.add=o,t.compact=s,t.forVertex3D=a,t.forIndexBuffer=u,t.forTokenIndices=c,t.forIndices=h,t.forInt32=f,t.forFloat32=d,t.forArray=l,t.create=p}(t.ChunkedArray||(t.ChunkedArray={}))}(t.Utils||(t.Utils={}))}(r||(r={}));var r;!function(t){!function(t){!function(t){function e(t,e,r){for(;e<r&&32===t.charCodeAt(e);)e++;return n(t,e,r)}function n(t,e,n){var r=0,i=1;for(45===t.charCodeAt(e)&&(i=-1,e++);e<n;e++){var o=t.charCodeAt(e)-48;if(o>9||o<0)return i*r|0;r=10*r+o|0}return i*r}function r(t,e,r,i){return 43===e.charCodeAt(r)&&r++,t*Math.pow(10,n(e,r,i))}function i(t,e,n){for(;e<n&&32===t.charCodeAt(e);)e++;return o(t,e,n)}function o(t,e,n){var i=1,o=0,s=0,a=1;for(45===t.charCodeAt(e)&&(i=-1,++e);e<n;){var u=t.charCodeAt(e)-48;if(!(u>=0&&u<10)){if(u===-2){for(++e;e<n;){if(!((u=t.charCodeAt(e)-48)>=0&&u<10))return 53===u||21===u?r(i*(o+s/a),t,e+1,n):i*(o+s/a);s=10*s+u,a*=10,++e}return i*(o+s/a)}if(53===u||21===u)return r(i*o,t,e+1,n);break}o=10*o+u,++e}return i*o}t.parseIntSkipTrailingWhitespace=e,t.parseInt=n,t.parseFloatSkipTrailingWhitespace=i,t.parseFloat=o}(t.FastNumberParsers||(t.FastNumberParsers={}))}(t.Utils||(t.Utils={}))}(r||(r={}));var r;!function(t){!function(t){var e=[];!function(){for(var t="",n=0;n<512;n++)e[n]=t,t+=" "}();!function(t){function n(t){return void 0===t&&(t=512),{chunkData:[],chunkOffset:0,chunkCapacity:t,data:[]}}function r(t){return t.data.length?(t.chunkOffset>0&&(t.data[t.data.length]=t.chunkData.splice(0,t.chunkOffset).join("")),t.data.join("")):t.chunkData.length===t.chunkOffset?t.chunkData.join(""):t.chunkData.splice(0,t.chunkOffset).join("")}function i(t,e){o(t);for(var n=0,r=t.data;n<r.length;n++){var i=r[n];e.writeString(i)}}function o(t){t.chunkOffset>0&&(t.chunkData.length===t.chunkOffset?t.data[t.data.length]=t.chunkData.join(""):t.data[t.data.length]=t.chunkData.splice(0,t.chunkOffset).join(""),t.chunkOffset=0)}function s(t){u(t,"\n")}function a(t,n){u(t,e[n])}function u(t,e){void 0!==e&&null!==e&&(t.chunkOffset===t.chunkCapacity&&(t.data[t.data.length]=t.chunkData.join(""),t.chunkOffset=0),t.chunkData[t.chunkOffset++]=e)}function c(t,e){t.chunkOffset===t.chunkCapacity&&(t.data[t.data.length]=t.chunkData.join(""),t.chunkOffset=0),t.chunkData[t.chunkOffset++]=e}function h(t,n,r){void 0!==n&&null!==n||u(t,e[r]);var i=r-n.length;i>0&&u(t,e[i]),u(t,n)}function f(t,n,r){void 0!==n&&null!==n||u(t,e[r]);var i=r-n.length;u(t,n),i>0&&u(t,e[i])}function d(t,e){u(t,""+e)}function l(t,n,r){var i=""+n,o=r-i.length;o>0&&u(t,e[o]),u(t,i)}function p(t,n,r){var i=""+n,o=r-i.length;u(t,i),o>0&&u(t,e[o])}function m(t,e,n){u(t,""+Math.round(n*e)/n)}function y(t,n,r,i){var o=""+Math.round(r*n)/r,s=i-o.length;s>0&&u(t,e[s]),u(t,o)}function g(t,n,r,i){var o=""+Math.round(r*n)/r,s=i-o.length;u(t,o),s>0&&u(t,e[s])}t.create=n,t.asString=r,t.writeTo=i,t.newline=s,t.whitespace=a,t.write=u,t.writeSafe=c,t.writePadLeft=h,t.writePadRight=f,t.writeInteger=d,t.writeIntegerPadLeft=l,t.writeIntegerPadRight=p,t.writeFloat=m,t.writeFloatPadLeft=y,t.writeFloatPadRight=g}(t.StringWriter||(t.StringWriter={}))}(t.Utils||(t.Utils={}))}(r||(r={}));var r;!function(t){var e=function(){function t(){this.isDefined=!1}return t.prototype.getString=function(t){return null},t.prototype.getInteger=function(t){return 0},t.prototype.getFloat=function(t){return 0},t.prototype.getValuePresence=function(t){return 1},t.prototype.areValuesEqual=function(t,e){return!0},t.prototype.stringEquals=function(t,e){return null===e},t}();t.UndefinedColumn=new e;!function(t){function e(t,e,n,r,i){for(var o=[],s=1;s<=n;s++){for(var a=[],u=1;u<=r;u++)a[u-1]=t.getColumn(e+"["+s+"]["+u+"]").getFloat(i);o[s-1]=a}return o}function n(t,e,n,r,i){for(var o=[],s=1;s<=n;s++)o[s-1]=t.getColumn(e+"["+s+"]").getFloat(i);return o}t.getMatrix=e,t.getVector=n}(t.Category||(t.Category={}))}(r||(r={}));var r;!function(t){!function(t){function r(t,n){return void 0===n&&(n=-1),new e(t,n)}function i(t,e){return void 0===e&&(e=[]),new n(t,e)}t.error=r,t.success=i}(t.ParserResult||(t.ParserResult={}));var e=function(){function t(t,e){this.message=t,this.line=e,this.isError=!0}return t.prototype.toString=function(){return this.line>=0?"[Line "+this.line+"] "+this.message:this.message},t}();t.ParserError=e;var n=function(){function t(t,e){this.result=t,this.warnings=e,this.isError=!1}return t}();t.ParserSuccess=n}(r||(r={}));var r;!function(t){!function(e){var n;!function(t){function e(){return Object.create(null)}function n(t,e){if(e.length>6)return e;var n=t[e];return void 0!==n?n:(t[e]=e,e)}t.create=e,t.get=n}(n||(n={}));var r=function(){function t(t){this.dataBlocks=[],this.data=t}
return t.prototype.toJSON=function(){return this.dataBlocks.map(function(t){return t.toJSON()})},t}();e.File=r;var i=function(){function t(t,e){this.header=e,this.data=t,this.categoryList=[],this.additionalData={},this.categoryMap=new Map}return Object.defineProperty(t.prototype,"categories",{get:function(){return this.categoryList},enumerable:!0,configurable:!0}),t.prototype.getCategory=function(t){return this.categoryMap.get(t)},t.prototype.addCategory=function(t){this.categoryList[this.categoryList.length]=t,this.categoryMap.set(t.name,t)},t.prototype.toJSON=function(){return{id:this.header,categories:this.categoryList.map(function(t){return t.toJSON()}),additionalData:this.additionalData}},t}();e.DataBlock=i;var o=function(){function e(t,e,n,r,i,o,s){this.name=e,this.tokens=o,this.data=t,this.startIndex=n,this.endIndex=r,this.columnCount=i.length,this.rowCount=s/i.length|0,this.columnIndices=new Map,this.columnNameList=[];for(var a=0;a<i.length;a++){var u=i[a].substr(e.length+1);this.columnIndices.set(u,a),this.columnNameList.push(u)}}return Object.defineProperty(e.prototype,"columnNames",{get:function(){return this.columnNameList},enumerable:!0,configurable:!0}),e.prototype.getColumn=function(e){var n=this.columnIndices.get(e);return void 0!==n?new u(this,this.data,e,n):t.UndefinedColumn},e.prototype.toJSON=function(){for(var t=[],e=this.data,r=this.tokens,i=this.columnNameList,o=n.create(),s=0;s<this.rowCount;s++){for(var a={},u=0;u<this.columnCount;u++){var c=2*(s*this.columnCount+u);a[i[u]]=n.get(o,e.substring(r[c],r[c+1]))}t[s]=a}return{name:this.name,columns:i,rows:t}},e}();e.Category=o;var s=t.Utils.FastNumberParsers.parseInt,a=t.Utils.FastNumberParsers.parseFloat,u=function(){function t(t,e,r,i){this.data=e,this.name=r,this.index=i,this.stringPool=n.create(),this.isDefined=!0,this.tokens=t.tokens,this.columnCount=t.columnCount}return t.prototype.getString=function(t){var e=2*(t*this.columnCount+this.index),r=n.get(this.stringPool,this.data.substring(this.tokens[e],this.tokens[e+1]));return"."===r||"?"===r?null:r},t.prototype.getInteger=function(t){var e=2*(t*this.columnCount+this.index);return s(this.data,this.tokens[e],this.tokens[e+1])},t.prototype.getFloat=function(t){var e=2*(t*this.columnCount+this.index);return a(this.data,this.tokens[e],this.tokens[e+1])},t.prototype.stringEquals=function(t,e){var n=2*(t*this.columnCount+this.index),r=this.tokens[n],i=e.length;if(i!==this.tokens[n+1]-r)return!1;for(var o=0;o<i;o++)if(this.data.charCodeAt(o+r)!==e.charCodeAt(o))return!1;return!0},t.prototype.areValuesEqual=function(t,e){var n=2*(t*this.columnCount+this.index),r=2*(e*this.columnCount+this.index),i=this.tokens[n],o=this.tokens[r],s=this.tokens[n+1]-i;if(s!==this.tokens[r+1]-o)return!1;for(var a=0;a<s;a++)if(this.data.charCodeAt(a+i)!==this.data.charCodeAt(a+o))return!1;return!0},t.prototype.getValuePresence=function(t){var e=t*this.columnCount+this.index,n=this.tokens[2*e];if(this.tokens[2*e+1]-n!=1)return 0;var r=this.data.charCodeAt(n);return 46===r?1:63===r?2:0},t}();e.Column=u}(t.Text||(t.Text={}))}(r||(r={}));var r;!function(t){!function(e){function n(t){for(;t.position<t.length;)switch(t.data.charCodeAt(t.position)){case 9:case 10:case 13:case 32:return void(t.currentTokenEnd=t.position);default:++t.position}t.currentTokenEnd=t.position}function r(t,e){var n,r;for(++t.position;t.position<t.length;)if((r=t.data.charCodeAt(t.position))===e)switch(n=t.data.charCodeAt(t.position+1)){case 9:case 10:case 13:case 32:return t.currentTokenStart++,t.currentTokenEnd=t.position,t.isEscaped=!0,void++t.position;default:if(void 0===n)return t.currentTokenStart++,t.currentTokenEnd=t.position,t.isEscaped=!0,void++t.position;++t.position}else{if(10===r||13===r)return void(t.currentTokenEnd=t.position);++t.position}t.currentTokenEnd=t.position}function i(t){for(var e,n=59,r=t.position+1;r<t.length;){if(59===(e=t.data.charCodeAt(r))&&(10===n||13===n)){for(t.position=r+1,t.currentTokenStart++,r--,e=t.data.charCodeAt(r);10===e||13===e;)r--,e=t.data.charCodeAt(r);return t.currentTokenEnd=r+1,void(t.isEscaped=!0)}13===e?t.currentLineNumber++:10===e&&13!==n&&t.currentLineNumber++,n=e,++r}return t.position=r,n}function o(t){for(;t.position<t.length;){var e=t.data.charCodeAt(t.position);if(10===e||13===e)return;++t.position}}function s(t){for(var e=10;t.position<t.length;){var n=t.data.charCodeAt(t.position);switch(n){case 9:case 32:e=n,++t.position;break;case 10:13!==e&&++t.currentLineNumber,e=n,++t.position;break;case 13:e=n,++t.position,++t.currentLineNumber;break;default:return e}}return e}function a(t){var e=t.data.charCodeAt(t.currentTokenStart);return(68===e||100===e)&&((65===(e=t.data.charCodeAt(t.currentTokenStart+1))||97===e)&&((84===(e=t.data.charCodeAt(t.currentTokenStart+2))||116===e)&&(65===(e=t.data.charCodeAt(t.currentTokenStart+3))||97===e)))}function u(t){var e=t.data.charCodeAt(t.currentTokenStart);return(83===e||115===e)&&((65===(e=t.data.charCodeAt(t.currentTokenStart+1))||97===e)&&((86===(e=t.data.charCodeAt(t.currentTokenStart+2))||118===e)&&(69===(e=t.data.charCodeAt(t.currentTokenStart+3))||101===e)))}function c(t){if(t.currentTokenEnd-t.currentTokenStart!=5)return!1;var e=t.data.charCodeAt(t.currentTokenStart);return(76===e||108===e)&&((79===(e=t.data.charCodeAt(t.currentTokenStart+1))||111===e)&&((79===(e=t.data.charCodeAt(t.currentTokenStart+2))||111===e)&&(80===(e=t.data.charCodeAt(t.currentTokenStart+3))||112===e)))}function h(t,e,n){var r,i=n-e,o=t.currentTokenStart-e,s=t.currentTokenEnd-t.currentTokenStart;if(s<i)return!1;for(r=e;r<n;++r)if(t.data.charCodeAt(r)!==t.data.charCodeAt(r+o))return!1;return i===s||46===t.data.charCodeAt(r+o)}function f(t){var e;for(e=t.currentTokenStart;e<t.currentTokenEnd;++e)if(46===t.data.charCodeAt(e))return e;return e}function d(t,e){return t.data.substring(t.currentTokenStart,e)}function l(t){return t.data.substring(t.currentTokenStart,t.currentTokenEnd)}function p(t){var e=s(t);if(t.position>=t.length)return void(t.currentTokenType=6);t.currentTokenStart=t.position,t.currentTokenEnd=t.position,t.isEscaped=!1;var h=t.data.charCodeAt(t.position);switch(h){case 35:o(t),t.currentTokenType=5;break;case 34:case 39:r(t,h),t.currentTokenType=3;break;case 59:10===e||13===e?i(t):n(t),t.currentTokenType=3;break;default:n(t),t.isEscaped?t.currentTokenType=3:95===t.data.charCodeAt(t.currentTokenStart)?t.currentTokenType=4:t.currentTokenEnd-t.currentTokenStart>=5&&95===t.data.charCodeAt(t.currentTokenStart+4)?a(t)?t.currentTokenType=0:u(t)?t.currentTokenType=1:c(t)?t.currentTokenType=2:t.currentTokenType=3:t.currentTokenType=3}}function m(t){for(p(t);5===t.currentTokenType;)p(t)}function y(t){return{data:t,length:t.length,position:0,currentTokenStart:0,currentTokenEnd:0,currentTokenType:6,currentLineNumber:1,isEscaped:!1}}function g(t,n){for(var r,i=t.currentTokenStart,o=f(t),s=d(t,o),a=[],u=C.create(512),c=0,p=!0;p;){if(4!==t.currentTokenType||!h(t,i,o)){p=!1;break}if(r=l(t),m(t),3!==t.currentTokenType)return{hasError:!0,errorLine:t.currentLineNumber,errorMessage:"Expected value."};a[a.length]=r,C.addToken(u,t.currentTokenStart,t.currentTokenEnd),c++,m(t)}return n.addCategory(new e.Category(n.data,s,i,t.currentTokenStart,a,u.tokens,c)),{hasError:!1,errorLine:0,errorMessage:""}}function v(t,n){var r=t.currentTokenStart,i=t.currentLineNumber;m(t);for(var o=d(t,f(t)),s=[],a=C.create("_atom_site"===o?n.data.length/1.85|0:1024),u=0;4===t.currentTokenType;)s[s.length]=l(t),m(t);for(;3===t.currentTokenType;)C.addToken(a,t.currentTokenStart,t.currentTokenEnd),u++,m(t);return u%s.length!=0?{hasError:!0,errorLine:t.currentLineNumber,errorMessage:"The number of values for loop starting at line "+i+" is not a multiple of the number of columns."}:(n.addCategory(new e.Category(n.data,o,r,t.currentTokenStart,s,a.tokens,u)),{hasError:!1,errorLine:0,errorMessage:""})}function b(e,n){return t.ParserResult.error(n,e)}function _(e){return t.ParserResult.success(e)}function w(t){var n,r,i,o=y(t),s=new e.File(t),a=new e.DataBlock(t,"default"),u=new e.DataBlock(t,"empty"),c=!1;for(m(o);6!==o.currentTokenType;){var h=o.currentTokenType;if(0===h){if(c)return b(o.currentLineNumber,"Unexpected data block inside a save frame.");a.categories.length>0&&s.dataBlocks.push(a),a=new e.DataBlock(t,t.substring(o.currentTokenStart+5,o.currentTokenEnd)),m(o)}else if(1===h){if(r=t.substring(o.currentTokenStart+5,o.currentTokenEnd),0===r.length)u.categories.length>0&&(i=a.additionalData.saveFrames,i||(i=[],a.additionalData.saveFrames=i),i[i.length]=u),c=!1;else{if(c)return b(o.currentLineNumber,"Save frames cannot be nested.");c=!0,u=new e.DataBlock(t,r)}m(o)}else if(2===h){if(n=v(o,c?u:a),n.hasError)return b(n.errorLine,n.errorMessage)}else{if(4!==h)return b(o.currentLineNumber,"Unexpected token. Expected data_, loop_, or data name.");if(n=g(o,c?u:a),n.hasError)return b(n.errorLine,n.errorMessage)}}return c?b(o.currentLineNumber,"Unfinished save frame (`"+u.header+"`)."):(a.categories.length>0&&s.dataBlocks.push(a),_(s))}function x(t){return w(t)}var C;!function(t){function e(t){var e=new Int32Array(1.61*t.tokens.length|0);e.set(t.tokens),t.tokens=e,t.tokensLenMinus2=e.length-2|0}function n(t,n,r){t.count>=t.tokensLenMinus2&&e(t),t.tokens[t.count++]=n,t.tokens[t.count++]=r}function r(t){return{tokensLenMinus2:t-2|0,count:0,tokens:new Int32Array(t)}}t.addToken=n,t.create=r}(C||(C={})),e.parse=x}(t.Text||(t.Text={}))}(r||(r={}));var r;!function(t){!function(e){function n(t){return!!t&&t.indexOf("\n")>=0}function r(t,e){for(var r=t.desc.fields,i=t.data,o=r.reduce(function(t,e){return Math.max(t,e.name.length)},0)+t.desc.name.length+5,f=0,d=r;f<d.length;f++){var l=d[f];h.writePadRight(e,t.desc.name+"."+l.name,o);var p=l.presence,m=void 0;if(p&&0!==(m=p(i,0)))1===m?s(e):a(e);else{var y=l.string(i,0);n(y)?(c(e,y),h.newline(e)):u(e,y)}h.newline(e)}h.write(e,"#\n")}function i(t,e){o(e,"loop_");for(var r=t[0],i=r.desc.fields,f=0,d=i;f<d.length;f++){var l=d[f];o(e,r.desc.name+"."+l.name)}for(var p=0,m=t;p<m.length;p++)for(var y=m[p],g=y.data,v=y.count,b=0;b<v;b++){for(var _=0,w=i;_<w.length;_++){var l=w[_],x=l.presence,C=void 0;if(x&&0!==(C=x(g,b)))1===C?s(e):a(e);else{var I=l.string(g,b);n(I)?(c(e,I),h.newline(e)):u(e,I)}}h.newline(e)}h.write(e,"#\n")}function o(t,e){h.write(t,e),h.newline(t)}function s(t){h.writeSafe(t,". ")}function a(t){h.writeSafe(t,"? ")}function u(t,e){if(!e)return void h.writeSafe(t,". ");for(var n=!1,r="'",i="' ",o=!1,s=!1,a=!1,u=0,c=e.length-1;u<c;u++){switch(e.charCodeAt(u)){case 9:o=!0;break;case 10:return h.writeSafe(t,"\n;"+e),void h.writeSafe(t,"\n; ");case 32:o=!0;break;case 34:if(s)return h.writeSafe(t,"\n;"+e),void h.writeSafe(t,"\n; ");a=!0,n=!0,r="'",i="' ";break;case 39:if(a)return h.writeSafe(t,"\n;"+e),void h.writeSafe(t,"\n; ");n=!0,s=!0,r='"',i='" '}}var f=e.charCodeAt(0);n||35!==f&&59!==f&&!o||(r="'",i="' ",n=!0),n?h.writeSafe(t,r+e+i):(h.write(t,e),h.writeSafe(t," "))}function c(t,e){h.writeSafe(t,"\n;"+e),h.writeSafe(t,"\n; ")}var h=t.Utils.StringWriter,f=function(){function t(){this.writer=h.create(),this.encoded=!1,this.dataBlockCreated=!1}return t.prototype.startDataBlock=function(t){this.dataBlockCreated=!0,h.write(this.writer,"data_"+(t||"").replace(/[ \n\t]/g,"").toUpperCase()+"\n#\n")},t.prototype.writeCategory=function(t,e){if(this.encoded)throw new Error("The writer contents have already been encoded, no more writing.");if(!this.dataBlockCreated)throw new Error("No data block created.");var n=e&&e.length?e.map(function(e){return t(e)}):[t(void 0)],o=n.filter(function(t){return t&&t.count>0});if(o.length){var s=o.reduce(function(t,e){return t+(void 0===e.count?1:e.count)},0);s&&(1===s?r(o[0],this.writer):i(o,this.writer))}},t.prototype.encode=function(){this.encoded=!0},t.prototype.flush=function(t){h.writeTo(this.writer,t)},t}();e.Writer=f}(t.Text||(t.Text={}))}(r||(r={}));var r;!function(t){!function(t){!function(t){function e(t,e){for(var n={},r=0;r<e;r++){n[o(t)]=o(t)}return n}function n(t,e){for(var n=new Uint8Array(e),r=t.offset,i=0;i<e;i++)n[i]=t.buffer[i+r];return t.offset+=e,n}function r(e,n){var r=t.utf8Read(e.buffer,e.offset,n);return e.offset+=n,r}function i(t,e){for(var n=new Array(e),r=0;r<e;r++)n[r]=o(t);return n}function o(t){var o,s,a=t.buffer[t.offset];if(0==(128&a))return t.offset++,a;if(128==(240&a))return s=15&a,t.offset++,e(t,s);if(144==(240&a))return s=15&a,t.offset++,i(t,s);if(160==(224&a))return s=31&a,t.offset++,r(t,s);if(224==(224&a))return o=t.dataView.getInt8(t.offset),t.offset++,o;switch(a){case 192:return t.offset++,null;case 194:return t.offset++,!1;case 195:return t.offset++,!0;case 196:return s=t.dataView.getUint8(t.offset+1),t.offset+=2,n(t,s);case 197:return s=t.dataView.getUint16(t.offset+1),t.offset+=3,n(t,s);case 198:return s=t.dataView.getUint32(t.offset+1),t.offset+=5,n(t,s);case 202:return o=t.dataView.getFloat32(t.offset+1),t.offset+=5,o;case 203:return o=t.dataView.getFloat64(t.offset+1),t.offset+=9,o;case 204:return o=t.buffer[t.offset+1],t.offset+=2,o;case 205:return o=t.dataView.getUint16(t.offset+1),t.offset+=3,o;case 206:return o=t.dataView.getUint32(t.offset+1),t.offset+=5,o;case 208:return o=t.dataView.getInt8(t.offset+1),t.offset+=2,o;case 209:return o=t.dataView.getInt16(t.offset+1),t.offset+=3,o;case 210:return o=t.dataView.getInt32(t.offset+1),t.offset+=5,o;case 217:return s=t.dataView.getUint8(t.offset+1),t.offset+=2,r(t,s);case 218:return s=t.dataView.getUint16(t.offset+1),t.offset+=3,r(t,s);case 219:return s=t.dataView.getUint32(t.offset+1),t.offset+=5,r(t,s);case 220:return s=t.dataView.getUint16(t.offset+1),t.offset+=3,i(t,s);case 221:return s=t.dataView.getUint32(t.offset+1),t.offset+=5,i(t,s);case 222:return s=t.dataView.getUint16(t.offset+1),t.offset+=3,e(t,s);case 223:return s=t.dataView.getUint32(t.offset+1),t.offset+=5,e(t,s)}throw new Error("Unknown type 0x"+a.toString(16))}function s(t){return o({buffer:t,offset:0,dataView:new DataView(t.buffer)})}t.decode=s}(t.MessagePack||(t.MessagePack={}))}(t.Binary||(t.Binary={}))}(r||(r={}));var r;!function(t){!function(t){!function(t){function e(t){var e=new ArrayBuffer(n(t)),i=new DataView(e),o=new Uint8Array(e);return r(t,i,o,0),o}function n(e){var r=typeof e;if("string"===r){var i=t.utf8ByteCount(e);if(i<32)return 1+i;if(i<256)return 2+i;if(i<65536)return 3+i;if(i<4294967296)return 5+i}if(e instanceof Uint8Array){var o=e.byteLength;if(o<256)return 2+o;if(o<65536)return 3+o;if(o<4294967296)return 5+o}if("number"===r){if(Math.floor(e)!==e)return 9;if(e>=0){if(e<128)return 1;if(e<256)return 2;if(e<65536)return 3;if(e<4294967296)return 5;throw new Error("Number too big 0x"+e.toString(16))}if(e>=-32)return 1;if(e>=-128)return 2;if(e>=-32768)return 3;if(e>=-2147483648)return 5;throw new Error("Number too small -0x"+e.toString(16).substr(1))}if("boolean"===r||null===e||void 0===e)return 1;if("object"===r){var s,a=0;if(Array.isArray(e)){s=e.length;for(var u=0;u<s;u++)a+=n(e[u])}else{var c=Object.keys(e);s=c.length;for(var u=0;u<s;u++){var h=c[u];a+=n(h)+n(e[h])}}if(s<16)return 1+a;if(s<65536)return 3+a;if(s<4294967296)return 5+a;throw new Error("Array or object too long 0x"+s.toString(16))}throw new Error("Unknown type "+r)}function r(e,n,i,o){var s=typeof e;if("string"===s){var a=t.utf8ByteCount(e);if(a<32)return n.setUint8(o,160|a),t.utf8Write(i,o+1,e),1+a;if(a<256)return n.setUint8(o,217),n.setUint8(o+1,a),t.utf8Write(i,o+2,e),2+a;if(a<65536)return n.setUint8(o,218),n.setUint16(o+1,a),t.utf8Write(i,o+3,e),3+a;if(a<4294967296)return n.setUint8(o,219),n.setUint32(o+1,a),t.utf8Write(i,o+5,e),5+a}if(e instanceof Uint8Array){var u=e.byteLength,c=new Uint8Array(n.buffer);if(u<256)return n.setUint8(o,196),n.setUint8(o+1,u),c.set(e,o+2),2+u;if(u<65536)return n.setUint8(o,197),n.setUint16(o+1,u),c.set(e,o+3),3+u;if(u<4294967296)return n.setUint8(o,198),n.setUint32(o+1,u),c.set(e,o+5),5+u}if("number"===s){if(!isFinite(e))throw new Error("Number not finite: "+e);if(Math.floor(e)!==e)return n.setUint8(o,203),n.setFloat64(o+1,e),9;if(e>=0){if(e<128)return n.setUint8(o,e),1;if(e<256)return n.setUint8(o,204),n.setUint8(o+1,e),2;if(e<65536)return n.setUint8(o,205),n.setUint16(o+1,e),3;if(e<4294967296)return n.setUint8(o,206),n.setUint32(o+1,e),5;throw new Error("Number too big 0x"+e.toString(16))}if(e>=-32)return n.setInt8(o,e),1;if(e>=-128)return n.setUint8(o,208),n.setInt8(o+1,e),2;if(e>=-32768)return n.setUint8(o,209),n.setInt16(o+1,e),3;if(e>=-2147483648)return n.setUint8(o,210),n.setInt32(o+1,e),5;throw new Error("Number too small -0x"+(-e).toString(16).substr(1))}if(null===e||void 0===e)return n.setUint8(o,192),1;if("boolean"===s)return n.setUint8(o,e?195:194),1;if("object"===s){var h,f=0,d=Array.isArray(e),l=void 0;if(d?h=e.length:(l=Object.keys(e),h=l.length),h<16?(n.setUint8(o,h|(d?144:128)),f=1):h<65536?(n.setUint8(o,d?220:222),n.setUint16(o+1,h),f=3):h<4294967296&&(n.setUint8(o,d?221:223),n.setUint32(o+1,h),f=5),d)for(var p=0;p<h;p++)f+=r(e[p],n,i,o+f);else for(var m=0,y=l;m<y.length;m++){var g=y[m];f+=r(g,n,i,o+f),f+=r(e[g],n,i,o+f)}return f}throw new Error("Unknown type "+s)}t.encode=e}(t.MessagePack||(t.MessagePack={}))}(t.Binary||(t.Binary={}))}(r||(r={}));var r;!function(t){!function(t){!function(t){function e(t,e,n){for(var r=(t.byteLength,0),i=n.length;r<i;r++){var o=n.charCodeAt(r);if(o<128)t[e++]=o>>>0&127|0;else if(o<2048)t[e++]=o>>>6&31|192,t[e++]=o>>>0&63|128;else if(o<65536)t[e++]=o>>>12&15|224,t[e++]=o>>>6&63|128,t[e++]=o>>>0&63|128;else{if(!(o<1114112))throw new Error("bad codepoint "+o);t[e++]=o>>>18&7|240,t[e++]=o>>>12&63|128,t[e++]=o>>>6&63|128,t[e++]=o>>>0&63|128}}}function n(t){throw new Error(t)}function r(t,e,r){for(var i=o,s=void 0,a=[],u=0,c=e,h=e+r;c<h;c++){var f=t[c];0==(128&f)?a[u++]=i[f]:192==(224&f)?a[u++]=i[(15&f)<<6|63&t[++c]]:224==(240&f)?a[u++]=String.fromCharCode((15&f)<<12|(63&t[++c])<<6|(63&t[++c])<<0):240==(248&f)?a[u++]=String.fromCharCode((7&f)<<18|(63&t[++c])<<12|(63&t[++c])<<6|(63&t[++c])<<0):n("Invalid byte "+f.toString(16)),512===u&&(s=s||[],s[s.length]=a.join(""),u=0)}return s?(u>0&&(s[s.length]=a.slice(0,u).join("")),s.join("")):a.slice(0,u).join("")}function i(t){for(var e=0,r=0,i=t.length;r<i;r++){var o=t.charCodeAt(r);o<128?e+=1:o<2048?e+=2:o<65536?e+=3:o<1114112?e+=4:n("bad codepoint "+o)}return e}t.utf8Write=e;var o=function(){for(var t=[],e=0;e<1024;e++)t[e]=String.fromCharCode(e);return t}();t.utf8Read=r,t.utf8ByteCount=i}(t.MessagePack||(t.MessagePack={}))}(t.Binary||(t.Binary={}))}(r||(r={}));var r;!function(t){!function(t){function e(t){for(var e=t.data,r=t.encoding.length-1;r>=0;r--)e=n.decodeStep(e,t.encoding[r]);return e}t.decode=e;var n;!function(t){function n(t,e){switch(e.kind){case"ByteArray":switch(e.type){case 4:return t;case 1:return o(t);case 2:return u(t);case 5:return c(t);case 3:return h(t);case 6:return f(t);case 32:return d(t);case 33:return l(t);default:throw new Error("Unsupported ByteArray type.")}case"FixedPoint":return p(t,e);case"IntervalQuantization":return m(t,e);case"RunLength":return y(t,e);case"Delta":return g(t,e);case"IntegerPacking":return _(t,e);case"StringArray":return w(t,e)}}function r(t,e){switch(t){case 1:return new Int8Array(e);case 2:return new Int16Array(e);case 3:return new Int32Array(e);case 4:return new Uint8Array(e);case 5:return new Uint16Array(e);case 6:return new Uint32Array(e);default:throw new Error("Unsupported integer data type.")}}function i(t,e){switch(t){case 32:return new Float32Array(e);case 33:return new Float64Array(e);default:throw new Error("Unsupported floating data type.")}}function o(t){return new Int8Array(t.buffer,t.byteOffset)}function s(t,e){for(var n=new ArrayBuffer(t.length),r=new Uint8Array(n),i=0,o=t.length;i<o;i+=e)for(var s=0;s<e;s++)r[i+e-s-1]=t[i+s];return n}function a(t,e,n){return new n(x?t.buffer:s(t,e))}function u(t){return a(t,2,Int16Array)}function c(t){return a(t,2,Uint16Array)}function h(t){return a(t,4,Int32Array)}function f(t){return a(t,4,Uint32Array)}function d(t){return a(t,4,Float32Array)}function l(t){return a(t,8,Float64Array)}function p(t,e){for(var n=t.length,r=i(e.srcType,n),o=1/e.factor,s=0;s<n;s++)r[s]=o*t[s];return r}function m(t,e){for(var n=t.length,r=i(e.srcType,n),o=(e.max-e.min)/(e.numSteps-1),s=e.min,a=0;a<n;a++)r[a]=s+o*t[a];return r}function y(t,e){for(var n=r(e.srcType,e.srcSize),i=0,o=0,s=t.length;o<s;o+=2)for(var a=t[o],u=t[o+1],c=0;c<u;++c)n[i++]=a;return n}function g(t,e){var n=t.length,i=r(e.srcType,n);if(!n)return i;i[0]=t[0]+(0|e.origin);for(var o=1;o<n;++o)i[o]=t[o]+i[o-1];return i}function v(t,e){for(var n=1===e.byteCount?127:32767,r=-n-1,i=t.length,o=new Int32Array(e.srcSize),s=0,a=0;s<i;){for(var u=0,c=t[s];c===n||c===r;)u+=c,s++,c=t[s];u+=c,o[a]=u,s++,a++}return o}function b(t,e){for(var n=1===e.byteCount?255:65535,r=t.length,i=new Int32Array(e.srcSize),o=0,s=0;o<r;){for(var a=0,u=t[o];u===n;)a+=u,o++,u=t[o];a+=u,i[s]=a,o++,s++}return i}function _(t,e){return e.isUnsigned?b(t,e):v(t,e)}function w(t,n){for(var r=n.stringData,i=e({encoding:n.offsetEncoding,data:n.offsets}),o=e({encoding:n.dataEncoding,data:t}),s=Object.create(null),a=new Array(o.length),u=0,c=0,h=o;c<h.length;c++){var f=h[c];if(f<0)a[u++]=null;else{var d=s[f];void 0===d&&(d=r.substring(i[f],i[f+1]),s[f]=d),a[u++]=d}}return a}t.decodeStep=n;var x=function(){var t=new ArrayBuffer(2),e=new Uint8Array(t),n=new Uint16Array(t);return e[0]=170,e[1]=187,48042===n[0]}()}(n||(n={}))}(t.Binary||(t.Binary={}))}(r||(r={}));var r;!function(t){!function(e){function n(n){if(!n.data.data)return t.UndefinedColumn;var r=e.decode(n.data),i=void 0;return n.mask&&(i=e.decode(n.mask)),r.buffer&&r.byteLength&&r.BYTES_PER_ELEMENT?i?new c(r,i):new u(r):i?new f(r,i):new h(r)}var r=function(){function t(t){this.dataBlocks=t.dataBlocks.map(function(t){return new i(t)})}return t.prototype.toJSON=function(){return this.dataBlocks.map(function(t){return t.toJSON()})},t}();e.File=r;var i=function(){function t(t){this.additionalData={},this.header=t.header,this.categoryList=t.categories.map(function(t){return new o(t)}),this.categoryMap=new Map;for(var e=0,n=this.categoryList;e<n.length;e++){var r=n[e];this.categoryMap.set(r.name,r)}}return Object.defineProperty(t.prototype,"categories",{get:function(){return this.categoryList},enumerable:!0,configurable:!0}),t.prototype.getCategory=function(t){return this.categoryMap.get(t)},t.prototype.toJSON=function(){return{id:this.header,categories:this.categoryList.map(function(t){return t.toJSON()}),additionalData:this.additionalData}},t}();e.DataBlock=i;var o=function(){function e(t){this.name=t.name,this.columnCount=t.columns.length,this.rowCount=t.rowCount,this.columnNameList=[],this.encodedColumns=new Map;for(var e=0,n=t.columns;e<n.length;e++){var r=n[e];this.encodedColumns.set(r.name,r),this.columnNameList.push(r.name)}}return Object.defineProperty(e.prototype,"columnNames",{get:function(){return this.columnNameList},enumerable:!0,configurable:!0}),e.prototype.getColumn=function(e){var r=this.encodedColumns.get(e);return r?n(r):t.UndefinedColumn},e.prototype.toJSON=function(){for(var t=this,e=[],n=this.columnNameList.map(function(e){return{name:e,column:t.getColumn(e)}}),r=0;r<this.rowCount;r++){for(var i={},o=0,s=n;o<s.length;o++){var a=s[o],u=a.column.getValuePresence(r);i[a.name]=0===u?a.column.getString(r):1===u?".":"?"}e[r]=i}return{name:this.name,columns:this.columnNames,rows:e}},e}();e.Category=o;var s=t.Utils.FastNumberParsers.parseInt,a=t.Utils.FastNumberParsers.parseFloat,u=function(){function t(t){this.data=t,this.isDefined=!0}return t.prototype.getString=function(t){return""+this.data[t]},t.prototype.getInteger=function(t){return 0|this.data[t]},t.prototype.getFloat=function(t){return 1*this.data[t]},t.prototype.stringEquals=function(t,e){return this.data[t]===a(e,0,e.length)},t.prototype.areValuesEqual=function(t,e){return this.data[t]===this.data[e]},t.prototype.getValuePresence=function(t){return 0},t}(),c=function(){function t(t,e){this.data=t,this.mask=e,this.isDefined=!0}return t.prototype.getString=function(t){return 0===this.mask[t]?""+this.data[t]:null},t.prototype.getInteger=function(t){return 0===this.mask[t]?this.data[t]:0},t.prototype.getFloat=function(t){return 0===this.mask[t]?this.data[t]:0},t.prototype.stringEquals=function(t,e){return 0===this.mask[t]?this.data[t]===a(e,0,e.length):null===e||void 0===e},t.prototype.areValuesEqual=function(t,e){return this.data[t]===this.data[e]},t.prototype.getValuePresence=function(t){return this.mask[t]},t}(),h=function(){function t(t){this.data=t,this.isDefined=!0}return t.prototype.getString=function(t){return this.data[t]},t.prototype.getInteger=function(t){var e=this.data[t];return s(e,0,e.length)},t.prototype.getFloat=function(t){var e=this.data[t];return a(e,0,e.length)},t.prototype.stringEquals=function(t,e){return this.data[t]===e},t.prototype.areValuesEqual=function(t,e){return this.data[t]===this.data[e]},t.prototype.getValuePresence=function(t){return 0},t}(),f=function(){function t(t,e){this.data=t,this.mask=e,this.isDefined=!0}return t.prototype.getString=function(t){return 0===this.mask[t]?this.data[t]:null},t.prototype.getInteger=function(t){if(0!==this.mask[t])return 0;var e=this.data[t];return s(e||"",0,(e||"").length)},t.prototype.getFloat=function(t){if(0!==this.mask[t])return 0;var e=this.data[t];return a(e||"",0,(e||"").length)},t.prototype.stringEquals=function(t,e){return this.data[t]===e},t.prototype.areValuesEqual=function(t,e){return this.data[t]===this.data[e]},t.prototype.getValuePresence=function(t){return this.mask[t]},t}()}(t.Binary||(t.Binary={}))}(r||(r={}));var r;!function(t){!function(e){var n=function(){function t(t){this.providers=t}return t.prototype.and=function(e){return new t(this.providers.concat([e]))},t.prototype.encode=function(t){for(var e=[],n=0,r=this.providers;n<r.length;n++){var i=r[n],o=i(t);if(!o.encodings.length)throw new Error("Encodings must be non-empty.");t=o.data;for(var s=0,a=o.encodings;s<a.length;s++){var u=a[s];e.push(u)}}if(!(t instanceof Uint8Array))throw new Error("The encoding must result in a Uint8Array. Fix your encoding chain.");return{encoding:e,data:t}},t}();e.Encoder=n;var n;!function(n){function r(t){return new n([t])}function i(t){return{encodings:[{kind:"ByteArray",type:4}],data:t}}function o(t){return{encodings:[{kind:"ByteArray",type:1}],data:new Uint8Array(t.buffer,t.byteOffset)}}function s(t){var n=e.Encoding.getDataType(t);if(1===n)return o(t);if(4===n)return i(t);for(var r=new Uint8Array(t.length*_[n]),s=b[n],a=new DataView(r.buffer),u=0,c=t.length;u<c;u++)s(a,u,t[u]);return{encodings:[{kind:"ByteArray",type:n}],data:r}}function a(t,n){for(var r=e.Encoding.getDataType(t),i=new Int32Array(t.length),o=0,s=t.length;o<s;o++)i[o]=Math.round(t[o]*n);return{encodings:[{kind:"FixedPoint",factor:n,srcType:r}],data:i}}function u(t){return function(e){return a(e,t)}}function c(t,n,r,i,o){var s=e.Encoding.getDataType(t);if(!t.length)return{encodings:[{kind:"IntervalQuantization",min:n,max:r,numSteps:i,srcType:s}],data:new Int32Array(0)};if(r<n){var a=n;n=r,r=a}for(var u=(r-n)/(i-1),c=new o(t.length),h=0,f=t.length;h<f;h++){var d=t[h];c[h]=d<=n?0:d>=r?i:0|Math.round((d-n)/u)}return{encodings:[{kind:"IntervalQuantization",min:n,max:r,numSteps:i,srcType:s}],data:c}}function h(t,e,n,r){return void 0===r&&(r=Int32Array),function(i){return c(i,t,e,n,r)}}function f(t){var n=e.Encoding.getDataType(t);if(void 0===n&&(t=new Int32Array(t),n=3),!t.length)return{encodings:[{kind:"RunLength",srcType:n,srcSize:0}],data:new Int32Array(0)};for(var r=2,i=1,o=t.length;i<o;i++)t[i-1]!==t[i]&&(r+=2);for(var s=new Int32Array(r),a=0,u=1,i=1,o=t.length;i<o;i++)t[i-1]!==t[i]?(s[a]=t[i-1],s[a+1]=u,u=1,a+=2):++u;return s[a]=t[t.length-1],s[a+1]=u,{encodings:[{kind:"RunLength",srcType:n,srcSize:t.length}],data:s}}function d(t){if(!e.Encoding.isSignedIntegerDataType(t))throw new Error("Only signed integer types can be encoded using delta encoding.");var n=e.Encoding.getDataType(t);if(void 0===n&&(t=new Int32Array(t),n=3),!t.length)return{encodings:[{kind:"Delta",origin:0,srcType:n}],data:new t.constructor(0)};var r=new t.constructor(t.length),i=t[0];r[0]=t[0];for(var o=1,s=t.length;o<s;o++)r[o]=t[o]-t[o-1];return r[0]=0,{encodings:[{kind:"Delta",origin:i,srcType:n}],data:r}}function l(t){for(var e=0,n=t.length;e<n;e++)if(t[e]<0)return!0;return!1}function p(t,e){for(var n=-e-1,r=0,i=0,o=t.length;i<o;i++){var s=t[i];r+=0===s?1:s===e||s===n?2:s>0?Math.ceil(s/e):Math.ceil(s/n)}return r}function m(t){var e=l(t),n=e?p(t,127):p(t,255),r=e?p(t,32767):p(t,65535);return 4*t.length<2*r?{isSigned:e,size:t.length,bytesPerElement:4}:2*r<n?{isSigned:e,size:r,bytesPerElement:2}:{isSigned:e,size:n,bytesPerElement:1}}function y(t,e){for(var n=e.isSigned?1===e.bytesPerElement?127:32767:1===e.bytesPerElement?255:65535,r=-n-1,i=t.length,o=e.isSigned?1===e.bytesPerElement?new Int8Array(e.size):new Int16Array(e.size):1===e.bytesPerElement?new Uint8Array(e.size):new Uint16Array(e.size),a=0,u=0;u<i;u++){var c=t[u];if(c>=0)for(;c>=n;)o[a]=n,++a,c-=n;else for(;c<=r;)o[a]=r,++a,c-=r;o[a]=c,++a}var h=s(o);return{encodings:[{kind:"IntegerPacking",byteCount:e.bytesPerElement,isUnsigned:!e.isSigned,srcSize:i},h.encodings[0]],data:h.data}}function g(t){if(!(t instanceof Int32Array))throw new Error("Integer packing can only be applied to Int32 data.");var e=m(t);return 4===e.bytesPerElement?s(t):y(t,e)}function v(e){var r=Object.create(null),i=[],o=0,s=t.Utils.ChunkedArray.create(function(t){return new Int32Array(t)},1024,1),a=new Int32Array(e.length);t.Utils.ChunkedArray.add(s,0);for(var u=0,c=0,h=e;c<h.length;c++){var l=h[c];if(null!==l&&void 0!==l){var p=r[l];void 0===p&&(o+=l.length,p=i.length,i[p]=l,r[l]=p,t.Utils.ChunkedArray.add(s,o)),a[u++]=p}else a[u++]=-1}var m=n.by(d).and(g).encode(t.Utils.ChunkedArray.compact(s)),y=n.by(d).and(f).and(g).encode(a);return{encodings:[{kind:"StringArray",dataEncoding:y.encoding,stringData:i.join(""),offsetEncoding:m.encoding,offsets:m.data}],data:y.data}}n.by=r;var b=(w={},w[2]=function(t,e,n){t.setInt16(2*e,n,!0)},w[5]=function(t,e,n){t.setUint16(2*e,n,!0)},w[3]=function(t,e,n){t.setInt32(4*e,n,!0)},w[6]=function(t,e,n){t.setUint32(4*e,n,!0)},w[32]=function(t,e,n){t.setFloat32(4*e,n,!0)},w[33]=function(t,e,n){t.setFloat64(8*e,n,!0)},w),_=(x={},x[2]=2,x[5]=2,x[3]=4,x[6]=4,x[32]=4,x[33]=8,x);n.byteArray=s,n.fixedPoint=u,n.intervalQuantizaiton=h,n.runLength=f,n.delta=d,n.integerPacking=g,n.stringArray=v;var w,x}(n=e.Encoder||(e.Encoder={}))}(t.Binary||(t.Binary={}))}(r||(r={}));var r;!function(t){!function(t){t.VERSION="0.3.0";!function(t){function e(t){var e;if(t instanceof Int8Array)e=1;else if(t instanceof Int16Array)e=2;else if(t instanceof Int32Array)e=3;else if(t instanceof Uint8Array)e=4;else if(t instanceof Uint16Array)e=5;else if(t instanceof Uint32Array)e=6;else if(t instanceof Float32Array)e=32;else{if(!(t instanceof Float64Array))throw new Error("Unsupported integer data type.");e=33}return e}function n(t){return t instanceof Int8Array||t instanceof Int16Array||t instanceof Int32Array}t.getDataType=e,t.isSignedIntegerDataType=n}(t.Encoding||(t.Encoding={}))}(t.Binary||(t.Binary={}))}(r||(r={}));var r;!function(t){!function(e){function n(t,e){for(var n=0;n<2;n++)if(t[n]>e[n])return!1;return!0}function r(r){var i=[0,3];try{var o=new Uint8Array(r),s=e.MessagePack.decode(o);if(!n(i,s.version.match(/(\d)\.(\d)\.\d/).slice(1)))return t.ParserResult.error("Unsupported format version. Current "+s.version+", required "+i.join(".")+".");var a=new e.File(s);return t.ParserResult.success(a)}catch(e){return t.ParserResult.error(""+e)}}e.parse=r}(t.Binary||(t.Binary={}))}(r||(r={}));var r;!function(t){!function(t){function e(e,n,r){var i,o=!1;e.typedArray?i=new e.typedArray(r):(o=!0,i=new Array(r));for(var s=new Uint8Array(r),a=e.presence,u=e.number?e.number:e.string,c=!0,h=0,f=0,d=n;f<d.length;f++)for(var l=d[f],p=l.data,m=0,y=l.count;m<y;m++){var g=void 0;a&&0!==(g=a(p,m))?(s[h]=g,o&&(i[h]=null),c=!1):(s[h]=0,i[h]=u(p,m)),h++}
var v=e.encoder?e.encoder:t.Encoder.by(t.Encoder.stringArray),b=v.encode(i),_=void 0;if(!c){var w=t.Encoder.by(t.Encoder.runLength).and(t.Encoder.byteArray).encode(s);_=w.data.length<s.length?w:t.Encoder.by(t.Encoder.byteArray).encode(s)}return{name:e.name,data:b,mask:_}}var n=function(){function n(e){this.dataBlocks=[],this.data={encoder:e,version:t.VERSION,dataBlocks:this.dataBlocks}}return n.prototype.startDataBlock=function(t){this.dataBlocks.push({header:(t||"").replace(/[ \n\t]/g,"").toUpperCase(),categories:[]})},n.prototype.writeCategory=function(t,n){if(!this.data)throw new Error("The writer contents have already been encoded, no more writing.");if(!this.dataBlocks.length)throw new Error("No data block created.");var r=n&&n.length?n.map(function(e){return t(e)}):[t(void 0)],i=r.filter(function(t){return t&&t.count>0});if(i.length){var o=i.reduce(function(t,e){return t+e.count},0);if(o){for(var s=i[0],a={name:s.desc.name,columns:[],rowCount:o},u=i.map(function(t){return{data:t.data,count:t.count}}),c=0,h=s.desc.fields;c<h.length;c++){var f=h[c];a.columns.push(e(f,u,o))}this.dataBlocks[this.dataBlocks.length-1].categories.push(a)}}},n.prototype.encode=function(){this.encodedData=t.MessagePack.encode(this.data),this.data=null,this.dataBlocks=null},n.prototype.flush=function(t){t.writeBinary(this.encodedData)},n}();t.Writer=n}(t.Binary||(t.Binary={}))}(r||(r={}));var o;!function(e){e.Promise=t}(o||(o={})),function(t){!function(e){e.Rx=i,e.Promise=t.Promise;!function(t){t.CIF=r}(e.Formats||(e.Formats={}))}(t.Core||(t.Core={}))}(o||(o={}));var o;!function(t){!function(t){t.VERSION={number:"3.1.1",date:"March 20 2017"}}(t.Core||(t.Core={}))}(o||(o={}));var o,s=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}u((r=r.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){function n(t){return function(e){return r([t,e])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,o&&(s=o[2&n[0]?"return":n[0]?"throw":"next"])&&!(s=s.call(o,n[1])).done)return s;switch(o=0,s&&(n=[0,s.value]),n[0]){case 0:case 1:s=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,o=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(s=a.trys,!(s=s.length>0&&s[s.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!s||n[1]>s[0]&&n[1]<s[3])){a.label=n[1];break}if(6===n[0]&&a.label<s[1]){a.label=s[1],s=n;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(n);break}s[2]&&a.ops.pop(),a.trys.pop();continue}n=e.call(t,a)}catch(t){n=[6,t],o=0}finally{i=s=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,o,s,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return{next:n(0),throw:n(1),return:n(2)}};!function(t){!function(t){function e(t){return new n(t)}t.computation=e;var n=function(){function e(t){this.computation=t}return e.prototype.run=function(t){return this.runWithContext(t).result},e.prototype.runWithContext=function(e){var n=this,i=e?e:new r;return{progress:i.progressStream,result:new t.Promise(function(t,e){return s(n,void 0,void 0,function(){var n,r;return a(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,3,4]),i.started(),[4,this.computation(i)];case 1:return n=o.sent(),t(n),[3,4];case 2:return r=o.sent(),e(r),[3,4];case 3:return i.finished(),[7];case 4:return[2]}})})})}},e}();t.Computation=n,function(n){function i(n){return e(function(){return t.Promise.resolve(n)})}function o(n){return e(function(){return t.Promise.reject(n)})}function s(){return new r}n.resolve=i,n.reject=o,n.createContext=s,n.Aborted="Aborted",n.UpdateProgressDelta=100}(n=t.Computation||(t.Computation={}));var r=function(){function e(){var e=this;this._abortRequested=!1,this._abortRequester=function(){e._abortRequested=!0},this.progressTick=new t.Rx.Subject,this._progress={message:"Working...",current:0,max:0,isIndeterminate:!0,requestAbort:void 0},this.progressStream=new t.Rx.BehaviorSubject(this._progress),this.startEndCounter=0,this.progressTick.throttle(1e3/15).subscribe(function(t){e.progressStream.onNext({message:t.message,isIndeterminate:t.isIndeterminate,current:t.current,max:t.max,requestAbort:t.requestAbort})})}return Object.defineProperty(e.prototype,"isAbortRequested",{get:function(){return this._abortRequested},enumerable:!0,configurable:!0}),e.prototype.checkAborted=function(){if(this._abortRequested)throw n.Aborted},e.prototype.requestAbort=function(){try{this._abortRequester&&this._abortRequester.call(null)}catch(t){}},Object.defineProperty(e.prototype,"progress",{get:function(){return this.progressTick},enumerable:!0,configurable:!0}),e.prototype.updateProgress=function(e,n,r,i){return void 0===r&&(r=NaN),void 0===i&&(i=NaN),this.checkAborted(),this._progress.message=e,"boolean"==typeof n?this._progress.requestAbort=n?this._abortRequester:void 0:(n&&(this._abortRequester=n),this._progress.requestAbort=n?this._abortRequester:void 0),isNaN(r)?this._progress.isIndeterminate=!0:(this._progress.isIndeterminate=!1,this._progress.current=r,this._progress.max=i),this.progressTick.onNext(this._progress),new t.Promise(function(t){return setTimeout(t,0)})},e.prototype.started=function(){this.startEndCounter++},e.prototype.finished=function(){if(this.startEndCounter--,this.startEndCounter<=0&&(this.progressTick.onCompleted(),this.progressStream.onCompleted()),this.startEndCounter<0)throw"Bug in code somewhere, Computation.resolve/reject called too many times."},e}()}(t.Core||(t.Core={}))}(o||(o={}));var o;!function(t){!function(t){!function(t){function e(){var t=Object.create(null);return t.__=void 0,delete t.__,t}!function(t){function n(t,e,n){for(var r=Object.prototype.hasOwnProperty,i=0,o=Object.keys(t);i<o.length;i++){var s=o[i];if(r.call(t,s)){var a=t[s];void 0!==a&&e(a,s,n)}}}function r(){var t=Object.create(s);return t.data=e(),t.size=0,t}function i(t){for(var e=r(),n=0,i=t;n<i.length;n++){var o=i[n];e.set(o[0],o[1])}return e}function o(t){for(var e=r(),n=Object.prototype.hasOwnProperty,i=0,o=Object.keys(t);i<o.length;i++){var s=o[i];if(n.call(t,s)){var a=t[s];e.set(s,a)}}return e}var s={set:function(t,e){void 0===this.data[t]&&void 0!==e&&this.size++,this.data[t]=e},get:function(t){return this.data[t]},delete:function(t){return void 0!==this.data[t]&&(delete this.data[t],this.size--,!0)},has:function(t){return void 0!==this.data[t]},clear:function(){this.data=e(),this.size=0},forEach:function(t,e){n(this.data,t,void 0!==e?e:void 0)}};t.create=r,t.ofArray=i,t.ofObject=o}(t.FastMap||(t.FastMap={}));!function(t){function n(t,e,n){for(var r=Object.prototype.hasOwnProperty,i=0,o=Object.keys(t);i<o.length;i++){var s=o[i];r.call(t,s)&&null===t[s]&&e(s,n)}}function r(){var t=Object.create(o);return t.data=e(),t.size=0,t}function i(t){for(var e=r(),n=0,i=t.length;n<i;n++)e.add(t[n]);return e}var o={add:function(t){return null!==this.data[t]&&(this.data[t]=null,this.size++,!0)},delete:function(t){return null===this.data[t]&&(delete this.data[t],this.size--,!0)},has:function(t){return null===this.data[t]},clear:function(){this.data=e(),this.size=0},forEach:function(t,e){n(this.data,t,void 0!==e?e:void 0)}};t.create=r,t.ofArray=i}(t.FastSet||(t.FastSet={}))}(t.Utils||(t.Utils={}))}(t.Core||(t.Core={}))}(o||(o={}));var o;!function(t){!function(t){!function(e){function n(t,e,n){for(var r,i=e,o=t,s=n,a=0,u=Object.keys(e);a<u.length;a++){var c=u[a];r=i[c],void 0!==r?o[c]=r:n&&(o[c]=s[c])}if(n)for(var h=0,f=Object.keys(n);h<f.length;h++){var c=f[h];r=o[c],void 0===r&&(o[c]=s[c])}return t}function r(t,e){var n,r,i,o,s,a,u,c=0;e=Math.max(0,e)||0;var h=function(){var f=e-(performance.now()-o);if(f<=0){r&&clearTimeout(r);var d=u;r=a=u=void 0,d&&(c=performance.now(),i=t.apply(s,n),a||r||(n=s=null))}else a=setTimeout(h,f)};return function(){n=arguments,o=performance.now(),s=this,u=a||!0;var c=!1,f=!1;return f=!1,c&&a?a=clearTimeout(a):a||0===e||(a=setTimeout(h,e)),f&&(c=!0,i=t.apply(s,n)),!c||a||r||(n=s=null),i}}e.FastNumberParsers=t.Formats.CIF.Utils.FastNumberParsers,e.extend=n,e.debounce=r}(t.Utils||(t.Utils={}))}(t.Core||(t.Core={}))}(o||(o={}));var o;!function(t){!function(t){!function(t){!function(e){function n(t){return function(e){return new t(e)}}function r(){return function(t){return new Array(t)}}function i(t){return new u(t)}function o(t,n){for(var r=e.builder(n),i=0,o=Object.keys(t);i<o.length;i++){var s=o[i];if(Object.prototype.hasOwnProperty.call(t,s)){var a=t[s];a&&r.addColumn(s,a)}}return r.seal()}function s(t,e){for(var n=Object.create(null),r=0,i=t.columns;r<i.length;r++){var o=i[r];!function(t,e,n,r){Object.defineProperty(e,t.name,{enumerable:!0,configurable:!1,get:function(){return r[n.index]}})}(o,n,e,t[o.name])}return n}e.typedColumn=n,e.customColumn=r,e.stringColumn=function(t){return new Array(t)},e.stringNullColumn=function(t){return new Array(t)},e.builder=i,e.ofDefinition=o;var a=function(){function e(e,n,r){this.__rowIndexer={index:0},this.count=e,this.indices=new Int32Array(e),this.columns=[];for(var i=0;i<e;i++)this.indices[i]=i;for(var o=0,a=n;o<a.length;o++){var u=a[o],c=r[u.name];t.ChunkedArray.is(c)&&(c=t.ChunkedArray.compact(c)),Object.defineProperty(this,u.name,{enumerable:!0,configurable:!1,writable:!1,value:c}),this.columns[this.columns.length]=u}this.__row=s(this,this.__rowIndexer)}return e.prototype.getBuilder=function(t){for(var e=new u(t),n=0,r=this.columns;n<r.length;n++){var i=r[n];e.addColumn(i.name,i.creator)}return e},e.prototype.getRawData=function(){var t=this;return this.columns.map(function(e){return t[e.name]})},e.prototype.getRow=function(t){return this.__rowIndexer.index=t,this.__row},e}(),u=function(){function t(t){this.columns=[],this.count=t}return t.prototype.addColumn=function(t,e){var n=e(this.count);return Object.defineProperty(this,t,{enumerable:!0,configurable:!1,writable:!1,value:n}),this.columns[this.columns.length]={name:t,creator:e},n},t.prototype.getRawData=function(){var t=this;return this.columns.map(function(e){return t[e.name]})},t.prototype.seal=function(){return new a(this.count,this.columns,this)},t}()}(t.DataTable||(t.DataTable={}))}(t.Utils||(t.Utils={}))}(t.Core||(t.Core={}))}(o||(o={}));var o;!function(t){!function(t){!function(t){function e(t){var e=new Int32Array(t.size);return t.forEach(function(t,e){e.array[e.index++]=t},{array:e,index:0}),Array.prototype.sort.call(e,function(t,e){return t-e}),e}function n(t){for(var e=[],n=0;n<t;n++)e[n]=0;return e}function r(t){var e=[];if(!t)return e;e[0]=.1;for(var n=0;n<t;n++)e[n]=0;return e}t.integerSetToSortedTypedArray=e,t.makeNativeIntArray=n,t.makeNativeFloatArray=r;!function(t){function e(t){return t.creator&&t.chunkSize}function n(t,e,n,r,i){return t.currentIndex>=t.chunkSize&&(t.currentIndex=0,t.current=t.creator(t.chunkSize),t.parts[t.parts.length]=t.current),t.current[t.currentIndex++]=e,t.current[t.currentIndex++]=n,t.current[t.currentIndex++]=r,t.current[t.currentIndex++]=i,t.elementCount++}function r(t,e,n,r){return t.currentIndex>=t.chunkSize&&(t.currentIndex=0,t.current=t.creator(t.chunkSize),t.parts[t.parts.length]=t.current),t.current[t.currentIndex++]=e,t.current[t.currentIndex++]=n,t.current[t.currentIndex++]=r,t.elementCount++}function i(t,e,n){return t.currentIndex>=t.chunkSize&&(t.currentIndex=0,t.current=t.creator(t.chunkSize),t.parts[t.parts.length]=t.current),t.current[t.currentIndex++]=e,t.current[t.currentIndex++]=n,t.elementCount++}function o(t,e){return t.currentIndex>=t.chunkSize&&(t.currentIndex=0,t.current=t.creator(t.chunkSize),t.parts[t.parts.length]=t.current),t.current[t.currentIndex++]=e,t.elementCount++}function s(t){var e,n=t.creator(t.elementSize*t.elementCount),r=(t.parts.length-1)*t.chunkSize,i=0;if(t.parts.length>1)if(t.parts[0].buffer)for(var o=0;o<t.parts.length-1;o++)n.set(t.parts[o],t.chunkSize*o);else for(var o=0;o<t.parts.length-1;o++){i=t.chunkSize*o,e=t.parts[o];for(var s=0;s<t.chunkSize;s++)n[i+s]=e[s]}if(t.current.buffer&&t.currentIndex>=t.chunkSize)n.set(t.current,t.chunkSize*(t.parts.length-1));else for(var o=0;o<t.currentIndex;o++)n[r+o]=t.current[o];return n}function a(t){return void 0===t&&(t=262144),p(function(t){return new Float32Array(t)},t,3)}function u(t){return void 0===t&&(t=262144),p(function(t){return new Uint32Array(t)},t,3)}function c(t){return void 0===t&&(t=131072),p(function(t){return new Int32Array(t)},t,2)}function h(t){return void 0===t&&(t=131072),p(function(t){return new Int32Array(t)},t,1)}function f(t){return void 0===t&&(t=131072),p(function(t){return new Int32Array(t)},t,1)}function d(t){return void 0===t&&(t=131072),p(function(t){return new Float32Array(t)},t,1)}function l(t){return void 0===t&&(t=131072),p(function(t){return[]},t,1)}function p(t,e,n){(e|=0)<=0&&(e=1);var r=e*n,i=t(r);return{elementSize:n,chunkSize:r,creator:t,current:i,parts:[i],currentIndex:0,elementCount:0}}t.is=e,t.add4=n,t.add3=r,t.add2=i,t.add=o,t.compact=s,t.forVertex3D=a,t.forIndexBuffer=u,t.forTokenIndices=c,t.forIndices=h,t.forInt32=f,t.forFloat32=d,t.forArray=l,t.create=p}(t.ChunkedArray||(t.ChunkedArray={}));!function(t){function e(t,e,n,r){var i=t.array;i[t.currentIndex++]=e,i[t.currentIndex++]=n,i[t.currentIndex++]=r,t.elementCount++}function n(t,e,n){var r=t.array;r[t.currentIndex++]=e,r[t.currentIndex++]=n,t.elementCount++}function r(t,e){t.array[t.currentIndex++]=e,t.elementCount++}function i(t){return f(function(t){return new Float32Array(t)},t,3)}function o(t){return f(function(t){return new Int32Array(t)},t,3)}function s(t){return f(function(t){return new Int32Array(t)},t,2)}function a(t){return f(function(t){return new Int32Array(t)},t,1)}function u(t){return f(function(t){return new Int32Array(t)},t,1)}function c(t){return f(function(t){return new Float32Array(t)},t,1)}function h(t){return f(function(t){return[]},t,1)}function f(t,e,n){return e|=0,{array:t(e*n),currentIndex:0,elementCount:0}}t.add3=e,t.add2=n,t.add=r,t.forVertex3D=i,t.forIndexBuffer=o,t.forTokenIndices=s,t.forIndices=a,t.forInt32=u,t.forFloat32=c,t.forArray=h,t.create=f}(t.ArrayBuilder||(t.ArrayBuilder={}))}(t.Utils||(t.Utils={}))}(t.Core||(t.Core={}))}(o||(o={}));var o;!function(t){!function(t){!function(t){var e;!function(t){t.perfGetTime=function(){return"undefined"!=typeof window&&window.performance?function(){return window.performance.now()}:"undefined"!=typeof process&&"undefined"!==process.hrtime?function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6}:function(){return+new Date}}()}(e||(e={}));var n=function(){function n(){this.starts=t.FastMap.create(),this.ends=t.FastMap.create()}return n.currentTime=function(){return e.perfGetTime()},n.prototype.start=function(t){this.starts.set(t,e.perfGetTime())},n.prototype.end=function(t){this.ends.set(t,e.perfGetTime())},n.format=function(t){if(isNaN(t))return"n/a";for(var e=Math.floor(t/36e5),n=Math.floor(t/6e4%60),r=Math.floor(t/1e3%60),i=Math.floor(t%1e3).toString();i.length<3;)i="0"+i;return e>0?e+"h"+n+"m"+r+"."+i+"s":n>0?n+"m"+r+"."+i+"s":r>0?r+"."+i+"s":t.toFixed(0)+"ms"},n.prototype.formatTime=function(t){return n.format(this.time(t))},n.prototype.formatTimeSum=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return n.format(this.timeSum.apply(this,t))},n.prototype.time=function(t){var e=this.starts.get(t),n=this.ends.get(t);return this.starts.delete(t),this.ends.delete(t),n-e},n.prototype.timeSum=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];for(var r=0,i=0,o=e.map(function(e){return t.ends.get(e)-t.starts.get(e)});i<o.length;i++){r+=o[i]}return r},n}();t.PerformanceMonitor=n}(t.Utils||(t.Utils={}))}(t.Core||(t.Core={}))}(o||(o={}));var o;!function(t){!function(t){!function(t){!function(t){function e(t){return t.name&&t.parse}function n(t,e){e=e.toLowerCase().trim();for(var n=0,r=t;n<r.length;n++)for(var i=r[n],o=0,s=i.shortcuts;o<s.length;o++){var a=s[o];if(a.toLowerCase()===e)return i}}function r(t){return new RegExp(t.extensions.map(function(t){return"(\\"+t+")"}).join("|")+"(\\.gz){0,1}$","i")}function i(t){return t.map(function(t){return t.extensions.map(function(t){return t+","+t+".gz"}).join(",")}).join(",")}function o(t,e){for(var n=0,i=e;n<i.length;n++){var o=i[n];if(r(o).test(t))return o}}t.is=e,t.fromShortcut=n,t.formatRegExp=r,t.formatFileFilters=i,t.getFormat=o}(t.FormatInfo||(t.FormatInfo={}));!function(t){function r(t,n){return void 0===n&&(n=-1),new e(t,n)}function i(t,e){return void 0===e&&(e=[]),new n(t,e)}t.error=r,t.success=i}(t.ParserResult||(t.ParserResult={}));var e=function(){function t(t,e){this.message=t,this.line=e,this.isError=!0}return t.prototype.toString=function(){return this.line>=0?"[Line "+this.line+"] "+this.message:this.message},t}();t.ParserError=e;var n=function(){function t(t,e){this.result=t,this.warnings=e,this.isError=!1}return t}();t.ParserSuccess=n;!function(t){function e(t){var e=new Int32Array(Math.round(1.61*t.tokens.length));e.set(t.tokens),t.tokens=e,t.tokensLenMinus2=e.length-2}function n(t,n,r){t.count>=t.tokensLenMinus2&&e(t),t.tokens[t.count++]=n,t.tokens[t.count++]=r}function r(t){return{tokensLenMinus2:Math.round(t)-2,count:0,tokens:new Int32Array(t)}}t.addToken=n,t.create=r}(t.TokenIndexBuilder||(t.TokenIndexBuilder={}));!function(t){function e(){return Object.create(null)}function n(t,e){if(e.length>6)return e;var n=t[e];return void 0!==n?n:(t[e]=e,e)}t.create=e,t.get=n}(t.ShortStringPool||(t.ShortStringPool={}))}(t.Formats||(t.Formats={}))}(t.Core||(t.Core={}))}(o||(o={}));var o;!function(t){!function(t){!function(e){!function(e){!function(e){function n(e,n,r,i){var o,s,a=t.Geometry.LinearAlgebra.Matrix4.identity();for(o=1;o<=3;o++){for(s=1;s<=3;s++)n+"["+o+"]["+s+"]",t.Geometry.LinearAlgebra.Matrix4.setValue(a,o-1,s-1,e.getColumn(n+"["+o+"]["+s+"]").getFloat(i));t.Geometry.LinearAlgebra.Matrix4.setValue(a,o-1,3,e.getColumn(r+"["+o+"]").getFloat(i))}return a}function r(t,e,n){var r=0;if(!n||!n.isDefined)return e;for(r=t+1;r<e&&n.areValuesEqual(r-1,r);r++);return r}function i(e){for(var n=t.Utils.FastMap.create(),r=0,i=I;r<i.length;r++){var o=i[r];n.set(o,e.getColumn(o))}return n}function o(e,n,i){for(var o=r(e,n,i.get("pdbx_PDB_model_num")),s=t.Utils.DataTable.ofDefinition(t.Structure.Tables.Atoms,o-e),a=t.Utils.DataTable.ofDefinition(t.Structure.Tables.Positions,o-e),u=a.x,c=i.get("Cartn_x"),h=a.y,f=i.get("Cartn_y"),d=a.z,l=i.get("Cartn_z"),p=s.id,m=i.get("id"),y=s.altLoc,g=i.get("label_alt_id"),v=s.rowIndex,b=s.residueIndex,_=s.chainIndex,w=s.entityIndex,x=s.name,I=i.get("label_atom_id"),S=s.elementSymbol,A=i.get("type_symbol"),k=s.occupancy,E=i.get("occupancy"),P=s.tempFactor,T=i.get("B_iso_or_equiv"),F=s.authName,D=i.get("auth_atom_id"),M=i.get("label_asym_id"),N=i.get("label_entity_id"),R=i.get("pdbx_PDB_ins_code"),O=i.get("auth_seq_id"),q=i.get("pdbx_PDB_model_num"),U=0,B=0,z=0,L=e,j=e;j<o;j++){var V=j-e;p[V]=m.getInteger(j),u[V]=c.getFloat(j),h[V]=f.getFloat(j),d[V]=l.getFloat(j),S[V]=A.getString(j)||C.ElementSymbol,x[V]=I.getString(j)||S[V],F[V]=D.getString(j)||x[V],y[V]=g.getString(j),k[V]=E.getFloat(j),P[V]=T.getFloat(j);var X=!1,Y=!O.areValuesEqual(L,j)||!R.areValuesEqual(L,j);M.areValuesEqual(L,j)||(X=!0,Y=!0),N.areValuesEqual(L,j)||(z++,X=!0,Y=!0),Y&&B++,X&&U++,v[V]=j,b[V]=B,_[V]=U,w[V]=z,L=j}return{atoms:s,positions:a,modelId:q.isDefined?q.getString(e)||C.ModelId:C.ModelId,endRow:o}}function s(e,n){var r=n.count,i=n.residueIndex,o=n.chainIndex,s=n.entityIndex,a=t.Utils.DataTable.ofDefinition(t.Structure.Tables.Residues,n.residueIndex[n.count-1]+1),u=t.Utils.DataTable.ofDefinition(t.Structure.Tables.Chains,n.chainIndex[n.count-1]+1),c=t.Utils.DataTable.ofDefinition(t.Structure.Tables.Entities,n.entityIndex[n.count-1]+1),h=a.name,f=a.seqNumber,d=a.asymId,l=a.authName,p=a.authSeqNumber,m=a.authAsymId,y=a.insCode,g=a.entityId,v=a.isHet,b=a.atomStartIndex,_=a.atomEndIndex,w=a.chainIndex,x=a.entityIndex,I=u.asymId,S=u.entityId,A=u.authAsymId,k=u.atomStartIndex,E=u.atomEndIndex,P=u.residueStartIndex,T=u.residueEndIndex,F=u.entityIndex,D=c.entityId,M=c.type,N=c.atomStartIndex,R=c.atomEndIndex,O=c.residueStartIndex,q=c.residueEndIndex,U=c.chainStartIndex,B=c.chainEndIndex,z=e.get("label_comp_id"),L=e.get("label_seq_id"),j=e.get("label_asym_id"),V=e.get("auth_comp_id"),X=e.get("auth_seq_id"),Y=e.get("auth_asym_id"),Z=e.get("group_PDB"),H=e.get("label_entity_id"),G=e.get("pdbx_PDB_ins_code"),W=0,Q=0,J=0,K=0,$=0,tt=0,et=0,nt=0,rt=0,it=0;for(it=0;it<r;it++)i[it]!==i[W]&&(h[et]=z.getString(W)||C.ResidueName,f[et]=L.getInteger(W),d[et]=j.getString(W)||C.AsymId,l[et]=V.getString(W)||h[et],p[et]=X.getInteger(W),m[et]=Y.getString(W)||d[et],y[et]=G.getString(W),g[et]=H.getString(W)||C.EntityId,v[et]=Z.stringEquals(W,"HETATM")?1:0,b[et]=W,_[et]=it,w[et]=nt,x[et]=rt,et++,W=it),o[it]!==o[Q]&&(I[nt]=j.getString(Q)||C.AsymId,A[nt]=Y.getString(Q)||I[nt],S[nt]=H.getString(Q)||C.EntityId,P[nt]=tt,T[nt]=et,k[nt]=Q,E[nt]=it,F[nt]=rt,nt++,Q=it,tt=et),s[it]!==s[J]&&(D[rt]=H.getString(J)||C.EntityId,M[rt]="unknown",N[rt]=J,R[rt]=it,O[rt]=$,q[rt]=et,U[rt]=K,B[rt]=nt,rt++,J=it,K=nt,$=et);return D[rt]=H.getString(J)||C.EntityId,M[rt]="unknown",N[rt]=J,R[rt]=it,O[rt]=$,q[rt]=et+1,U[rt]=K,B[rt]=nt+1,I[nt]=j.getString(Q)||C.AsymId,A[nt]=Y.getString(Q)||I[nt],S[nt]=H.getString(Q)||C.EntityId,P[nt]=tt,T[nt]=et+1,k[nt]=Q,E[nt]=it,F[nt]=rt,h[et]=z.getString(W)||C.ResidueName,f[et]=L.getInteger(W),d[et]=j.getString(W)||C.AsymId,l[et]=V.getString(W)||h[et],p[et]=X.getInteger(W),m[et]=Y.getString(W)||d[et],y[et]=G.getString(W),b[et]=W,_[et]=it,w[et]=nt,x[et]=rt,v[et]=Z.stringEquals(W,"HETATM")?1:0,{residues:a,chains:u,entities:c}}function a(t,e){var n;if(t){var r={},i=t.getColumn("type"),o=t.getColumn("id");for(n=0;n<t.rowCount;n++){var s=(i.getString(n)||"").toLowerCase(),a=o.getString(n)||C.EntityId;switch(s){case"polymer":case"non-polymer":case"water":r[a]=s;break;default:r[a]="unknown"}}for(n=0;n<e.count;n++){var u=r[e.entityId[n]];void 0!==u&&(e.type[n]=u)}}}function u(e,n,r,i){return new t.Structure.PolyResidueIdentifier(n.getString(e)||C.AsymId,r.getInteger(e),i.getString(e))}function c(t,e,n,r){if("polymer"!==n.type[e.entityIndex[r]])return!1;for(var i=!1,o=!1,s=t.name,a=0,u=e.atomStartIndex[r],c=e.atomEndIndex[r];u<c;u++){var h=s[u];if(i||"CA"!==h?o||"O"!==h||(o=!0,a++):(i=!0,a++),2===a)break}return i&&o||i&&!e.isHet[r]}function h(t,e,n,r){if(S[e.name[r]]||"polymer"!==n.type[e.entityIndex[r]])return!1;var i=t.name,o=0,s=e.atomStartIndex[r],a=e.atomEndIndex[r];if(a-s==1&&!e.isHet[s]&&"P"===i[s])return!0;for(var u=s;u<a;u++){var c=i[u];if("O5'"!==c&&"C3'"!==c&&"N3"!==c&&"P"!==c||o++,o>=3)return!0}return!1}function f(e,n,r,i,o,s){for(var a=n.asymId,u=n.entityIndex,f=0,d=i,l=i,p=o;d<p;){if(h(e,n,r,d)){for(l=d+1;l<p&&a[d]===a[l]&&u[d]===u[l]&&h(e,n,r,l);)l++;f=5}else if(c(e,n,r,d)){for(l=d+1;l<p&&a[d]===a[l]&&u[d]===u[l]&&c(e,n,r,l);)l++;f=4}else{for(l=d+1;l<p&&a[d]===a[l]&&u[d]===u[l]&&!h(e,n,r,l)&&!c(e,n,r,l);)l++;f=0}var m=new t.Structure.SecondaryStructureElement(f,new t.Structure.PolyResidueIdentifier(n.asymId[d],n.seqNumber[d],n.insCode[d]),new t.Structure.PolyResidueIdentifier(n.asymId[l-1],n.seqNumber[l-1],n.insCode[l-1]));m.startResidueIndex=d,m.endResidueIndex=l,s[s.length]=m,d=l}}function d(e,n){for(var r=[],i=e.authSeqNumber,o=0,s=n;o<s.length;o++){for(var a=s[o],u=a.startResidueIndex,c=a.endResidueIndex-1,h=a.startResidueIndex;h<c;h++)if(i[h+1]-i[h]!=1){var f=new t.Structure.SecondaryStructureElement(a.type,a.startResidueId,a.endResidueId,a.info);f.startResidueIndex=u,f.endResidueIndex=h+1,r[r.length]=f,u=h+1}if(u===a.startResidueIndex)r[r.length]=a;else{var f=new t.Structure.SecondaryStructureElement(a.type,a.startResidueId,a.endResidueId,a.info);f.startResidueIndex=u,f.endResidueIndex=a.endResidueIndex,r[r.length]=f}}return r}function l(e,n){for(var r=n.residues,i=r.count,o=r.asymId,s=r.seqNumber,a=r.insCode,u=void 0,c="",h=t.Utils.FastMap.create(),f=t.Utils.FastMap.create(),d=0,l=e;d<l.length;d++){var m=l[d];c=m.startResidueId.asymId+" "+m.startResidueId.seqNumber,m.startResidueId.insCode&&(c+=" "+m.startResidueId.insCode),h.set(c,m),c=m.endResidueId.asymId+" "+m.endResidueId.seqNumber,m.endResidueId.insCode&&(c+=" "+m.endResidueId.insCode),f.set(c,m)}for(var y=0;y<i;y++)c=o[y]+" "+s[y],a[y]&&(c+=" "+a[y]),u=h.get(c),u&&(u.startResidueIndex=y,u.endResidueIndex=y+1),(u=f.get(c))&&(u.startResidueIndex<0&&(u.startResidueIndex=y),u.endResidueIndex=y+1);u&&(u.endResidueIndex=i);for(var g=[],v=0,b=e;v<b.length;v++){var m=b[v];m.startResidueIndex<0||m.endResidueIndex<0||3===m.type&&m.length<3||m.endResidueIndex>=0&&m.startResidueIndex>=0&&(g[g.length]=m)}g.sort(function(t,e){return t.startResidueIndex-e.startResidueIndex});for(var y=0;y<g.length-1;y++)g[y+1].startResidueIndex-g[y].endResidueIndex==-1&&g[y+1].startResidueIndex++;if(!g.length)return g;for(var _=[g[0]],y=1;y<g.length;y++){var w=_[_.length-1],x=g[y];x.startResidueIndex<w.endResidueIndex?p(w,x):_[_.length]=x}return _}function p(t,e){e.endResidueIndex>t.endResidueIndex&&(t.endResidueIndex=e.endResidueIndex)}function m(e,n,r){var i,o=[],s=[],a=e.getCategory("_struct_conf"),c=e.getCategory("_struct_sheet_range");if(a){var h=a.getColumn("conf_type_id");if(h){var p=a.getColumn("beg_label_asym_id"),m=a.getColumn("beg_label_seq_id"),y=a.getColumn("pdbx_beg_PDB_ins_code"),g=a.getColumn("end_label_asym_id"),v=a.getColumn("end_label_seq_id"),b=a.getColumn("pdbx_end_PDB_ins_code"),_=a.getColumn("pdbx_PDB_helix_class");for(i=0;i<a.rowCount;i++){var w=void 0;switch((h.getString(i)||"").toUpperCase()){case"HELX_P":w=1;break;case"TURN_P":w=2}w&&(o[o.length]=new t.Structure.SecondaryStructureElement(w,u(i,p,m,y),u(i,g,v,b),{helixClass:_.getString(i)}))}}}if(c){var p=c.getColumn("beg_label_asym_id"),m=c.getColumn("beg_label_seq_id"),y=c.getColumn("pdbx_beg_PDB_ins_code"),g=c.getColumn("end_label_asym_id"),v=c.getColumn("end_label_seq_id"),b=c.getColumn("pdbx_end_PDB_ins_code"),x=c.getColumn("symmetry"),C=c.getColumn("sheet_id");for(i=0;i<c.rowCount;i++)o[o.length]=new t.Structure.SecondaryStructureElement(3,u(i,p,m,y),u(i,g,v,b),{symmetry:x.getString(i),sheetId:C.getString(i),id:C.getString(i)})}var I=o.length>0?l(o,r):[],S=r.residues,A=S.count;if(0===I.length)return f(n,S,r.entities,0,A,s),d(S,s);var k=I.length-1;for(I[0].startResidueIndex>0&&f(n,S,r.entities,0,I[0].startResidueIndex,s),i=0;i<k;i++)s[s.length]=I[i],I[i+1].startResidueIndex-I[i].endResidueIndex>0&&f(n,S,r.entities,I[i].endResidueIndex,I[i+1].startResidueIndex,s);return s[s.length]=I[k],I[k].endResidueIndex<A&&f(n,S,r.entities,I[k].endResidueIndex,A,s),d(S,s)}function y(t,e){for(var n=t.secondaryStructureIndex,r=0,i=0,o=e;i<o.length;i++){for(var s=o[i],a=s.startResidueIndex;a<s.endResidueIndex;a++)n[a]=r;r++}return n}function g(t){for(var e,n=/\(?([^\(\)]+)\)?]*/g,r=[],i=[];e=n.exec(t);)r[r.length]=e[1];return r.forEach(function(t){var e=[];t.split(",").forEach(function(t){var n=t.indexOf("-");if(n>0)for(var r=parseInt(t.substring(0,n)),i=parseInt(t.substr(n+1)),o=r;o<=i;o++)e[e.length]=o.toString();else e[e.length]=t.trim()}),i[i.length]=e}),i}function v(e){var r=e.getCategory("_pdbx_struct_assembly"),i=e.getCategory("_pdbx_struct_assembly_gen"),o=e.getCategory("_pdbx_struct_oper_list");if(r&&i&&o){var s,a={},u=[],c=t.Utils.FastMap.create(),h=i.getColumn("assembly_id"),f=i.getColumn("oper_expression"),d=i.getColumn("asym_id_list");for(s=0;s<i.rowCount;s++){var l=h.getString(s);if(!l)return;var p=c.get(l);p||(p=new t.Structure.AssemblyGen(l),c.set(l,p),u.push(p)),p.gens.push(new t.Structure.AssemblyGenEntry(g(f.getString(s)),d.getString(s).split(",")))}var m=o.getColumn("id"),y=o.getColumn("name");for(s=0;s<o.rowCount;s++){var v=n(o,"matrix","vector",s);if(!v)return;var b=new t.Structure.AssemblyOperator(m.getString(s),y.getString(s),v);a[b.id]=b}return new t.Structure.AssemblyInfo(a,u)}}function b(e){var r=e.getCategory("_cell"),i=e.getCategory("_symmetry"),o=e.getCategory("_atom_sites"),s="",a=[1,1,1],u=[90,90,90],c=t.Geometry.LinearAlgebra.Matrix4.identity(),h=!1;if(r&&i&&(s=i.getColumn("space_group_name_H-M").getString(0),a=[r.getColumn("length_a").getFloat(0),r.getColumn("length_b").getFloat(0),r.getColumn("length_c").getFloat(0)],u=[r.getColumn("angle_alpha").getFloat(0),r.getColumn("angle_beta").getFloat(0),r.getColumn("angle_gamma").getFloat(0)],s&&!a.every(function(t){return isNaN(t)||0===t})&&!a.every(function(t){return isNaN(t)||0===t}))){var f=function(t){return t*t},d=function(t){return t*Math.PI/180},l=a[0],p=a[1],m=a[2],y=d(u[0]),g=d(u[1]),v=d(u[2]),b=l*p*m*Math.sqrt(1-f(Math.cos(y))-f(Math.cos(g))-f(Math.cos(v))+2*Math.cos(y)*Math.cos(g)*Math.cos(v)),_=t.Geometry.LinearAlgebra.Matrix4.ofRows([[l,p*Math.cos(v),m*Math.cos(g),0],[0,p*Math.sin(v),m*(Math.cos(y)-Math.cos(g)*Math.cos(v))/Math.sin(v),0],[0,0,b/(l*p*Math.sin(v)),0],[0,0,0,1]]),w=t.Geometry.LinearAlgebra.Matrix4.identity();if(t.Geometry.LinearAlgebra.Matrix4.invert(w,_),o){var x=n(o,"fract_transf_matrix","fract_transf_vector",0);x&&(c=x,t.Geometry.LinearAlgebra.Matrix4.areEqual(w,x,1e-4)||(h=!0))}else c=w;return new t.Structure.SymmetryInfo(s,a,u,c,h)}}function _(e){if(e&&e.rowCount){for(var n=new t.Structure.ComponentBondInfo,r=e.getColumn("comp_id"),i=e.getColumn("atom_id_1"),o=e.getColumn("atom_id_2"),s=e.getColumn("value_order"),a=e.rowCount,u=n.newEntry(r.getString(0)),c=0;c<a;c++){var h=r.getString(c),f=i.getString(c),d=o.getString(c),l=s.getString(c);u.id!==h&&(u=n.newEntry(h));var p=void 0;switch(l.toLowerCase()){case"sing":p=1;break;case"doub":case"delo":p=2;break;case"trip":p=3;break;case"quad":p=4;break;default:p=0}u.add(f,d,p)}return n}}function w(e,n,r){var i,u=o(e,n.getCategory("_atom_site").rowCount,r),c=u.atoms,h=u.positions,f=u.modelId,d=u.endRow,l=s(r,c),p=n.getCategory("_entry");i=p&&p.getColumn("id").isDefined?p.getColumn("id").getString(0):n.header,a(n.getCategory("_entity"),l.entities);var g=m(n,c,l);return y(l.residues,g),{model:t.Structure.Molecule.Model.create({id:i,modelId:f,data:{atoms:c,residues:l.residues,chains:l.chains,entities:l.entities,bonds:{component:_(n.getCategory("_chem_comp_bond"))},secondaryStructure:g,symmetryInfo:b(n),assemblyInfo:v(n)},positions:h,source:t.Structure.Molecule.Model.Source.File}),endRow:d}}function x(e){var n=[],r=e.getCategory("_atom_site"),o=0;if(!r)throw"'_atom_site' category is missing in the input.";var s,a=e.getCategory("_entry"),u=i(r);for(s=a&&a.getColumn("id").isDefined?a.getColumn("id").getString(0):e.header;o<r.rowCount;){var c=w(o,e,u),h=c.model,f=c.endRow;n.push(h),o=f}var d=void 0,l=e.getCategory("_exptl");return l&&(d=l.getColumn("method").getString(0)||void 0),t.Structure.Molecule.create(s,n,{experimentMethod:d})}var C;!function(t){t.ElementSymbol="X",t.ResidueName="UNK",t.AsymId="",t.EntityId="1",t.ModelId="1"}(C||(C={}));var I=["id","Cartn_x","Cartn_y","Cartn_z","label_atom_id","type_symbol","occupancy","B_iso_or_equiv","auth_atom_id","label_alt_id","label_comp_id","label_seq_id","label_asym_id","auth_comp_id","auth_seq_id","auth_asym_id","group_PDB","label_entity_id","pdbx_PDB_ins_code","pdbx_PDB_model_num"],S={ALA:!0,ARG:!0,ASP:!0,CYS:!0,GLN:!0,GLU:!0,GLY:!0,HIS:!0,ILE:!0,LEU:!0,LYS:!0,MET:!0,PHE:!0,PRO:!0,SER:!0,THR:!0,TRP:!0,TYR:!0,VAL:!0,ASN:!0,PYL:!0,SEC:!0};e.ofDataBlock=x}(e.mmCIF||(e.mmCIF={}))}(e.Molecule||(e.Molecule={}))}(t.Formats||(t.Formats={}))}(t.Core||(t.Core={}))}(o||(o={}));var o;!function(t){!function(t){!function(e){!function(n){!function(n){var r=function(){function t(t,e,n,r){this.header=t,this.crystInfo=e,this.models=n,this.data=r}return t.prototype.makeEntities=function(){
var t=["data_ent","loop_","_entity.id","_entity.type","_entity.src_method","_entity.pdbx_description","_entity.formula_weight","_entity.pdbx_number_of_molecules","_entity.details","_entity.pdbx_mutation","_entity.pdbx_fragment","_entity.pdbx_ec","1 polymer man polymer 0.0 0 ? ? ? ?","2 non-polymer syn non-polymer 0.0 0 ? ? ? ?","3 water nat water 0.0 0 ? ? ? ?"].join("\n"),n=e.CIF.Text.parse(t);if(n.isError)throw n.toString();return n.result.dataBlocks[0].getCategory("_entity")},t.prototype.toCifFile=function(){var t={dot:n.Parser.getDotRange(this.data.length),question:n.Parser.getQuestionmarkRange(this.data.length),numberTokens:n.Parser.getNumberRanges(this.data.length),data:this.data},r=new e.CIF.Text.File(this.data),i=new e.CIF.Text.DataBlock(this.data,this.header.id);if(r.dataBlocks.push(i),i.addCategory(this.makeEntities()),this.crystInfo){var o=this.crystInfo.toCifCategory(this.header.id),s=o.cell,a=o.symm;i.addCategory(s),i.addCategory(a)}return i.addCategory(this.models.toCifCategory(i,t)),r},t}();n.MoleculeData=r;var i=function(){function t(t){this.id=t}return t}();n.Header=i;var o=function(){function t(t){this.record=t}return t.prototype.getValue=function(t,e){var n=this.record.substr(6,9).trim();return n.length?n:"."},t.prototype.toCifCategory=function(t){var n=["_cell.entry_id           '"+t+"'","_cell.length_a           "+this.getValue(6,9),"_cell.length_b           "+this.getValue(15,9),"_cell.length_c           "+this.getValue(24,9),"_cell.angle_alpha        "+this.getValue(33,7),"_cell.angle_beta         "+this.getValue(40,7),"_cell.angle_gamma        "+this.getValue(48,7),"_cell.Z_PDB              "+this.getValue(66,4),"_cell.pdbx_unique_axis   ?","_symmetry.entry_id                         '"+t+"'","_symmetry.space_group_name_H-M             '"+this.getValue(55,11)+"'","_symmetry.pdbx_full_space_group_name_H-M   ?","_symmetry.cell_setting                     ?","_symmetry.Int_Tables_number                ?","_symmetry.space_group_name_Hall            ?"].join("\n"),r=e.CIF.Text.parse(n);if(r.isError)throw new Error(r.toString());return{cell:r.result.dataBlocks[0].getCategory("_cell"),symm:r.result.dataBlocks[0].getCategory("_symmetry")}},t}();n.CrystStructureInfo=o;var s=function(){function t(t,e){this.helixTokens=t,this.sheetTokens=e}return t.prototype.toCifCategory=function(t){},t}();n.SecondaryStructure=s;var a=function(){function e(t,e,n){this.idToken=t,this.atomTokens=e,this.atomCount=n}return e.prototype.writeToken=function(e,n){t.Utils.ArrayBuilder.add2(n,this.atomTokens[2*e],this.atomTokens[2*e+1])},e.prototype.writeTokenCond=function(e,n,r){var i=this.atomTokens[2*e],o=this.atomTokens[2*e+1];i===o?t.Utils.ArrayBuilder.add2(n,r.start,r.end):t.Utils.ArrayBuilder.add2(n,i,o)},e.prototype.writeRange=function(e,n){t.Utils.ArrayBuilder.add2(n,e.start,e.end)},e.prototype.tokenEquals=function(t,e,n,r){if(n.length!==e-t)return!1;for(var i=n.length-1;i>=0;i--)if(r.charCodeAt(i+t)!==n.charCodeAt(i))return!1;return!0},e.prototype.getEntityType=function(t,e){var n=14*t;if(this.tokenEquals(this.atomTokens[2*n],this.atomTokens[2*n+1],"HETATM",e)){var r=this.atomTokens[2*(n+4)],i=this.atomTokens[2*(n+4)+1];return this.tokenEquals(r,i,"HOH",e)||this.tokenEquals(r,i,"WTR",e)||this.tokenEquals(r,i,"SOL",e)?3:2}return 1},e.prototype.writeCifTokens=function(t,e,n){for(var r={RECORD:0,SERIAL:1,ATOM_NAME:2,ALT_LOC:3,RES_NAME:4,CHAIN_ID:5,RES_SEQN:6,INS_CODE:7,X:8,Y:9,Z:10,OCCUPANCY:11,TEMP_FACTOR:12,ELEMENT:13},i=0;i<this.atomCount;i++){var o=14*i;this.writeToken(o+r.RECORD,e),this.writeToken(o+r.SERIAL,e),this.writeToken(o+r.ELEMENT,e),this.writeToken(o+r.ATOM_NAME,e),this.writeTokenCond(o+r.ALT_LOC,e,n.dot),this.writeToken(o+r.RES_NAME,e),this.writeToken(o+r.CHAIN_ID,e),this.writeRange(n.numberTokens.get(this.getEntityType(i,n.data)),e),this.writeToken(o+r.RES_SEQN,e),this.writeTokenCond(o+r.INS_CODE,e,n.dot),this.writeToken(o+r.X,e),this.writeToken(o+r.Y,e),this.writeToken(o+r.Z,e),this.writeToken(o+r.OCCUPANCY,e),this.writeToken(o+r.TEMP_FACTOR,e),this.writeRange(n.question,e),this.writeRange(n.question,e),this.writeRange(n.question,e),this.writeRange(n.question,e),this.writeRange(n.question,e),this.writeRange(n.question,e),this.writeToken(o+r.RES_SEQN,e),this.writeToken(o+r.RES_NAME,e),this.writeToken(o+r.CHAIN_ID,e),this.writeToken(o+r.ATOM_NAME,e),this.writeRange(t,e)}},e}();a.COLUMNS=["_atom_site.group_PDB","_atom_site.id","_atom_site.type_symbol","_atom_site.label_atom_id","_atom_site.label_alt_id","_atom_site.label_comp_id","_atom_site.label_asym_id","_atom_site.label_entity_id","_atom_site.label_seq_id","_atom_site.pdbx_PDB_ins_code","_atom_site.Cartn_x","_atom_site.Cartn_y","_atom_site.Cartn_z","_atom_site.occupancy","_atom_site.B_iso_or_equiv","_atom_site.Cartn_x_esd","_atom_site.Cartn_y_esd","_atom_site.Cartn_z_esd","_atom_site.occupancy_esd","_atom_site.B_iso_or_equiv_esd","_atom_site.pdbx_formal_charge","_atom_site.auth_seq_id","_atom_site.auth_comp_id","_atom_site.auth_asym_id","_atom_site.auth_atom_id","_atom_site.pdbx_PDB_model_num"],n.ModelData=a;var u=function(){function n(t){this.models=t}return n.prototype.toCifCategory=function(n,r){for(var i=0,o=0,s=this.models;o<s.length;o++){var u=s[o];i+=u.atomCount}for(var c=t.Utils.ArrayBuilder.forTokenIndices(26*i),h=0,f=this.models;h<f.length;h++){var u=f[h];u.writeCifTokens(u.idToken,c,r)}return new e.CIF.Text.Category(n.data,"_atom_site",0,0,a.COLUMNS,c.array,26*i)},n}();n.ModelsData=u}(n.PDB||(n.PDB={}))}(e.Molecule||(e.Molecule={}))}(t.Formats||(t.Formats={}))}(t.Core||(t.Core={}))}(o||(o={}));var o;!function(t){!function(t){!function(e){!function(n){!function(n){function r(t,e){return o.parse(t,e)}var i=function(){function t(t){this.data=t,this.trimmedToken={start:0,end:0},this.line=0,this.position=0,this.length=t.length}return t.prototype.moveToNextLine=function(){for(;this.position<this.length&&10!==this.data.charCodeAt(this.position);)this.position++;return this.position++,this.line++,this.position},t.prototype.moveToEndOfLine=function(){for(;this.position<this.length;){var t=this.data.charCodeAt(this.position);if(10===t||13===t)return this.position;this.position++}return this.position},t.prototype.startsWith=function(t,e){for(var n=e.length-1;n>=0;n--)if(this.data.charCodeAt(n+t)!==e.charCodeAt(n))return!1;return!0},t.prototype.trim=function(t,e){for(;t<e&&32===this.data.charCodeAt(t);)t++;for(;e>t&&32===this.data.charCodeAt(e-1);)e--;this.trimmedToken.start=t,this.trimmedToken.end=e},t.prototype.tokenizeAtomRecord=function(t){var n=this.position,r=this.position,i=this.moveToEndOfLine(),o=i-r;return!(o<66)&&(this.trim(r,r+6),e.TokenIndexBuilder.addToken(t,this.trimmedToken.start,this.trimmedToken.end),r=n+6,this.trim(r,r+5),e.TokenIndexBuilder.addToken(t,this.trimmedToken.start,this.trimmedToken.end),r=n+12,this.trim(r,r+4),e.TokenIndexBuilder.addToken(t,this.trimmedToken.start,this.trimmedToken.end),32===this.data.charCodeAt(n+16)?e.TokenIndexBuilder.addToken(t,0,0):e.TokenIndexBuilder.addToken(t,n+16,n+17),r=n+17,this.trim(r,r+3),e.TokenIndexBuilder.addToken(t,this.trimmedToken.start,this.trimmedToken.end),e.TokenIndexBuilder.addToken(t,n+21,n+22),r=n+22,this.trim(r,r+4),e.TokenIndexBuilder.addToken(t,this.trimmedToken.start,this.trimmedToken.end),32===this.data.charCodeAt(n+26)?e.TokenIndexBuilder.addToken(t,0,0):e.TokenIndexBuilder.addToken(t,n+26,n+27),r=n+30,this.trim(r,r+8),e.TokenIndexBuilder.addToken(t,this.trimmedToken.start,this.trimmedToken.end),r=n+38,this.trim(r,r+8),e.TokenIndexBuilder.addToken(t,this.trimmedToken.start,this.trimmedToken.end),r=n+46,this.trim(r,r+8),e.TokenIndexBuilder.addToken(t,this.trimmedToken.start,this.trimmedToken.end),r=n+54,this.trim(r,r+6),e.TokenIndexBuilder.addToken(t,this.trimmedToken.start,this.trimmedToken.end),r=n+60,this.trim(r,r+6),e.TokenIndexBuilder.addToken(t,this.trimmedToken.start,this.trimmedToken.end),o>=78?(r=n+76,this.trim(r,r+2),this.trimmedToken.start<this.trimmedToken.end?e.TokenIndexBuilder.addToken(t,this.trimmedToken.start,this.trimmedToken.end):e.TokenIndexBuilder.addToken(t,n+12,n+13)):e.TokenIndexBuilder.addToken(t,n+12,n+13),!0)},t}(),o=function(){function r(){}return r.tokenizeAtom=function(t,n){if(!n.tokenizeAtomRecord(t))return new e.ParserError("Invalid ATOM/HETATM record.",n.line)},r.tokenize=function(t,o){for(var s=new i(o),a=o.length,u=e.TokenIndexBuilder.create(4096),c=0,h=[],f=void 0,d={start:0,end:0};s.position<a;){var l=!0;switch(o.charCodeAt(s.position)){case 65:if(s.startsWith(s.position,"ATOM")){u||(u=e.TokenIndexBuilder.create(4096));var p=r.tokenizeAtom(u,s);if(c++,p)return p}break;case 67:if(s.startsWith(s.position,"CRYST1")){var m=s.position,y=s.moveToEndOfLine();f=new n.CrystStructureInfo(o.substring(m,y))}break;case 69:if(s.startsWith(s.position,"ENDMDL")&&c>0)0===h.length&&(d={start:o.length+3,end:o.length+4}),u&&h.push(new n.ModelData(d,u.tokens,c)),c=0,u=null;else if(s.startsWith(s.position,"END")){var m=s.position,y=s.moveToEndOfLine();s.trim(m,y),s.trimmedToken.end-s.trimmedToken.start==3&&(l=!1)}break;case 72:if(s.startsWith(s.position,"HETATM")){u||(u=e.TokenIndexBuilder.create(4096));var p=r.tokenizeAtom(u,s);if(c++,p)return p}break;case 77:if(s.startsWith(s.position,"MODEL")){c>0&&(0===h.length&&(d={start:o.length+3,end:o.length+4}),u&&h.push(new n.ModelData(d,u.tokens,c)));var m=s.position+6,y=s.moveToEndOfLine();s.trim(m,y),d={start:s.trimmedToken.start,end:s.trimmedToken.end},(c>0||!u)&&(u=e.TokenIndexBuilder.create(4096)),c=0}}if(s.moveToNextLine(),!l)break}var g=o+".?0123";return c>0&&(0===h.length&&(d={start:o.length+3,end:o.length+4}),u&&h.push(new n.ModelData(d,u.tokens,c))),new n.MoleculeData(new n.Header(t),f,new n.ModelsData(h),g)},r.getDotRange=function(t){return{start:t-6,end:t-5}},r.getNumberRanges=function(e){for(var n=t.Utils.FastMap.create(),r=0;r<4;r++)n.set(r,{start:e-4+r,end:e-3+r});return n},r.getQuestionmarkRange=function(t){return{start:t-5,end:t-4}},r.parse=function(t,n){var i=r.tokenize(t,n);return i instanceof e.ParserError?e.ParserResult.error(i.message,i.line):e.ParserResult.success(i.toCifFile())},r}();n.Parser=o,n.toCifFile=r}(n.PDB||(n.PDB={}))}(e.Molecule||(e.Molecule={}))}(t.Formats||(t.Formats={}))}(t.Core||(t.Core={}))}(o||(o={}));var o;!function(t){!function(t){!function(e){!function(n){!function(n){function r(n,r){var i=n.split(/\r?\n/g),o=i[0].trim();o.length||(o="SDF");var s=i[3],a=+s.substr(0,3),u=+s.substr(3,3);return{id:r?r:o,atomCount:a,bondCount:u,atoms:t.Utils.DataTable.ofDefinition(t.Structure.Tables.Atoms,a),positions:t.Utils.DataTable.ofDefinition(t.Structure.Tables.Positions,a),bonds:t.Utils.DataTable.ofDefinition(t.Structure.Tables.Bonds,u),lines:i,currentLine:4,error:void 0,stringPool:e.ShortStringPool.create()}}function i(n,r){var i=r.lines[r.currentLine],o=r.atoms,s=r.positions,a=e.ShortStringPool.get(r.stringPool,i.substr(31,3).trim());o.id[n]=n,o.elementSymbol[n]=a,o.name[n]=a,o.authName[n]=a,o.occupancy[n]=1,o.rowIndex[n]=r.currentLine,s.x[n]=t.Utils.FastNumberParsers.parseFloatSkipTrailingWhitespace(i,0,10),s.y[n]=t.Utils.FastNumberParsers.parseFloatSkipTrailingWhitespace(i,10,20),s.z[n]=t.Utils.FastNumberParsers.parseFloatSkipTrailingWhitespace(i,20,30)}function o(t){for(var e=0;e<t.atomCount;e++)i(e,t),t.currentLine++}function s(e,n){var r=n.lines[n.currentLine],i=n.bonds;switch(i.atomAIndex[e]=t.Utils.FastNumberParsers.parseIntSkipTrailingWhitespace(r,0,3)-1,i.atomBIndex[e]=t.Utils.FastNumberParsers.parseIntSkipTrailingWhitespace(r,3,6)-1,t.Utils.FastNumberParsers.parseIntSkipTrailingWhitespace(r,6,9)){case 1:i.type[e]=1;break;case 2:i.type[e]=2;break;case 3:i.type[e]=3;break;case 4:i.type[e]=4;break;default:i.type[e]=0}}function a(t){for(var e=0;e<t.bondCount;e++)s(e,t),t.currentLine++}function u(e){var n=t.Utils.DataTable.ofDefinition(t.Structure.Tables.Residues,1),r=t.Utils.DataTable.ofDefinition(t.Structure.Tables.Chains,1),i=t.Utils.DataTable.ofDefinition(t.Structure.Tables.Entities,1);n.isHet[0]=1,n.insCode[0]=null,n.name[0]=n.authName[0]="UNK",n.atomEndIndex[0]=r.atomEndIndex[0]=i.atomEndIndex[0]=e.atomCount,n.asymId[0]=n.authAsymId[0]=r.asymId[0]=r.authAsymId[0]="X",n.entityId[0]=r.entityId[0]=i.entityId[0]="1",r.residueEndIndex[0]=i.residueEndIndex[0]=0,i.chainEndIndex[0]=1,i.type[0]="non-polymer";var o=new t.Structure.PolyResidueIdentifier("X",0,null),s=[new t.Structure.SecondaryStructureElement(0,o,o)];return s[0].startResidueIndex=0,s[0].endResidueIndex=1,t.Structure.Molecule.Model.create({id:e.id,modelId:"1",data:{atoms:e.atoms,residues:n,chains:r,entities:i,bonds:{covalent:e.bonds},secondaryStructure:s,symmetryInfo:void 0,assemblyInfo:void 0},positions:e.positions,source:t.Structure.Molecule.Model.Source.File})}function c(n,i){try{var s=r(n,i);o(s),a(s);var c=u(s);if(s.error)return e.ParserResult.error(s.error,s.currentLine+1);var h=t.Structure.Molecule.create(i?i:s.id,[c]);return e.ParserResult.success(h)}catch(t){return e.ParserResult.error(""+t)}}n.parse=c}(n.SDF||(n.SDF={}))}(e.Molecule||(e.Molecule={}))}(t.Formats||(t.Formats={}))}(t.Core||(t.Core={}))}(o||(o={}));var o;!function(t){!function(t){!function(e){!function(n){function r(r,i){var o=this;return function(u,c){return t.computation(function(t){return s(o,void 0,void 0,function(){var o,s,h;return a(this,function(a){switch(a.label){case 0:return[4,t.updateProgress("Parsing...")];case 1:if(a.sent(),o=i(u,c),o.isError)throw o.toString();if(s=o.result,!s.dataBlocks.length)throw"The "+r+" data does not contain a data block.";return[4,t.updateProgress("Creating representation...")];case 2:return a.sent(),h=n.mmCIF.ofDataBlock(s.dataBlocks[0]),[2,e.ParserResult.success(h,s.dataBlocks.length>1?["The input data contains multiple data blocks, only the first one was parsed. To parse all data blocks, use the function 'mmCIF.ofDataBlock' separately for each block."]:void 0)]}})})})}}!function(i){var o=this;i.mmCIF={name:"mmCIF",shortcuts:["mmcif","cif"],extensions:[".cif"],parse:r("CIF",e.CIF.Text.parse)},i.mmBCIF={name:"mmCIF (Binary)",shortcuts:["mmbcif","bcif","binarycif"],extensions:[".bcif"],isBinary:!0,parse:r("BinaryCIF",e.CIF.Binary.parse)},i.PDB={name:"PDB",shortcuts:["pdb","ent"],extensions:[".pdb",".ent"],parse:r("PDB",function(t,e){return n.PDB.toCifFile(e&&e.id||"PDB",t)})},i.SDF={name:"SDF",shortcuts:["sdf","mol"],extensions:[".sdf",".mol"],parse:function(r,i){return t.computation(function(t){return s(o,void 0,void 0,function(){var o;return a(this,function(s){switch(s.label){case 0:return[4,t.updateProgress("Parsing...")];case 1:if(s.sent(),o=n.SDF.parse(r,i&&i.id||void 0),o.isError)throw o.toString();return[2,e.ParserResult.success(o.result)]}})})})}},i.All=[i.mmCIF,i.mmBCIF,i.PDB,i.SDF]}(n.SupportedFormats||(n.SupportedFormats={}))}(e.Molecule||(e.Molecule={}))}(t.Formats||(t.Formats={}))}(t.Core||(t.Core={}))}(o||(o={}));var o;!function(t){!function(t){!function(t){!function(t){function e(t,e){for(var n=t.length,r=0;r<n;r++)t[r]=e}function n(t,e,n){var r=Math.PI/180*n[0],i=Math.PI/180*n[1],o=Math.PI/180*n[2],s=e[0],a=e[1],u=e[2],c=Math.cos(i),h=(Math.cos(r)-Math.cos(i)*Math.cos(o))/Math.sin(o),f=Math.sqrt(1-c*c-h*h);return{number:t,size:e,angles:n,basis:{x:[s,0,0],y:[Math.cos(o)*a,Math.sin(o)*a,0],z:[c*u,h*u,f*u]}}}var r=function(){function t(t,e){this.data=t,this.dimensions=e,this.len=this.dimensions[0]*this.dimensions[1]*this.dimensions[2],this.nX=this.dimensions[0],this.nY=this.dimensions[1]}return Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!0,configurable:!0}),t.prototype.getAt=function(t){return this.data[t]},t.prototype.setAt=function(t,e){this.data[t]=e},t.prototype.get=function(t,e,n){return this.data[this.nX*(n*this.nY+e)+t|0]},t.prototype.set=function(t,e,n,r){this.data[this.nX*(n*this.nY+e)+t|0]=r},t.prototype.fill=function(t){e(this.data,t)},t}();t.Field3DZYX=r,t.createSpacegroup=n}(t.Density||(t.Density={}))}(t.Formats||(t.Formats={}))}(t.Core||(t.Core={}))}(o||(o={}));var o;!function(t){!function(t){!function(t){!function(e){!function(n){function r(t){return i.parse(t)}n.parse=r;var i;!function(n){function r(t,e,n){for(var r=[],i=0;i<n;i++)r[i]=t(e+i);return r}function i(n){var i=new DataView(n,0,1024),a=[],u=!1,c=i.getInt32(12,!1);if(2!==c&&(u=!0,2!==(c=i.getInt32(12,!0))))return t.ParserResult.error("Only CCP4 mode 2 is supported.");var h=function(t){return i.getInt32(4*t,u)},f=function(t){return i.getFloat32(4*t,u)},d={extent:r(h,0,3),mode:c,nxyzStart:r(h,4,3),grid:r(h,7,3),cellSize:r(f,10,3),cellAngles:r(f,13,3),crs2xyz:r(h,16,3),min:f(19),max:f(20),mean:f(21),spacegroupNumber:h(22),symBytes:h(23),skewFlag:h(24),skewMatrix:r(f,25,9),skewTranslation:r(f,34,3),origin2k:r(f,49,3)},l=n.byteLength-4*d.extent[0]*d.extent[1]*d.extent[2];if(l!==1024+d.symBytes)if(1024===l)a.push("File contains bogus symmetry record.");else{if(l<1024)return t.ParserResult.error("File appears truncated and doesn't match header.");if(!(l>1024&&l<1048576))return t.ParserResult.error("File is MUCH larger than expected and doesn't match header.");l=1024+d.symBytes,a.push("File is larger than expected and doesn't match header. Continuing file load, good luck!")}0===d.grid[0]&&d.extent[0]>0&&(d.grid[0]=d.extent[0]-1,a.push("Fixed X interval count.")),0===d.grid[1]&&d.extent[1]>0&&(d.grid[1]=d.extent[1]-1,a.push("Fixed Y interval count.")),0===d.grid[2]&&d.extent[2]>0&&(d.grid[2]=d.extent[2]-1,a.push("Fixed Z interval count.")),0===d.crs2xyz[0]&&0===d.crs2xyz[1]&&0===d.crs2xyz[2]&&(a.push("All crs2xyz records are zero. Setting crs2xyz to 1, 2, 3."),d.crs2xyz=[1,2,3]),0===d.cellSize[0]&&0===d.cellSize[1]&&0===d.cellSize[2]&&(a.push("Cell dimensions are all zero. Setting to 1.0, 1.0, 1.0. Map file will not align with other structures."),d.cellSize[0]=1,d.cellSize[1]=1,d.cellSize[2]=1);var p=[0,0,0];p[d.crs2xyz[0]-1]=0,p[d.crs2xyz[1]-1]=1,p[d.crs2xyz[2]-1]=2;var m;m=0===d.origin2k[0]&&0===d.origin2k[1]&&0===d.origin2k[2]?[d.nxyzStart[p[0]],d.nxyzStart[p[1]],d.nxyzStart[p[2]]]:[d.origin2k[p[0]],d.origin2k[p[1]],d.origin2k[p[2]]];var y=[d.extent[p[0]],d.extent[p[1]],d.extent[p[2]]],g=13330===new Uint16Array(new Uint8Array([18,52]).buffer)[0],v=u===g?o(new Float32Array(n,1024+d.symBytes,y[0]*y[1]*y[2]),u,y,d.extent,p,d.mean):s(new DataView(n,1024+d.symBytes),u,y,d.extent,p,d.mean),b=new e.Field3DZYX(v.data,y),_={spacegroup:e.createSpacegroup(d.spacegroupNumber,d.cellSize,d.cellAngles),box:{origin:[m[0]/d.grid[0],m[1]/d.grid[1],m[2]/d.grid[2]],dimensions:[y[0]/d.grid[0],y[1]/d.grid[1],y[2]/d.grid[2]],sampleCount:y},data:b,valuesInfo:{min:d.min,max:d.max,mean:d.mean,sigma:v.sigma}};return t.ParserResult.success(_,a)}function o(t,e,n,r,i,o){var s,a,u,c,h,f,d,l,p=new Float32Array(n[0]*n[1]*n[2]),m=[0,0,0],y=0,g=.1,v=0,b=.1,_=i[0],w=i[1],x=i[2];for(s=r[0],a=r[1],u=r[2],d=n[0],l=n[0]*n[1],f=0;f<u;f++)for(m[2]=f,h=0;h<a;h++)for(m[1]=h,c=0;c<s;c++)m[0]=c,g=t[y],b=g-o,v+=b*b,p[m[_]+m[w]*d+m[x]*l]=g,y+=1;return v/=s*a*u,v=Math.sqrt(v),{data:p,sigma:v}}function s(t,e,n,r,i,o){var s,a,u,c,h,f,d,l,p=new Float32Array(n[0]*n[1]*n[2]),m=[0,0,0],y=0,g=.1,v=0,b=.1,_=i[0],w=i[1],x=i[2];for(s=r[0],a=r[1],u=r[2],d=n[0],l=n[0]*n[1],f=0;f<u;f++)for(m[2]=f,h=0;h<a;h++)for(m[1]=h,c=0;c<s;c++)m[0]=c,g=t.getFloat32(y,e),b=g-o,v+=b*b,p[m[_]+m[w]*d+m[x]*l]=g,y+=4;return v/=s*a*u,v=Math.sqrt(v),{data:p,sigma:v}}n.parse=i}(i||(i={}))}(e.CCP4||(e.CCP4={}))}(t.Density||(t.Density={}))}(t.Formats||(t.Formats={}))}(t.Core||(t.Core={}))}(o||(o={}));var o;!function(t){!function(t){!function(t){!function(e){!function(n){function r(e){return e.getCategory("_density_info")?i.parseLegacy(e):e.getCategory("_volume_data_3d_info")?i.parse(e):t.ParserResult.error("Invalid data format.")}n.parse=r;var i;!function(n){function r(n){function r(t){for(var e=[0,0,0],n=0;n<3;n++)e[n]=a.getColumn(t+"["+n+"]").getFloat(0);return e}function i(t){return a.getColumn(t).getFloat(0)}function s(t){return[t[c[0]],t[c[1]],t[c[2]]]}var a=n.getCategory("_volume_data_3d_info");if(!a)return t.ParserResult.error("_volume_data_3d_info category is missing.");if(!n.getCategory("_volume_data_3d"))return t.ParserResult.error("_volume_data_3d category is missing.");var u={name:a.getColumn("name").getString(0),axisOrder:r("axis_order"),origin:r("origin"),dimensions:r("dimensions"),sampleCount:r("sample_count"),spacegroupNumber:0|i("spacegroup_number"),cellSize:r("spacegroup_cell_size"),cellAngles:r("spacegroup_cell_angles"),mean:i("mean_sampled"),sigma:i("sigma_sampled")},c=[0,0,0];c[u.axisOrder[0]]=0,c[u.axisOrder[1]]=1,c[u.axisOrder[2]]=2;var h=s(u.sampleCount),f=o(n.getCategory("_volume_data_3d").getColumn("values"),h,u.sampleCount,c),d=new e.Field3DZYX(f.data,h),l={name:u.name,spacegroup:e.createSpacegroup(u.spacegroupNumber,u.cellSize,u.cellAngles),box:{origin:s(u.origin),dimensions:s(u.dimensions),sampleCount:h},data:d,valuesInfo:{min:f.min,max:f.max,mean:u.mean,sigma:u.sigma}};return t.ParserResult.success(l)}function i(n){function r(t){for(var e=[],n=0;n<3;n++)e[n]=s.getColumn(t+"["+n+"]").getFloat(0);return e}function i(t){return s.getColumn(t).getFloat(0)}var s=n.getCategory("_density_info");if(!s)return t.ParserResult.error("_density_info category is missing.");if(!n.getCategory("_density_data"))return t.ParserResult.error("_density_data category is missing.");var a={name:s.getColumn("name").getString(0),grid:r("grid"),axisOrder:r("axis_order"),extent:r("extent"),origin:r("origin"),cellSize:r("cell_size"),cellAngles:r("cell_angles"),mean:i("mean"),sigma:i("sigma"),spacegroupNumber:0|i("spacegroup_number")},u=[0,0,0];u[a.axisOrder[0]]=0,u[a.axisOrder[1]]=1,u[a.axisOrder[2]]=2;var c=[a.origin[u[0]],a.origin[u[1]],a.origin[u[2]]],h=[a.extent[u[0]],a.extent[u[1]],a.extent[u[2]]],f=o(n.getCategory("_density_data").getColumn("values"),h,a.extent,u),d=new e.Field3DZYX(f.data,h),l={name:a.name,spacegroup:e.createSpacegroup(a.spacegroupNumber,a.cellSize,a.cellAngles),box:{origin:[c[0]/a.grid[0],c[1]/a.grid[1],c[2]/a.grid[2]],dimensions:[h[0]/a.grid[0],h[1]/a.grid[1],h[2]/a.grid[2]],sampleCount:h},data:d,valuesInfo:{min:f.min,max:f.max,mean:a.mean,sigma:a.sigma}};return t.ParserResult.success(l)}function o(t,e,n,r){for(var i=new Float32Array(e[0]*e[1]*e[2]),o=[0,0,0],s=r[0],a=r[1],u=r[2],c=n[0],h=n[1],f=n[2],d=e[0],l=e[0]*e[1],p=0,m=t.getFloat(0),y=m,g=0;g<f;g++){o[2]=g;for(var v=0;v<h;v++){o[1]=v;for(var b=0;b<c;b++){o[0]=b;var _=t.getFloat(p);p+=1,i[o[s]+o[a]*d+o[u]*l]=_,_<m?m=_:_>y&&(y=_)}}}return{data:i,min:m,max:y}}n.parse=r,n.parseLegacy=i}(i||(i={}))}(e.CIF||(e.CIF={}))}(t.Density||(t.Density={}))}(t.Formats||(t.Formats={}))}(t.Core||(t.Core={}))}(o||(o={}));var o;!function(t){!function(t){!function(e){!function(e){function n(e,n,r){var i=this;return t.computation(function(t){return s(i,void 0,void 0,function(){return a(this,function(i){switch(i.label){case 0:return[4,t.updateProgress("Parsing "+n+"...")];case 1:return i.sent(),[2,r(e)]}})})})}!function(t){t.CCP4={name:"CCP4",shortcuts:["ccp4","map"],extensions:[".ccp4",".map"],isBinary:!0,parse:function(t){return n(t,"CCP4",function(t){return e.CCP4.parse(t)})}},t.All=[t.CCP4]}(e.SupportedFormats||(e.SupportedFormats={}))}(e.Density||(e.Density={}))}(t.Formats||(t.Formats={}))}(t.Core||(t.Core={}))}(o||(o={}));var o;!function(t){!function(t){!function(t){!function(t){var e="undefined"!=typeof Float64Array?function(t){return new Float64Array(t)}:function(t){return[]};!function(t){function n(){return e(16)}function r(){var t=e(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function i(t){var n,r,i,o=e(16);for(n=0;n<4;n++)for(i=t[n],r=0;r<4;r++)o[4*r+n]=i[r];return o}function o(t,e,n){for(var r=0;r<16;r++)if(Math.abs(t[r]-e[r])>n)return!1;return!0}function s(t,e,n,r){t[4*n+e]=r}function a(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function u(e){return t.copy(t.empty(),e)}function c(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=e[6],c=e[7],h=e[8],f=e[9],d=e[10],l=e[11],p=e[12],m=e[13],y=e[14],g=e[15],v=n*a-r*s,b=n*u-i*s,_=n*c-o*s,w=r*u-i*a,x=r*c-o*a,C=i*c-o*u,I=h*m-f*p,S=h*y-d*p,A=h*g-l*p,k=f*y-d*m,E=f*g-l*m,P=d*g-l*y,T=v*P-b*E+_*k+w*A-x*S+C*I;return T?(T=1/T,t[0]=(a*P-u*E+c*k)*T,t[1]=(i*E-r*P-o*k)*T,t[2]=(m*C-y*x+g*w)*T,t[3]=(d*x-f*C-l*w)*T,t[4]=(u*A-s*P-c*S)*T,t[5]=(n*P-i*A+o*S)*T,t[6]=(y*_-p*C-g*b)*T,t[7]=(h*C-d*_+l*b)*T,t[8]=(s*E-a*A+c*I)*T,t[9]=(r*A-n*E-o*I)*T,t[10]=(p*x-m*_+g*v)*T,t[11]=(f*_-h*x-l*v)*T,t[12]=(a*S-s*k-u*I)*T,t[13]=(n*k-r*S+i*I)*T,t[14]=(m*b-p*w-y*v)*T,t[15]=(h*w-f*b+d*v)*T,t):null}function h(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],c=e[6],h=e[7],f=e[8],d=e[9],l=e[10],p=e[11],m=e[12],y=e[13],g=e[14],v=e[15],b=n[0],_=n[1],w=n[2],x=n[3];return t[0]=b*r+_*a+w*f+x*m,t[1]=b*i+_*u+w*d+x*y,t[2]=b*o+_*c+w*l+x*g,t[3]=b*s+_*h+w*p+x*v,b=n[4],_=n[5],w=n[6],x=n[7],t[4]=b*r+_*a+w*f+x*m,t[5]=b*i+_*u+w*d+x*y,t[6]=b*o+_*c+w*l+x*g,t[7]=b*s+_*h+w*p+x*v,b=n[8],_=n[9],w=n[10],x=n[11],t[8]=b*r+_*a+w*f+x*m,t[9]=b*i+_*u+w*d+x*y,t[10]=b*o+_*c+w*l+x*g,t[11]=b*s+_*h+w*p+x*v,b=n[12],_=n[13],w=n[14],x=n[15],t[12]=b*r+_*a+w*f+x*m,t[13]=b*i+_*u+w*d+x*y,t[14]=b*o+_*c+w*l+x*g,t[15]=b*s+_*h+w*p+x*v,t}function f(t,e,n){var r,i,o,s,a,u,c,h,f,d,l,p,m=n[0],y=n[1],g=n[2];return e===t?(t[12]=e[0]*m+e[4]*y+e[8]*g+e[12],t[13]=e[1]*m+e[5]*y+e[9]*g+e[13],t[14]=e[2]*m+e[6]*y+e[10]*g+e[14],t[15]=e[3]*m+e[7]*y+e[11]*g+e[15]):(r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],c=e[6],h=e[7],f=e[8],d=e[9],l=e[10],p=e[11],t[0]=r,t[1]=i,t[2]=o,t[3]=s,t[4]=a,t[5]=u,t[6]=c,t[7]=h,t[8]=f,t[9]=d,t[10]=l,t[11]=p,t[12]=r*m+a*y+f*g+e[12],t[13]=i*m+u*y+d*g+e[13],t[14]=o*m+c*y+l*g+e[14],t[15]=s*m+h*y+p*g+e[15]),t}function d(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function l(t,e,n){var r=e.x,i=e.y,o=e.z;return t.x=n[0]*r+n[4]*i+n[8]*o+n[12],t.y=n[1]*r+n[5]*i+n[9]*o+n[13],t.z=n[2]*r+n[6]*i+n[10]*o+n[14],t}function p(t){for(var e="",n=0;n<4;n++){for(var r=0;r<4;r++)e+=t[4*r+n].toString(),r<3&&(e+=" ");n<3&&(e+="\n")}return e}function m(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],s=t[5],a=t[6],u=t[7],c=t[8],h=t[9],f=t[10],d=t[11],l=t[12],p=t[13],m=t[14],y=t[15];return(e*s-n*o)*(f*y-d*m)-(e*a-r*o)*(h*y-d*p)+(e*u-i*o)*(h*m-f*p)+(n*a-r*s)*(c*y-d*l)-(n*u-i*s)*(c*m-f*l)+(r*u-i*a)*(c*p-h*l)}t.empty=n,t.identity=r,t.ofRows=i,t.areEqual=o,t.setValue=s,t.copy=a,t.clone=u,t.invert=c,t.mul=h,t.translate=f,t.fromTranslation=d,t.transformVector3=l,t.makeTable=p,t.determinant=m}(t.Matrix4||(t.Matrix4={}));!function(t){function n(){var t=e(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function r(t){var n=e(4);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n}function i(t,n,r,i){var o=e(4);return o[0]=t,o[1]=n,o[2]=r,o[3]=i,o}function o(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t}function s(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return Math.sqrt(n*n+r*r+i*i+o*o)}function a(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return n*n+r*r+i*i+o*o}function u(t){var e=t[0],n=t[1],r=t[2],i=t[3];return Math.sqrt(e*e+n*n+r*r+i*i)}function c(t){var e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i}function h(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*s,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*s,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*s,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*s,t}t.create=n,t.clone=r,t.fromValues=i,t.set=o,t.distance=s,t.squaredDistance=a,t.norm=u,t.squaredNorm=c,t.transform=h}(t.Vector4||(t.Vector4={}))}(t.LinearAlgebra||(t.LinearAlgebra={}))}(t.Geometry||(t.Geometry={}))}(t.Core||(t.Core={}))}(o||(o={}));var o;!function(t){!function(t){!function(t){var e;!function(t){function e(t){var e,n=2*t.capacity+1,r=new Int32Array(n);if(t.count<32)for(e=0;e<t.count;e++)r[e]=t.indices[e];else r.set(t.indices);t.indices=r,t.capacity=n}function n(t,n){this.count+1>=this.capacity&&e(this),this.indices[this.count++]=n}function r(){this.count=0}function i(t){return t<1&&(t=1),{indices:new Int32Array(t),count:0,capacity:t,hasPriorities:!1,priorities:void 0,add:n,reset:r}}t.create=i}(e=t.SubdivisionTree3DResultIndexBuffer||(t.SubdivisionTree3DResultIndexBuffer={}));var n;!function(t){function e(t){var e,n=2*t.capacity+1,r=new Int32Array(n),i=new Float32Array(n);if(t.count<32)for(e=0;e<t.count;e++)r[e]=t.indices[e],i[e]=t.priorities[e];else r.set(t.indices),i.set(t.priorities);t.indices=r,t.priorities=i,t.capacity=n}function n(t,n){this.count+1>=this.capacity&&e(this),this.priorities[this.count]=t,this.indices[this.count++]=n}function r(){this.count=0}function i(t){return t<1&&(t=1),{indices:new Int32Array(t),count:0,capacity:t,hasPriorities:!0,priorities:new Float32Array(t),add:n,reset:r}}t.create=i}(n=t.SubdivisionTree3DResultPriorityBuffer||(t.SubdivisionTree3DResultPriorityBuffer={}));var r;!function(t){function e(t,e,n,r){this.pivot[0]=t,this.pivot[1]=e,this.pivot[2]=n,this.radius=r,this.radiusSq=r*r,this.buffer.reset(),o.nearest(this.tree.root,this,0)}function n(t,n){return{tree:t,indices:t.indices,positions:t.positions,buffer:n,pivot:[.1,.1,.1],radius:1.1,radiusSq:1.1*1.1,nearest:e}}t.create=n}(r=t.SubdivisionTree3DQueryContext||(t.SubdivisionTree3DQueryContext={}));!function(t){function i(t,i,o){return void 0===o&&(o=!1),r.create(t,o?n.create(Math.max(i*i|0,8)):e.create(Math.max(i*i|0,8)))}function o(t,e,n){void 0===n&&(n=32);var r=a.build(t,e,n);return{data:t,root:r.root,indices:r.indices,positions:r.positions}}t.createContextRadius=i,t.create=o}(t.SubdivisionTree3D||(t.SubdivisionTree3D={}));var i;!function(t){function e(t,e,n,r){t.data[t._count++]=e,t.data[t._count++]=n,t.data[t._count++]=r,t.boundsMin[0]=Math.min(e,t.boundsMin[0]),t.boundsMin[1]=Math.min(n,t.boundsMin[1]),t.boundsMin[2]=Math.min(r,t.boundsMin[2]),t.boundsMax[0]=Math.max(e,t.boundsMax[0]),t.boundsMax[1]=Math.max(n,t.boundsMax[1]),t.boundsMax[2]=Math.max(r,t.boundsMax[2])}function n(t){var e=new Float32Array(3*t|0),n=s.createInfinite();return{_count:0,data:e,bounds:n,boundsMin:n.min,boundsMax:n.max}}t.add=e,t.create=n}(i||(i={}));var o;!function(t){function e(t,e){var n,r,i,o,s,a,u=e.pivot,c=e.indices,h=e.positions,f=e.radiusSq;for(a=t.startIndex;a<t.endIndex;a++)o=3*c[a],n=u[0]-h[o],r=u[1]-h[o+1],i=u[2]-h[o+2],(s=n*n+r*r+i*i)<=f&&e.buffer.add(s,c[a])}function n(t,e,n){var i=e.pivot[n],o=i<t.splitValue;(o?i+e.radius>t.splitValue:i-e.radius<t.splitValue)?(r(t.left,e,(n+1)%3),r(t.right,e,(n+1)%3)):o?r(t.left,e,(n+1)%3):r(t.right,e,(n+1)%3)}function r(t,r,i){t.startIndex!==t.endIndex&&(isNaN(t.splitValue)?e(t,r):n(t,r,i))}function i(t,e,n,r,i){return{splitValue:t,startIndex:e,endIndex:n,left:r,right:i}}t.nearest=r,t.create=i}(o=t.SubdivisionTree3DNode||(t.SubdivisionTree3DNode={}));var s;!function(t){function e(){return{min:[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],max:[-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE]}}t.createInfinite=e}(s=t.Box3D||(t.Box3D={}));var a;!function(t){function e(t,n,r,i){var s=r-n+1;if(s<=0)return t.emptyNode;if(s<=t.leafSize)return o.create(NaN,n,r+1,t.emptyNode,t.emptyNode);for(var a,u,c,h=t.bounds.min[i],f=t.bounds.max[i],d=.5*(h+f),l=0,p=n,m=r;p<m;){for(a=t.indices[m],t.indices[m]=t.indices[p],t.indices[p]=a;p<=r&&t.positions[3*t.indices[p]+i]<=d;)p++;for(;m>=n&&t.positions[3*t.indices[m]+i]>d;)m--}return l=p-1,t.bounds.max[i]=d,u=e(t,n,l,(i+1)%3),t.bounds.max[i]=f,t.bounds.min[i]=d,c=e(t,l+1,r,(i+1)%3),t.bounds.min[i]=h,o.create(d,n,r+1,u,c)}function n(t){var e=i.add;return function(n,r,i){e(t,n,r,i)}}function r(t,r,s){for(var a=i.create(t.length),u=new Int32Array(t.length),c=n(a),h=0;h<t.length;h++)u[h]=h,r(t[h],c);c=void 0;var f={bounds:a.bounds,positions:a.data,leafSize:s,indices:u,emptyNode:o.create(NaN,-1,-1,void 0,void 0)},d=e(f,0,u.length-1,0);return f=void 0,{root:d,indices:u,positions:a.data}}t.build=r}(a||(a={}))}(t.Geometry||(t.Geometry={}))}(t.Core||(t.Core={}))}(o||(o={}));var o;!function(t){!function(t){!function(e){
!function(n){function r(t){if(!t.normals){for(var e=new Float32Array(t.vertices.length),n=t.vertices,r=t.triangleIndices,i=0;i<r.length;i+=3){var o=3*r[i],s=3*r[i+1],a=3*r[i+2],u=n[o+2]*(n[s+1]-n[a+1])+n[s+2]*n[a+1]-n[s+1]*n[a+2]+n[o+1]*(-n[s+2]+n[a+2]),c=-(n[s+2]*n[a])+n[o+2]*(-n[s]+n[a])+n[o]*(n[s+2]-n[a+2])+n[s]*n[a+2],h=n[o+1]*(n[s]-n[a])+n[s+1]*n[a]-n[s]*n[a+1]+n[o]*(-n[s+1]+n[s+1]);e[o]+=u,e[o+1]+=c,e[o+2]+=h,e[s]+=u,e[s+1]+=c,e[s+2]+=h,e[a]+=u,e[a+1]+=c,e[a+2]+=h}for(var i=0;i<e.length;i+=3){var u=e[i],c=e[i+1],h=e[i+2],f=1/Math.sqrt(u*u+c*c+h*h);e[i]*=f,e[i+1]*=f,e[i+2]*=f}t.normals=e}}function i(e){var n=this;return t.computation(function(t){return s(n,void 0,void 0,function(){return a(this,function(n){switch(n.label){case 0:return e.normals?[2,e]:[4,t.updateProgress("Computing normals...")];case 1:return n.sent(),r(e),[2,e]}})})})}function o(t,e,n,r){n[3*r]+=t[3*e],n[3*r+1]+=t[3*e+1],n[3*r+2]+=t[3*e+2]}function u(t,e,n,r){for(var i=t.triangleIndices.length,s=t.vertices,a=t.triangleIndices,u=0;u<i;u+=3){var c=a[u],h=a[u+1],f=a[u+2];o(s,h,n,c),o(s,f,n,c),o(s,c,n,h),o(s,f,n,h),o(s,c,n,f),o(s,h,n,f)}for(var d=2*r,u=0,l=t.vertexCount;u<l;u++){var p=e[u]+d;n[3*u]=(n[3*u]+d*s[3*u])/p,n[3*u+1]=(n[3*u+1]+d*s[3*u+1])/p,n[3*u+2]=(n[3*u+2]+d*s[3*u+2])/p}}function c(e,n,r,i){return s(this,void 0,void 0,function(){var o,s,c,h,f,d,h,l,p,m,y;return a(this,function(a){switch(a.label){case 0:return[4,e.updateProgress("Smoothing surface...",!0)];case 1:for(a.sent(),o=new Int32Array(n.vertexCount),s=n.triangleIndices.length,c=n.triangleIndices,h=0;h<s;h++)o[c[h]]+=2;return f=new Float32Array(n.vertices.length),d=t.Utils.PerformanceMonitor.currentTime(),[4,e.updateProgress("Smoothing surface...",!0)];case 2:a.sent(),h=0,a.label=3;case 3:if(!(h<r))return[3,6];if(h>0)for(l=0,p=f.length;l<p;l++)f[l]=0;return n.normals=void 0,u(n,o,f,i),m=n.vertices,n.vertices=f,f=m,(y=t.Utils.PerformanceMonitor.currentTime())-d>t.Computation.UpdateProgressDelta?(d=y,[4,e.updateProgress("Smoothing surface...",!0,h+1,r)]):[3,5];case 4:a.sent(),a.label=5;case 5:return h++,[3,3];case 6:return[2,n]}})})}function h(e,n,r){var i=this;return void 0===n&&(n=1),void 0===r&&(r=1),n<1&&(n=0),0===n?t.Computation.resolve(e):t.computation(function(t){return s(i,void 0,void 0,function(){return a(this,function(i){switch(i.label){case 0:return[4,c(t,e,n,1.1*r/1.1)];case 1:return[2,i.sent()]}})})})}function f(e){var n=this;return t.computation(function(t){return s(n,void 0,void 0,function(){var n,r,i,o,s,u,c,s,u,h,f,d;return a(this,function(a){switch(a.label){case 0:return e.boundingSphere?[2,e]:[4,t.updateProgress("Computing bounding sphere...")];case 1:for(a.sent(),n=e.vertices,r=0,i=0,o=0,s=0,u=e.vertices.length;s<u;s+=3)r+=n[s],i+=n[s+1],o+=n[s+2];for(r/=e.vertexCount,i/=e.vertexCount,o/=e.vertexCount,c=0,s=0,u=n.length;s<u;s+=3)h=r-n[s],f=i-n[s+1],d=o-n[s+2],c=Math.max(c,h*h+f*f+d*d);return e.boundingSphere={center:{x:r,y:i,z:o},radius:Math.sqrt(c)},[2,e]}})})})}function d(t,n){for(var r={x:.1,y:.1,z:.1},i=e.LinearAlgebra.Matrix4.transformVector3,o=t.vertices,s=0,a=t.vertices.length;s<a;s+=3)r.x=o[s],r.y=o[s+1],r.z=o[s+2],i(r,r,n),o[s]=r.x,o[s+1]=r.y,o[s+2]=r.z;t.normals=void 0,t.boundingSphere=void 0}function l(e,n){var r=this;return t.computation(function(t){return s(r,void 0,void 0,function(){return a(this,function(r){return t.updateProgress("Updating surface..."),d(e,n),[2,e]})})})}n.computeNormalsImmediate=r,n.computeNormals=i,n.laplacianSmooth=h,n.computeBoundingSphere=f,n.transformImmediate=d,n.transform=l}(e.Surface||(e.Surface={}))}(t.Geometry||(t.Geometry={}))}(t.Core||(t.Core={}))}(o||(o={}));var o;!function(t){!function(t){!function(e){!function(e){function n(e){var n=this;return t.computation(function(t){return s(n,void 0,void 0,function(){var n;return a(this,function(i){switch(i.label){case 0:return n=new r(e,t),[4,n.run()];case 1:return[2,i.sent()]}})})})}e.compute=n;var r=function(){function e(e,n){this.ctx=n,this.minX=0,this.minY=0,this.minZ=0,this.maxX=0,this.maxY=0,this.maxZ=0;var r=t.Utils.extend({},e);r.bottomLeft||(r.bottomLeft=[0,0,0]),r.topRight||(r.topRight=r.scalarField.dimensions),this.state=new i(r),this.minX=r.bottomLeft[0],this.minY=r.bottomLeft[1],this.minZ=r.bottomLeft[2],this.maxX=r.topRight[0]-1,this.maxY=r.topRight[1]-1,this.maxZ=r.topRight[2]-1,this.size=(this.maxX-this.minX)*(this.maxY-this.minY)*(this.maxZ-this.minZ),this.sliceSize=(this.maxX-this.minX)*(this.maxY-this.minY)}return e.prototype.doSlices=function(){return s(this,void 0,void 0,function(){var e,n,r,i;return a(this,function(o){switch(o.label){case 0:e=0,n=t.Utils.PerformanceMonitor.currentTime(),r=this.minZ,o.label=1;case 1:return r<this.maxZ?(this.slice(r),e+=this.sliceSize,i=t.Utils.PerformanceMonitor.currentTime(),i-n>t.Computation.UpdateProgressDelta?[4,this.ctx.updateProgress("Computing surface...",!0,e,this.size)]:[3,3]):[3,4];case 2:o.sent(),n=i,o.label=3;case 3:return r++,[3,1];case 4:return[2]}})})},e.prototype.slice=function(t){for(var e=this.minY;e<this.maxY;e++)for(var n=this.minX;n<this.maxX;n++)this.state.processCell(n,e,t);this.state.clearEdgeVertexIndexSlice(t)},e.prototype.finish=function(){var e=t.Utils.ChunkedArray.compact(this.state.vertexBuffer),n=t.Utils.ChunkedArray.compact(this.state.triangleBuffer);return this.state.vertexBuffer=void 0,this.state.verticesOnEdges=void 0,{vertexCount:e.length/3|0,triangleCount:n.length/3|0,vertices:e,triangleIndices:n,annotation:this.state.annotate?t.Utils.ChunkedArray.compact(this.state.annotationBuffer):void 0}},e.prototype.run=function(){return s(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,this.ctx.updateProgress("Computing surface...",!0,0,this.size)];case 1:return t.sent(),[4,this.doSlices()];case 2:return t.sent(),[4,this.ctx.updateProgress("Finalizing...")];case 3:return t.sent(),[2,this.finish()]}})})},e}(),i=function(){function n(e){this.vertList=[0,0,0,0,0,0,0,0,0,0,0,0],this.i=0,this.j=0,this.k=0,this.nX=e.scalarField.dimensions[0],this.nY=e.scalarField.dimensions[1],this.nZ=e.scalarField.dimensions[2],this.isoLevel=e.isoLevel,this.scalarField=e.scalarField,this.annotationField=e.annotationField;var n=e.topRight[0]-e.bottomLeft[0],r=e.topRight[1]-e.bottomLeft[1],i=e.topRight[2]-e.bottomLeft[2],o=Math.min(262144,0|Math.max(n*r*i/16,1024)),s=Math.min(65536,4*o);this.vertexBuffer=t.Utils.ChunkedArray.forVertex3D(o),this.triangleBuffer=t.Utils.ChunkedArray.create(function(t){return new Uint32Array(t)},s,3),this.annotate=!!e.annotationField,this.annotate&&(this.annotationBuffer=t.Utils.ChunkedArray.forInt32(o)),this.verticesOnEdges=new Int32Array(3*this.nX*this.nY*2)}return n.prototype.get3dOffsetFromEdgeInfo=function(t){return this.nX*((this.k+t.k)%2*this.nY+this.j+t.j)+this.i+t.i},n.prototype.clearEdgeVertexIndexSlice=function(t){for(var e=t%2==0?0:3*this.nX*this.nY,n=t%2==0?3*this.nX*this.nY:this.verticesOnEdges.length,r=e;r<n;r++)this.verticesOnEdges[r]=0},n.prototype.interpolate=function(n){var r=e.EdgeIdInfo[n],i=3*this.get3dOffsetFromEdgeInfo(r)+r.e,o=this.verticesOnEdges[i];if(o>0)return o-1|0;var s=e.CubeEdges[n],a=s.a,u=s.b,c=a.i+this.i,h=a.j+this.j,f=a.k+this.k,d=u.i+this.i,l=u.j+this.j,p=u.k+this.k,m=this.scalarField.get(c,h,f),y=this.scalarField.get(d,l,p),g=(this.isoLevel-m)/(m-y),v=0|t.Utils.ChunkedArray.add3(this.vertexBuffer,c+g*(c-d),h+g*(h-l),f+g*(f-p));if(this.verticesOnEdges[i]=v+1,this.annotate){var b=g<.5?this.annotationField.get(c,h,f):this.annotationField.get(d,l,p);b<0&&(b=g<.5?this.annotationField.get(d,l,p):this.annotationField.get(c,h,f)),t.Utils.ChunkedArray.add(this.annotationBuffer,b)}return v},n.prototype.processCell=function(n,r,i){var o=0;if(this.scalarField.get(n,r,i)<this.isoLevel&&(o|=1),this.scalarField.get(n+1,r,i)<this.isoLevel&&(o|=2),this.scalarField.get(n+1,r+1,i)<this.isoLevel&&(o|=4),this.scalarField.get(n,r+1,i)<this.isoLevel&&(o|=8),this.scalarField.get(n,r,i+1)<this.isoLevel&&(o|=16),this.scalarField.get(n+1,r,i+1)<this.isoLevel&&(o|=32),this.scalarField.get(n+1,r+1,i+1)<this.isoLevel&&(o|=64),this.scalarField.get(n,r+1,i+1)<this.isoLevel&&(o|=128),0!==o&&255!==o){this.i=n,this.j=r,this.k=i;var s=e.EdgeTable[o];(1&s)>0&&(this.vertList[0]=this.interpolate(0)),(2&s)>0&&(this.vertList[1]=this.interpolate(1)),(4&s)>0&&(this.vertList[2]=this.interpolate(2)),(8&s)>0&&(this.vertList[3]=this.interpolate(3)),(16&s)>0&&(this.vertList[4]=this.interpolate(4)),(32&s)>0&&(this.vertList[5]=this.interpolate(5)),(64&s)>0&&(this.vertList[6]=this.interpolate(6)),(128&s)>0&&(this.vertList[7]=this.interpolate(7)),(256&s)>0&&(this.vertList[8]=this.interpolate(8)),(512&s)>0&&(this.vertList[9]=this.interpolate(9)),(1024&s)>0&&(this.vertList[10]=this.interpolate(10)),(2048&s)>0&&(this.vertList[11]=this.interpolate(11));for(var a=e.TriTable[o],u=0;u<a.length;u+=3)t.Utils.ChunkedArray.add3(this.triangleBuffer,this.vertList[a[u]],this.vertList[a[u+1]],this.vertList[a[u+2]])}},n}()}(e.MarchingCubes||(e.MarchingCubes={}))}(t.Geometry||(t.Geometry={}))}(t.Core||(t.Core={}))}(o||(o={}));var o;!function(t){!function(t){!function(t){!function(t){var e=function(){function t(t,e,n){this.i=0|t,this.j=0|e,this.k=0|n}return t}();t.Index=e;var n=function(){function t(t,e){this.a=t,this.b=e}return t}();t.IndexPair=n,t.EdgesXY=[[],[0,3],[0,1],[1,3],[1,2],[0,1,1,2,2,3,0,3],[0,2],[2,3],[2,3],[0,2],[0,1,1,2,2,3,0,3],[1,2],[1,3],[0,1],[0,3],[]],t.EdgesXZ=[[],[0,8],[0,9],[9,8],[9,4],[0,9,9,4,4,8,0,8],[0,4],[4,8],[4,8],[0,4],[0,9,9,4,4,8,0,8],[9,4],[9,8],[0,9],[0,8],[]],t.EdgesYZ=[[],[3,8],[3,11],[11,8],[11,7],[3,11,11,7,7,8,3,8],[3,7],[7,8],[7,8],[3,7],[3,11,11,7,7,8,3,8],[11,7],[11,8],[3,11],[3,8],[]],t.CubeVertices=[new e(0,0,0),new e(1,0,0),new e(1,1,0),new e(0,1,0),new e(0,0,1),new e(1,0,1),new e(1,1,1),new e(0,1,1)],t.CubeEdges=[new n(t.CubeVertices[0],t.CubeVertices[1]),new n(t.CubeVertices[1],t.CubeVertices[2]),new n(t.CubeVertices[2],t.CubeVertices[3]),new n(t.CubeVertices[3],t.CubeVertices[0]),new n(t.CubeVertices[4],t.CubeVertices[5]),new n(t.CubeVertices[5],t.CubeVertices[6]),new n(t.CubeVertices[6],t.CubeVertices[7]),new n(t.CubeVertices[7],t.CubeVertices[4]),new n(t.CubeVertices[0],t.CubeVertices[4]),new n(t.CubeVertices[1],t.CubeVertices[5]),new n(t.CubeVertices[2],t.CubeVertices[6]),new n(t.CubeVertices[3],t.CubeVertices[7])],t.EdgeIdInfo=[{i:0,j:0,k:0,e:0},{i:1,j:0,k:0,e:1},{i:0,j:1,k:0,e:0},{i:0,j:0,k:0,e:1},{i:0,j:0,k:1,e:0},{i:1,j:0,k:1,e:1},{i:0,j:1,k:1,e:0},{i:0,j:0,k:1,e:1},{i:0,j:0,k:0,e:2},{i:1,j:0,k:0,e:2},{i:1,j:1,k:0,e:2},{i:0,j:1,k:0,e:2}],t.EdgeTable=[0,265,515,778,1030,1295,1541,1804,2060,2309,2575,2822,3082,3331,3593,3840,400,153,915,666,1430,1183,1941,1692,2460,2197,2975,2710,3482,3219,3993,3728,560,825,51,314,1590,1855,1077,1340,2620,2869,2111,2358,3642,3891,3129,3376,928,681,419,170,1958,1711,1445,1196,2988,2725,2479,2214,4010,3747,3497,3232,1120,1385,1635,1898,102,367,613,876,3180,3429,3695,3942,2154,2403,2665,2912,1520,1273,2035,1786,502,255,1013,764,3580,3317,4095,3830,2554,2291,3065,2800,1616,1881,1107,1370,598,863,85,348,3676,3925,3167,3414,2650,2899,2137,2384,1984,1737,1475,1226,966,719,453,204,4044,3781,3535,3270,3018,2755,2505,2240,2240,2505,2755,3018,3270,3535,3781,4044,204,453,719,966,1226,1475,1737,1984,2384,2137,2899,2650,3414,3167,3925,3676,348,85,863,598,1370,1107,1881,1616,2800,3065,2291,2554,3830,4095,3317,3580,764,1013,255,502,1786,2035,1273,1520,2912,2665,2403,2154,3942,3695,3429,3180,876,613,367,102,1898,1635,1385,1120,3232,3497,3747,4010,2214,2479,2725,2988,1196,1445,1711,1958,170,419,681,928,3376,3129,3891,3642,2358,2111,2869,2620,1340,1077,1855,1590,314,51,825,560,3728,3993,3219,3482,2710,2975,2197,2460,1692,1941,1183,1430,666,915,153,400,3840,3593,3331,3082,2822,2575,2309,2060,1804,1541,1295,1030,778,515,265,0],t.TriTable=[[],[0,8,3],[0,1,9],[1,8,3,9,8,1],[1,2,10],[0,8,3,1,2,10],[9,2,10,0,2,9],[2,8,3,2,10,8,10,9,8],[3,11,2],[0,11,2,8,11,0],[1,9,0,2,3,11],[1,11,2,1,9,11,9,8,11],[3,10,1,11,10,3],[0,10,1,0,8,10,8,11,10],[3,9,0,3,11,9,11,10,9],[9,8,10,10,8,11],[4,7,8],[4,3,0,7,3,4],[0,1,9,8,4,7],[4,1,9,4,7,1,7,3,1],[1,2,10,8,4,7],[3,4,7,3,0,4,1,2,10],[9,2,10,9,0,2,8,4,7],[2,10,9,2,9,7,2,7,3,7,9,4],[8,4,7,3,11,2],[11,4,7,11,2,4,2,0,4],[9,0,1,8,4,7,2,3,11],[4,7,11,9,4,11,9,11,2,9,2,1],[3,10,1,3,11,10,7,8,4],[1,11,10,1,4,11,1,0,4,7,11,4],[4,7,8,9,0,11,9,11,10,11,0,3],[4,7,11,4,11,9,9,11,10],[9,5,4],[9,5,4,0,8,3],[0,5,4,1,5,0],[8,5,4,8,3,5,3,1,5],[1,2,10,9,5,4],[3,0,8,1,2,10,4,9,5],[5,2,10,5,4,2,4,0,2],[2,10,5,3,2,5,3,5,4,3,4,8],[9,5,4,2,3,11],[0,11,2,0,8,11,4,9,5],[0,5,4,0,1,5,2,3,11],[2,1,5,2,5,8,2,8,11,4,8,5],[10,3,11,10,1,3,9,5,4],[4,9,5,0,8,1,8,10,1,8,11,10],[5,4,0,5,0,11,5,11,10,11,0,3],[5,4,8,5,8,10,10,8,11],[9,7,8,5,7,9],[9,3,0,9,5,3,5,7,3],[0,7,8,0,1,7,1,5,7],[1,5,3,3,5,7],[9,7,8,9,5,7,10,1,2],[10,1,2,9,5,0,5,3,0,5,7,3],[8,0,2,8,2,5,8,5,7,10,5,2],[2,10,5,2,5,3,3,5,7],[7,9,5,7,8,9,3,11,2],[9,5,7,9,7,2,9,2,0,2,7,11],[2,3,11,0,1,8,1,7,8,1,5,7],[11,2,1,11,1,7,7,1,5],[9,5,8,8,5,7,10,1,3,10,3,11],[5,7,0,5,0,9,7,11,0,1,0,10,11,10,0],[11,10,0,11,0,3,10,5,0,8,0,7,5,7,0],[11,10,5,7,11,5],[10,6,5],[0,8,3,5,10,6],[9,0,1,5,10,6],[1,8,3,1,9,8,5,10,6],[1,6,5,2,6,1],[1,6,5,1,2,6,3,0,8],[9,6,5,9,0,6,0,2,6],[5,9,8,5,8,2,5,2,6,3,2,8],[2,3,11,10,6,5],[11,0,8,11,2,0,10,6,5],[0,1,9,2,3,11,5,10,6],[5,10,6,1,9,2,9,11,2,9,8,11],[6,3,11,6,5,3,5,1,3],[0,8,11,0,11,5,0,5,1,5,11,6],[3,11,6,0,3,6,0,6,5,0,5,9],[6,5,9,6,9,11,11,9,8],[5,10,6,4,7,8],[4,3,0,4,7,3,6,5,10],[1,9,0,5,10,6,8,4,7],[10,6,5,1,9,7,1,7,3,7,9,4],[6,1,2,6,5,1,4,7,8],[1,2,5,5,2,6,3,0,4,3,4,7],[8,4,7,9,0,5,0,6,5,0,2,6],[7,3,9,7,9,4,3,2,9,5,9,6,2,6,9],[3,11,2,7,8,4,10,6,5],[5,10,6,4,7,2,4,2,0,2,7,11],[0,1,9,4,7,8,2,3,11,5,10,6],[9,2,1,9,11,2,9,4,11,7,11,4,5,10,6],[8,4,7,3,11,5,3,5,1,5,11,6],[5,1,11,5,11,6,1,0,11,7,11,4,0,4,11],[0,5,9,0,6,5,0,3,6,11,6,3,8,4,7],[6,5,9,6,9,11,4,7,9,7,11,9],[10,4,9,6,4,10],[4,10,6,4,9,10,0,8,3],[10,0,1,10,6,0,6,4,0],[8,3,1,8,1,6,8,6,4,6,1,10],[1,4,9,1,2,4,2,6,4],[3,0,8,1,2,9,2,4,9,2,6,4],[0,2,4,4,2,6],[8,3,2,8,2,4,4,2,6],[10,4,9,10,6,4,11,2,3],[0,8,2,2,8,11,4,9,10,4,10,6],[3,11,2,0,1,6,0,6,4,6,1,10],[6,4,1,6,1,10,4,8,1,2,1,11,8,11,1],[9,6,4,9,3,6,9,1,3,11,6,3],[8,11,1,8,1,0,11,6,1,9,1,4,6,4,1],[3,11,6,3,6,0,0,6,4],[6,4,8,11,6,8],[7,10,6,7,8,10,8,9,10],[0,7,3,0,10,7,0,9,10,6,7,10],[10,6,7,1,10,7,1,7,8,1,8,0],[10,6,7,10,7,1,1,7,3],[1,2,6,1,6,8,1,8,9,8,6,7],[2,6,9,2,9,1,6,7,9,0,9,3,7,3,9],[7,8,0,7,0,6,6,0,2],[7,3,2,6,7,2],[2,3,11,10,6,8,10,8,9,8,6,7],[2,0,7,2,7,11,0,9,7,6,7,10,9,10,7],[1,8,0,1,7,8,1,10,7,6,7,10,2,3,11],[11,2,1,11,1,7,10,6,1,6,7,1],[8,9,6,8,6,7,9,1,6,11,6,3,1,3,6],[0,9,1,11,6,7],[7,8,0,7,0,6,3,11,0,11,6,0],[7,11,6],[7,6,11],[3,0,8,11,7,6],[0,1,9,11,7,6],[8,1,9,8,3,1,11,7,6],[10,1,2,6,11,7],[1,2,10,3,0,8,6,11,7],[2,9,0,2,10,9,6,11,7],[6,11,7,2,10,3,10,8,3,10,9,8],[7,2,3,6,2,7],[7,0,8,7,6,0,6,2,0],[2,7,6,2,3,7,0,1,9],[1,6,2,1,8,6,1,9,8,8,7,6],[10,7,6,10,1,7,1,3,7],[10,7,6,1,7,10,1,8,7,1,0,8],[0,3,7,0,7,10,0,10,9,6,10,7],[7,6,10,7,10,8,8,10,9],[6,8,4,11,8,6],[3,6,11,3,0,6,0,4,6],[8,6,11,8,4,6,9,0,1],[9,4,6,9,6,3,9,3,1,11,3,6],[6,8,4,6,11,8,2,10,1],[1,2,10,3,0,11,0,6,11,0,4,6],[4,11,8,4,6,11,0,2,9,2,10,9],[10,9,3,10,3,2,9,4,3,11,3,6,4,6,3],[8,2,3,8,4,2,4,6,2],[0,4,2,4,6,2],[1,9,0,2,3,4,2,4,6,4,3,8],[1,9,4,1,4,2,2,4,6],[8,1,3,8,6,1,8,4,6,6,10,1],[10,1,0,10,0,6,6,0,4],[4,6,3,4,3,8,6,10,3,0,3,9,10,9,3],[10,9,4,6,10,4],[4,9,5,7,6,11],[0,8,3,4,9,5,11,7,6],[5,0,1,5,4,0,7,6,11],[11,7,6,8,3,4,3,5,4,3,1,5],[9,5,4,10,1,2,7,6,11],[6,11,7,1,2,10,0,8,3,4,9,5],[7,6,11,5,4,10,4,2,10,4,0,2],[3,4,8,3,5,4,3,2,5,10,5,2,11,7,6],[7,2,3,7,6,2,5,4,9],[9,5,4,0,8,6,0,6,2,6,8,7],[3,6,2,3,7,6,1,5,0,5,4,0],[6,2,8,6,8,7,2,1,8,4,8,5,1,5,8],[9,5,4,10,1,6,1,7,6,1,3,7],[1,6,10,1,7,6,1,0,7,8,7,0,9,5,4],[4,0,10,4,10,5,0,3,10,6,10,7,3,7,10],[7,6,10,7,10,8,5,4,10,4,8,10],[6,9,5,6,11,9,11,8,9],[3,6,11,0,6,3,0,5,6,0,9,5],[0,11,8,0,5,11,0,1,5,5,6,11],[6,11,3,6,3,5,5,3,1],[1,2,10,9,5,11,9,11,8,11,5,6],[0,11,3,0,6,11,0,9,6,5,6,9,1,2,10],[11,8,5,11,5,6,8,0,5,10,5,2,0,2,5],[6,11,3,6,3,5,2,10,3,10,5,3],[5,8,9,5,2,8,5,6,2,3,8,2],[9,5,6,9,6,0,0,6,2],[1,5,8,1,8,0,5,6,8,3,8,2,6,2,8],[1,5,6,2,1,6],[1,3,6,1,6,10,3,8,6,5,6,9,8,9,6],[10,1,0,10,0,6,9,5,0,5,6,0],[0,3,8,5,6,10],[10,5,6],[11,5,10,7,5,11],[11,5,10,11,7,5,8,3,0],[5,11,7,5,10,11,1,9,0],[10,7,5,10,11,7,9,8,1,8,3,1],[11,1,2,11,7,1,7,5,1],[0,8,3,1,2,7,1,7,5,7,2,11],[9,7,5,9,2,7,9,0,2,2,11,7],[7,5,2,7,2,11,5,9,2,3,2,8,9,8,2],[2,5,10,2,3,5,3,7,5],[8,2,0,8,5,2,8,7,5,10,2,5],[9,0,1,5,10,3,5,3,7,3,10,2],[9,8,2,9,2,1,8,7,2,10,2,5,7,5,2],[1,3,5,3,7,5],[0,8,7,0,7,1,1,7,5],[9,0,3,9,3,5,5,3,7],[9,8,7,5,9,7],[5,8,4,5,10,8,10,11,8],[5,0,4,5,11,0,5,10,11,11,3,0],[0,1,9,8,4,10,8,10,11,10,4,5],[10,11,4,10,4,5,11,3,4,9,4,1,3,1,4],[2,5,1,2,8,5,2,11,8,4,5,8],[0,4,11,0,11,3,4,5,11,2,11,1,5,1,11],[0,2,5,0,5,9,2,11,5,4,5,8,11,8,5],[9,4,5,2,11,3],[2,5,10,3,5,2,3,4,5,3,8,4],[5,10,2,5,2,4,4,2,0],[3,10,2,3,5,10,3,8,5,4,5,8,0,1,9],[5,10,2,5,2,4,1,9,2,9,4,2],[8,4,5,8,5,3,3,5,1],[0,4,5,1,0,5],[8,4,5,8,5,3,9,0,5,0,3,5],[9,4,5],[4,11,7,4,9,11,9,10,11],[0,8,3,4,9,7,9,11,7,9,10,11],[1,10,11,1,11,4,1,4,0,7,4,11],[3,1,4,3,4,8,1,10,4,7,4,11,10,11,4],[4,11,7,9,11,4,9,2,11,9,1,2],[9,7,4,9,11,7,9,1,11,2,11,1,0,8,3],[11,7,4,11,4,2,2,4,0],[11,7,4,11,4,2,8,3,4,3,2,4],[2,9,10,2,7,9,2,3,7,7,4,9],[9,10,7,9,7,4,10,2,7,8,7,0,2,0,7],[3,7,10,3,10,2,7,4,10,1,10,0,4,0,10],[1,10,2,8,7,4],[4,9,1,4,1,7,7,1,3],[4,9,1,4,1,7,0,8,1,8,7,1],[4,0,3,7,4,3],[4,8,7],[9,10,8,10,11,8],[3,0,9,3,9,11,11,9,10],[0,1,10,0,10,8,8,10,11],[3,1,10,11,3,10],[1,2,11,1,11,9,9,11,8],[3,0,9,3,9,11,1,2,9,2,11,9],[0,2,11,8,0,11],[3,2,11],[2,3,8,2,8,10,10,8,9],[9,10,2,0,9,2],[2,3,8,2,8,10,0,1,8,1,10,8],[1,10,2],[1,3,8,9,1,8],[0,9,1],[0,3,8],[]]}(t.MarchingCubes||(t.MarchingCubes={}))}(t.Geometry||(t.Geometry={}))}(t.Core||(t.Core={}))}(o||(o={}));var o;!function(t){!function(t){!function(e){!function(n){function r(e){var n=this;return t.computation(function(t){return s(n,void 0,void 0,function(){var n;return a(this,function(r){switch(r.label){case 0:return n=new u(e,t),[4,n.run()];case 1:return[2,r.sent()]}})})})}function i(n){var i=this;return t.computation(function(t){return s(i,void 0,void 0,function(){var i,o,s,u;return a(this,function(a){switch(a.label){case 0:return[4,r(n).run(t)];case 1:return i=a.sent(),[4,e.MarchingCubes.compute(i.data).run(t)];case 2:return o=a.sent(),[4,e.Surface.transform(o,i.transform).run(t)];case 3:return o=a.sent(),s=n.parameters&&n.parameters.smoothingIterations||1,u=1,n.parameters&&n.parameters.density<1&&(u=2/n.parameters.density),[4,e.Surface.laplacianSmooth(o,s,u).run(t)];case 4:return o=a.sent(),[2,{surface:o,usedParameters:i.parameters}]}})})})}var o=function(){function e(e){t.Utils.extend(this,e,{exactBoundary:!1,boundaryDelta:{dx:1.5,dy:1.5,dz:1.5},probeRadius:1.4,atomRadii:function(){return 1},density:1.1,interactive:!1,smoothingIterations:1}),this.exactBoundary&&(this.boundaryDelta={dx:0,dy:0,dz:0}),this.density<.05&&(this.density=.05)}return e}(),u=function(){function n(t,e){this.inputParameters=t,this.ctx=e,this.minX=Number.MAX_VALUE,this.minY=Number.MAX_VALUE,this.minZ=Number.MAX_VALUE,this.maxX=-Number.MAX_VALUE,this.maxY=-Number.MAX_VALUE,this.maxZ=-Number.MAX_VALUE,this.nX=0,this.nY=0,this.nZ=0,this.dX=.1,this.dY=.1,this.dZ=.1,this.field=new Float32Array(0),this.distanceField=new Float32Array(0),this.proximityMap=new Int32Array(0),this.minIndex={i:0,j:0,k:0},this.maxIndex={i:0,j:0,k:0},this.parameters=new o(t.parameters);var n=t.positions;this.x=n.x,this.y=n.y,this.z=n.z,this.atomIndices=t.atomIndices,this.parameters.density>=.99?this.vdwScaleFactor=1.000000001:this.vdwScaleFactor=1-this.parameters.density*this.parameters.density+1}return n.prototype.findBounds=function(){for(var t=0,e=this.atomIndices;t<e.length;t++){var n=e[t],r=this.parameters.exactBoundary?0:this.vdwScaleFactor*this.parameters.atomRadius(n)+this.parameters.probeRadius,i=this.x[n],o=this.y[n],s=this.z[n];r<0||(this.minX=Math.min(this.minX,i-r),this.minY=Math.min(this.minY,o-r),this.minZ=Math.min(this.minZ,s-r),this.maxX=Math.max(this.maxX,i+r),this.maxY=Math.max(this.maxY,o+r),this.maxZ=Math.max(this.maxZ,s+r))}this.minX===Number.MAX_VALUE&&(this.minX=this.minY=this.minZ=-1,this.maxX=this.maxY=this.maxZ=1),this.minX-=this.parameters.boundaryDelta.dx,this.minY-=this.parameters.boundaryDelta.dy,this.minZ-=this.parameters.boundaryDelta.dz,this.maxX+=this.parameters.boundaryDelta.dx,this.maxY+=this.parameters.boundaryDelta.dy,this.maxZ+=this.parameters.boundaryDelta.dz,this.nX=Math.floor((this.maxX-this.minX)*this.parameters.density),this.nY=Math.floor((this.maxY-this.minY)*this.parameters.density),this.nZ=Math.floor((this.maxZ-this.minZ)*this.parameters.density),this.nX=Math.min(this.nX,333),this.nY=Math.min(this.nY,333),this.nZ=Math.min(this.nZ,333),this.dX=(this.maxX-this.minX)/(this.nX-1),this.dY=(this.maxY-this.minY)/(this.nY-1),this.dZ=(this.maxZ-this.minZ)/(this.nZ-1)},n.prototype.initData=function(){var t=this.nX*this.nY*this.nZ;this.field=new Float32Array(t),this.distanceField=new Float32Array(t),this.proximityMap=new Int32Array(t);for(var e=Number.POSITIVE_INFINITY,n=0,r=this.proximityMap.length;n<r;n++)this.distanceField[n]=e,this.proximityMap[n]=-1},n.prototype.updateMinIndex=function(t,e,n){this.minIndex.i=Math.max(0|Math.floor((t-this.minX)/this.dX),0),this.minIndex.j=Math.max(0|Math.floor((e-this.minY)/this.dY),0),this.minIndex.k=Math.max(0|Math.floor((n-this.minZ)/this.dZ),0)},n.prototype.updateMaxIndex=function(t,e,n){this.maxIndex.i=Math.min(0|Math.ceil((t-this.minX)/this.dX),this.nX),this.maxIndex.j=Math.min(0|Math.ceil((e-this.minY)/this.dY),this.nY),this.maxIndex.k=Math.min(0|Math.ceil((n-this.minZ)/this.dZ),this.nZ)},n.prototype.addBall=function(t,e){var n=e*e,r=this.x[t],i=this.y[t],o=this.z[t];this.updateMinIndex(r-e,i-e,o-e),this.updateMaxIndex(r+e,i+e,o+e);var s=this.minIndex.i,a=this.minIndex.j,u=this.minIndex.k,c=this.maxIndex.i,h=this.maxIndex.j,f=this.maxIndex.k;r=this.minX-r,i=this.minY-i,o=this.minZ-o;for(var d=u;d<f;d++)for(var l=o+d*this.dZ,p=l*l,m=d*this.nY,y=a;y<h;y++)for(var g=i+y*this.dY,v=p+g*g,b=this.nX*(m+y),_=s;_<c;_++){var w=r+_*this.dX,x=v+w*w,C=b+_,I=n/(1e-6+x)-1;x<this.distanceField[C]&&(this.proximityMap[C]=t,this.distanceField[C]=x),I>0&&(this.field[C]+=I)}},n.prototype.processChunks=function(){return s(this,void 0,void 0,function(){var e,n,r,i,o,s,u;return a(this,function(a){switch(a.label){case 0:return e=1e4,n=t.Utils.PerformanceMonitor.currentTime(),[4,this.ctx.updateProgress("Creating field...",!0)];case 1:a.sent(),r=0,i=this.atomIndices.length,a.label=2;case 2:return r<i?(o=this.atomIndices[r],s=this.vdwScaleFactor*this.parameters.atomRadius(o)+this.parameters.probeRadius,s>=0&&this.addBall(o,s),(r+1)%e!=0?[3,4]:(u=t.Utils.PerformanceMonitor.currentTime())-n>t.Computation.UpdateProgressDelta?(n=u,[4,this.ctx.updateProgress("Creating field...",!0,r,i)]):[3,4]):[3,5];case 3:a.sent(),a.label=4;case 4:return r++,[3,2];case 5:return[2]}})})},n.prototype.finish=function(){var n=e.LinearAlgebra.Matrix4.empty();e.LinearAlgebra.Matrix4.fromTranslation(n,[this.minX,this.minY,this.minZ]),n[0]=this.dX,n[5]=this.dY,n[10]=this.dZ;var r={data:{scalarField:new t.Formats.Density.Field3DZYX(this.field,[this.nX,this.nY,this.nZ]),annotationField:this.parameters.interactive?new t.Formats.Density.Field3DZYX(this.proximityMap,[this.nX,this.nY,this.nZ]):void 0,isoLevel:.05},bottomLeft:{x:this.minX,y:this.minY,z:this.minZ},topRight:{x:this.maxX,y:this.maxY,z:this.maxZ},transform:n,inputParameters:this.inputParameters,parameters:this.parameters};return this.distanceField=null,this.proximityMap=null,r},n.prototype.run=function(){return s(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,this.ctx.updateProgress("Initializing...")];case 1:return t.sent(),this.findBounds(),this.initData(),[4,this.processChunks()];case 2:return t.sent(),[4,this.ctx.updateProgress("Finalizing...",void 0,this.atomIndices.length,this.atomIndices.length)];case 3:return t.sent(),[2,this.finish()]}})})},n}();n.createMolecularIsoFieldAsync=r,n.computeMolecularSurfaceAsync=i}(e.MolecularSurface||(e.MolecularSurface={}))}(t.Geometry||(t.Geometry={}))}(t.Core||(t.Core={}))}(o||(o={}));var o;!function(t){!function(t){!function(e){var n=t.Utils.DataTable,r=function(){function e(e){this.id=e,this.map=t.Utils.FastMap.create()}return e.prototype.add=function(e,n,r,i){void 0===i&&(i=!0);var o=this.map.get(e);if(void 0!==o){void 0===o.get(n)&&o.set(n,r)}else{var s=t.Utils.FastMap.create();s.set(n,r),this.map.set(e,s)}i&&this.add(n,e,r,!1)},e}();e.ComponentBondInfoEntry=r;var i=function(){function e(){this.entries=t.Utils.FastMap.create()}return e.prototype.newEntry=function(t){var e=new r(t);return this.entries.set(t,e),e},e}();e.ComponentBondInfo=i;var o=function(){function t(t,e,n){this.asymId=t,this.seqNumber=e,this.insCode=n}return t.areEqual=function(t,e,n,r,i){return t.asymId===n[e]&&t.seqNumber===r[e]&&t.insCode===i[e]},t.compare=function(t,e){return t.asymId===e.asymId?t.seqNumber===e.seqNumber?t.insCode===e.insCode?0:void 0===t.insCode?-1:void 0===e.insCode?1:t.insCode<e.insCode?-1:1:t.seqNumber<e.seqNumber?-1:1:t.asymId<e.asymId?-1:1},t.compareResidue=function(t,e,n,r,i){return t.asymId===n[e]?t.seqNumber===r[e]?t.insCode===i[e]?0:void 0===t.insCode?-1:void 0===i[e]?1:t.insCode<i[e]?-1:1:t.seqNumber<r[e]?-1:1:t.asymId<n[e]?-1:1},t}();e.PolyResidueIdentifier=o;var s=function(){function t(t,e,n,r){void 0===r&&(r={}),this.type=t,this.startResidueId=e,this.endResidueId=n,this.info=r,this.startResidueIndex=-1,this.endResidueIndex=-1}return Object.defineProperty(t.prototype,"length",{get:function(){return this.endResidueIndex-this.startResidueIndex},enumerable:!0,configurable:!0}),t}();e.SecondaryStructureElement=s;var a=function(){function t(t,e,n,r,i){this.spacegroupName=t,this.cellSize=e,this.cellAngles=n,this.toFracTransform=r,this.isNonStandardCrytalFrame=i}return t}();e.SymmetryInfo=a;var u=function(){function t(t,e,n){this.id=t,this.name=e,this.operator=n}return t}();e.AssemblyOperator=u;var c=function(){function t(t,e){this.operators=t,this.asymIds=e}return t}();e.AssemblyGenEntry=c;var h=function(){function t(t){this.name=t,this.gens=[]}return t}();e.AssemblyGen=h;var f=function(){function t(t,e){this.operators=t,this.assemblies=e}return t}();e.AssemblyInfo=f;!function(t){var e=n.typedColumn(Int32Array),r=n.typedColumn(Float32Array),i=n.stringColumn,o=n.stringNullColumn;t.Positions={x:r,y:r,z:r},t.Atoms={id:e,altLoc:i,residueIndex:e,chainIndex:e,entityIndex:e,name:i,elementSymbol:i,occupancy:r,tempFactor:r,authName:i,rowIndex:e},t.Residues={name:i,seqNumber:e,asymId:i,authName:i,authSeqNumber:e,authAsymId:i,insCode:o,entityId:i,isHet:n.typedColumn(Int8Array),atomStartIndex:e,atomEndIndex:e,chainIndex:e,entityIndex:e,secondaryStructureIndex:e},t.Chains={asymId:i,entityId:i,authAsymId:i,atomStartIndex:e,atomEndIndex:e,residueStartIndex:e,residueEndIndex:e,entityIndex:e,sourceChainIndex:void 0,operatorIndex:void 0},t.Entities={entityId:i,type:n.customColumn(),atomStartIndex:e,atomEndIndex:e,residueStartIndex:e,residueEndIndex:e,chainStartIndex:e,chainEndIndex:e},t.Bonds={atomAIndex:e,atomBIndex:e,type:n.typedColumn(Int8Array)}}(e.Tables||(e.Tables={}));var d=function(){function e(t,e,n){this.matrix=t,this.id=e,this.isIdentity=n}return e.prototype.apply=function(e){t.Geometry.LinearAlgebra.Matrix4.transformVector3(e,e,this.matrix)},e.applyToModelUnsafe=function(e,n){for(var r={x:.1,y:.1,z:.1},i=n.positions,o=i.x,s=i.y,a=i.z,u=0,c=n.positions.count;u<c;u++)r.x=o[u],r.y=s[u],r.z=a[u],t.Geometry.LinearAlgebra.Matrix4.transformVector3(r,r,e),o[u]=r.x,s[u]=r.y,a[u]=r.z},e}();e.Operator=d;!function(n){function r(t,e,n){return void 0===n&&(n={}),{id:t,models:e,properties:n}}n.create=r;!function(n){function r(n){var r=t.Utils.extend({},n),i=void 0;return Object.defineProperty(r,"queryContext",{enumerable:!0,configurable:!1,get:function(){return i?i:i=e.Query.Context.ofStructure(r)}}),r}function i(t,e,n){for(var i=t.positions,o=i.x,s=i.y,a=i.z,u=t.positions.getBuilder(t.positions.count).seal(),c=u.x,h=u.y,f=u.z,d={x:0,y:0,z:0},l=0,p=t.positions.count;l<p;l++)n(e,o[l],s[l],a[l],d),c[l]=d.x,h[l]=d.y,f[l]=d.z;return r({id:t.id,modelId:t.modelId,data:t.data,positions:u,parent:t.parent,source:t.source,operators:t.operators})}n.create=r;!function(t){t[t.File=0]="File",t[t.Computed=1]="Computed"}(n.Source||(n.Source={})),n.withTransformedXYZ=i}(n.Model||(n.Model={}))}(e.Molecule||(e.Molecule={}))}(t.Structure||(t.Structure={}))}(t.Core||(t.Core={}))}(o||(o={}));var o;!function(t){!function(t){!function(e){var n=t.Geometry.LinearAlgebra.Matrix4,r=t.Geometry.LinearAlgebra.Vector4,i=function(){function t(t){if(this.info=t,this.temp=n.empty(),this.tempV=new Float64Array(4),void 0===o.Spacegroup[t.spacegroupName])throw"'"+t.spacegroupName+"' is not a spacegroup recognized by the library.";this.space=this.getSpace(),this.operators=this.getOperators()}return Object.defineProperty(t.prototype,"operatorCount",{get:function(){return this.operators.length},enumerable:!0,configurable:!0}),t.prototype.getOperatorMatrix=function(t,e,r,i,o){return this.tempV[0]=e,this.tempV[1]=r,this.tempV[2]=i,n.fromTranslation(this.temp,this.tempV),n.mul(o,n.mul(o,n.mul(o,this.space.fromFrac,this.temp),this.operators[t]),this.space.toFrac),o},t.prototype.getSpace=function(){var t=this.info.toFracTransform,e=n.empty();return n.invert(e,t),{toFrac:t,fromFrac:e,baseX:r.transform(r.create(),r.fromValues(1,0,0,1),t),baseY:r.transform(r.create(),r.fromValues(0,1,0,1),t),baseZ:r.transform(r.create(),r.fromValues(0,0,1,1),t)}},t.getOperator=function(t){var e=o.Transform[t[0]],r=o.Transform[t[1]],i=o.Transform[t[2]];return n.ofRows([e,r,i,[0,0,0,1]])},t.prototype.getOperators=function(){return o.Group[o.Spacegroup[this.info.spacegroupName]].map(function(e){return t.getOperator(o.Operator[e])})},t}();e.Spacegroup=i;var o;!function(t){t.Transform=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[-1,0,0,0],[0,-1,0,0],[0,0,-1,0],[0,1,0,.5],[1,0,0,.5],[-1,0,0,.5],[0,0,1,.5],[0,-1,0,.5],[0,0,-1,.5],[1,0,0,.25],[0,-1,0,.25],[0,0,1,.25],[-1,0,0,.25],[0,1,0,.25],[0,-1,0,.75],[0,0,1,.75],[0,1,0,.75],[1,0,0,.75],[-1,0,0,.75],[0,0,-1,.25],[0,0,-1,.75],[1,-1,0,0],[-1,1,0,0],[0,0,1,.333333333333333],[0,0,1,.666666666666667],[1,0,0,.666666666666667],[0,1,0,.333333333333333],[0,-1,0,.666666666666667],[1,-1,0,.333333333333333],[-1,1,0,.666666666666667],[-1,0,0,.333333333333333],[1,0,0,.333333333333333],[0,1,0,.666666666666667],[0,-1,0,.333333333333333],[1,-1,0,.666666666666667],[-1,1,0,.333333333333333],[-1,0,0,.666666666666667],[0,0,-1,.333333333333333],[0,0,-1,.666666666666667],[0,0,1,.833333333333333],[0,0,1,.166666666666667],[0,0,-1,.833333333333333],[0,0,-1,.166666666666667]],
t.Operator=[[0,1,2],[3,4,5],[3,1,5],[3,6,5],[7,6,2],[8,6,5],[0,4,2],[0,4,9],[7,10,2],[7,10,9],[0,10,2],[8,10,5],[3,1,11],[3,6,11],[0,10,9],[8,6,11],[3,4,2],[0,4,5],[3,4,9],[7,10,5],[8,4,9],[8,10,9],[8,10,2],[0,6,9],[3,10,9],[0,10,11],[7,1,9],[8,1,11],[7,4,11],[7,6,9],[7,10,11],[3,10,2],[8,1,5],[0,4,11],[3,1,2],[3,1,9],[7,4,2],[8,1,2],[8,1,9],[3,6,9],[7,4,9],[8,6,2],[8,6,9],[3,6,2],[12,13,14],[15,16,14],[12,17,18],[15,19,18],[20,13,18],[21,16,18],[20,17,14],[21,19,14],[0,1,5],[8,10,11],[7,6,11],[7,6,5],[8,4,2],[7,4,5],[7,1,5],[7,1,11],[0,10,5],[0,1,11],[0,6,11],[0,6,5],[3,10,11],[8,4,11],[15,13,22],[12,16,22],[15,17,23],[12,19,23],[21,13,23],[20,16,23],[21,17,22],[20,19,22],[4,0,2],[1,3,2],[4,0,14],[1,3,18],[4,0,9],[1,3,9],[4,0,18],[1,3,14],[10,7,9],[6,8,9],[4,7,14],[6,3,18],[10,0,18],[1,8,14],[1,3,5],[4,0,5],[6,8,11],[10,7,11],[1,3,11],[4,0,11],[10,7,2],[6,8,2],[3,10,22],[7,1,23],[8,4,23],[0,6,22],[1,0,5],[4,3,5],[1,0,23],[4,3,22],[10,7,14],[6,8,18],[8,6,22],[7,10,23],[4,3,11],[1,0,11],[1,0,22],[4,3,23],[10,7,18],[6,8,14],[8,6,23],[7,10,22],[6,7,11],[10,8,11],[8,1,23],[0,10,22],[3,6,22],[7,4,23],[4,3,2],[1,0,2],[10,8,2],[6,7,2],[4,3,9],[1,0,9],[10,8,9],[6,7,9],[4,8,14],[6,0,18],[10,3,18],[1,7,14],[4,8,18],[6,0,14],[10,3,14],[1,7,18],[6,7,5],[10,8,5],[6,8,5],[10,7,5],[8,1,22],[0,10,23],[3,6,23],[7,4,22],[4,24,2],[25,3,2],[4,24,26],[25,3,27],[4,24,27],[25,3,26],[28,29,26],[30,31,26],[32,33,26],[34,35,27],[36,37,27],[38,39,27],[2,0,1],[1,2,0],[1,25,5],[24,0,5],[39,36,40],[35,38,40],[37,34,40],[33,30,41],[29,32,41],[31,28,41],[5,3,4],[4,5,3],[25,1,5],[0,24,5],[24,4,5],[3,25,5],[4,3,41],[25,1,40],[24,4,41],[3,25,40],[4,3,40],[25,1,41],[24,4,40],[3,25,41],[35,34,40],[37,36,40],[39,38,40],[29,28,41],[31,30,41],[33,32,41],[3,5,4],[5,4,3],[25,1,2],[0,24,2],[24,4,2],[3,25,2],[25,1,9],[0,24,9],[24,4,9],[3,25,9],[30,33,26],[32,29,26],[28,31,26],[36,39,27],[38,35,27],[34,37,27],[0,2,1],[2,1,0],[30,33,42],[32,29,42],[28,31,42],[36,39,43],[38,35,43],[34,37,43],[7,9,6],[9,6,7],[25,1,11],[0,24,11],[24,4,11],[3,25,11],[35,34,44],[37,36,44],[39,38,44],[29,28,45],[31,30,45],[33,32,45],[8,11,10],[11,10,8],[1,25,2],[24,0,2],[1,25,42],[24,0,43],[1,25,43],[24,0,42],[1,25,27],[24,0,26],[1,25,26],[24,0,27],[1,25,9],[24,0,9],[4,24,5],[25,3,5],[4,24,11],[25,3,11],[1,0,40],[4,3,44],[0,24,45],[1,0,41],[4,3,45],[0,24,44],[0,24,40],[0,24,41],[2,3,4],[5,3,1],[5,0,4],[4,2,3],[1,5,3],[4,5,0],[2,7,6],[2,8,10],[5,8,6],[5,7,10],[1,9,7],[4,9,8],[1,11,8],[4,11,7],[9,0,6],[9,3,10],[11,3,6],[11,0,10],[6,2,7],[10,2,8],[6,5,8],[10,5,7],[9,7,1],[9,8,4],[11,8,1],[11,7,4],[6,9,0],[10,9,3],[6,11,3],[10,11,0],[9,7,6],[9,8,10],[11,8,6],[11,7,10],[6,9,7],[10,9,8],[6,11,8],[10,11,7],[2,3,10],[5,8,1],[11,0,4],[10,2,3],[1,5,8],[4,11,0],[5,0,1],[2,0,4],[2,3,1],[1,5,0],[4,2,0],[1,2,3],[11,8,10],[11,7,6],[9,7,10],[9,8,6],[10,11,8],[6,11,7],[10,9,7],[6,9,8],[5,8,10],[5,7,6],[2,7,10],[2,8,6],[4,11,8],[1,11,7],[4,9,7],[1,9,8],[11,3,10],[11,0,6],[9,0,10],[9,3,6],[10,5,8],[6,5,7],[10,2,7],[6,2,8],[11,8,4],[11,7,1],[9,7,4],[9,8,1],[10,11,3],[6,11,0],[10,9,0],[6,9,3],[22,15,13],[22,12,16],[14,12,13],[14,15,16],[13,22,15],[16,22,12],[13,14,12],[16,14,15],[22,21,17],[22,20,19],[14,20,17],[14,21,19],[13,23,21],[16,23,20],[13,18,20],[16,18,21],[23,15,17],[23,12,19],[18,12,17],[18,15,19],[17,22,21],[19,22,20],[17,14,20],[19,14,21],[23,21,13],[23,20,16],[18,20,13],[18,21,16],[17,23,15],[19,23,12],[17,18,12],[19,18,15],[5,0,6],[2,7,4],[9,3,1],[6,5,0],[4,2,7],[1,9,3],[0,2,4],[3,2,1],[0,5,1],[2,1,3],[2,4,0],[5,1,0],[7,9,10],[8,9,6],[7,11,6],[9,6,8],[9,10,7],[11,6,7],[1,7,11],[4,8,11],[1,8,9],[4,7,9],[0,9,10],[3,9,6],[3,11,10],[0,11,6],[2,6,8],[2,10,7],[5,6,7],[5,10,8],[6,0,11],[10,3,11],[6,3,9],[10,0,9],[7,2,10],[8,2,6],[8,5,10],[7,5,6],[9,1,8],[9,4,7],[11,1,7],[11,4,8],[7,9,4],[8,9,1],[8,11,4],[7,11,1],[9,6,3],[9,10,0],[11,6,0],[11,10,3],[19,12,23],[13,15,22],[16,21,18],[17,20,14],[20,14,17],[21,18,16],[15,22,13],[12,23,19],[18,16,21],[14,17,20],[23,19,12],[22,13,15],[19,20,22],[13,21,23],[16,15,14],[17,12,18],[20,18,13],[21,14,19],[15,23,17],[12,22,16],[18,19,15],[14,13,12],[23,16,20],[22,17,21],[16,12,22],[17,15,23],[19,21,14],[13,20,18],[12,14,13],[15,18,19],[21,22,17],[20,23,16],[14,16,15],[18,17,12],[22,19,20],[23,13,21],[16,20,23],[17,21,22],[19,15,18],[13,12,14],[12,18,17],[15,14,16],[21,23,13],[20,22,19],[14,19,21],[18,13,20],[22,16,12],[23,17,15],[19,12,22],[17,21,23],[16,15,18],[13,20,14],[20,14,13],[15,18,16],[21,23,17],[12,22,19],[18,16,15],[14,13,20],[22,19,12],[23,17,21],[3,2,4],[3,5,1],[0,5,4],[2,4,3],[5,1,3],[5,4,0],[1,7,9],[4,8,9],[1,8,11],[4,7,11],[0,9,6],[3,9,10],[3,11,6],[0,11,10],[2,6,7],[2,10,8],[5,6,8],[5,10,7],[6,0,9],[10,3,9],[6,3,11],[10,0,11],[7,2,6],[8,2,10],[8,5,6],[7,5,10],[9,1,7],[9,4,8],[11,1,8],[11,4,7],[7,9,1],[8,9,4],[8,11,1],[7,11,4],[9,6,0],[9,10,3],[11,6,3],[11,10,0],[8,9,10],[8,11,6],[7,11,10],[9,10,8],[11,6,8],[11,10,7],[6,0,2],[10,3,2],[6,3,5],[10,0,5],[7,2,1],[8,2,4],[8,5,1],[7,5,4],[9,1,0],[9,4,3],[11,1,3],[11,4,0],[1,7,2],[4,8,2],[1,8,5],[4,7,5],[0,9,1],[3,9,4],[3,11,1],[0,11,4],[2,6,0],[2,10,3],[5,6,3],[5,10,0],[0,2,6],[3,2,10],[3,5,6],[0,5,10],[2,1,7],[2,4,8],[5,1,8],[5,4,7],[16,12,14],[13,21,18],[19,15,23],[17,20,22],[12,14,16],[21,18,13],[15,23,19],[20,22,17],[14,16,12],[18,13,21],[23,19,15],[22,17,20],[19,20,18],[17,15,14],[16,21,22],[13,12,23],[20,18,19],[15,14,17],[21,22,16],[12,23,13],[18,19,20],[14,17,15],[22,16,21],[23,13,12],[6,0,5],[10,3,5],[6,3,2],[10,0,2],[7,2,4],[8,2,1],[8,5,4],[7,5,1],[9,1,3],[9,4,0],[11,1,0],[11,4,3],[1,7,5],[4,8,5],[1,8,2],[4,7,2],[0,9,4],[3,9,1],[3,11,4],[0,11,1],[2,6,3],[2,10,0],[5,6,0],[5,10,3],[0,2,10],[3,2,6],[3,5,10],[0,5,6],[2,1,8],[2,4,7],[5,1,7],[5,4,8],[21,17,23],[20,16,22],[12,13,18],[15,19,14],[23,21,17],[22,20,16],[18,12,13],[14,15,19],[17,23,21],[16,22,20],[13,18,12],[19,14,15],[21,13,22],[20,19,23],[12,17,14],[15,16,18],[23,15,13],[22,12,19],[18,20,17],[14,21,16],[17,22,15],[16,23,12],[13,14,20],[19,18,21],[15,17,22],[12,16,23],[20,13,14],[21,19,18],[22,21,13],[23,20,19],[14,12,17],[18,15,16],[13,23,15],[19,22,12],[17,18,20],[16,14,21],[15,13,23],[12,19,22],[20,17,18],[21,16,14],[22,15,17],[23,12,16],[14,20,13],[18,21,19],[13,22,21],[19,23,20],[17,14,12],[16,18,15],[6,5,3],[4,9,3],[9,3,4],[5,7,4],[4,5,7],[5,3,6]],t.Group=[[0],[0,1],[0,2],[0,3],[0,2,4,5],[0,6],[0,7],[0,6,4,8],[0,7,4,9],[0,6,2,1],[0,3,1,10],[0,6,2,1,4,8,5,11],[0,12,1,7],[0,1,13,14],[0,12,1,7,4,15,11,9],[0,16,2,17],[0,18,12,17],[0,16,5,19],[0,20,13,19],[0,18,12,17,4,21,15,19],[0,16,2,17,4,22,5,19],[0,16,2,17,23,24,13,25,26,20,27,28,4,22,5,19],[0,16,17,2,29,21,30,15],[0,20,13,19,29,31,32,33],[0,16,6,34],[0,18,7,34],[0,16,7,35],[0,16,36,37],[0,18,36,38],[0,16,14,39],[0,20,40,34],[0,16,8,41],[0,18,8,42],[0,16,9,42],[0,16,6,34,4,22,8,41],[0,18,7,34,4,21,9,41],[0,16,7,35,4,22,9,42],[0,16,6,34,23,24,14,39],[0,16,10,43,23,24,7,35],[0,16,36,37,23,24,9,42],[0,16,8,41,23,24,40,38],[0,16,6,34,23,24,14,39,26,20,40,38,4,22,8,41],[0,16,44,45,23,24,46,47,26,20,48,49,4,22,50,51],[0,16,6,34,29,21,9,42],[0,16,8,41,29,21,7,35],[0,16,36,37,29,21,14,39],[0,16,2,17,1,52,6,34],[0,16,2,17,53,54,9,42],[0,16,12,33,1,52,7,35],[0,16,2,17,11,55,8,41],[0,56,2,57,1,58,6,37],[0,56,15,25,1,58,9,39],[0,20,27,17,1,59,40,34],[0,56,12,28,1,58,7,38],[0,16,5,19,1,52,8,41],[0,22,13,28,1,55,14,38],[0,18,13,60,1,61,14,43],[0,16,15,30,1,52,9,42],[0,16,5,19,11,55,6,34],[0,21,12,19,1,54,7,41],[0,20,13,19,1,59,14,41],[0,20,3,30,1,59,10,42],[0,18,12,17,1,61,7,34,4,21,15,19,11,54,9,41],[0,24,13,17,1,62,14,34,4,20,27,19,11,59,40,41],[0,16,2,17,1,52,6,34,4,22,5,19,11,55,8,41],[0,16,12,33,1,52,7,35,4,22,15,30,11,55,9,42],[0,31,3,17,1,63,10,34,4,56,32,19,11,58,36,41],[0,22,2,19,64,59,14,38,4,16,5,17,65,62,40,39],[0,16,2,17,1,52,6,34,23,24,13,25,64,62,14,39,26,20,27,28,65,59,40,38,4,22,5,19,11,55,8,41],[0,16,2,17,66,67,44,45,23,24,13,25,68,69,46,47,26,20,27,28,70,71,48,49,4,22,5,19,72,73,50,51],[0,16,2,17,1,52,6,34,29,21,15,30,53,54,9,42],[0,16,5,19,1,52,8,41,29,21,12,33,53,54,7,35],[0,20,13,19,1,59,14,41,29,31,32,33,53,63,36,35],[0,31,3,17,1,63,10,34,29,20,27,30,53,59,40,42],[0,16,74,75],[0,18,76,77],[0,16,78,79],[0,18,80,81],[0,16,74,75,29,21,82,83],[0,21,84,85,29,16,86,87],[0,16,88,89],[0,16,88,89,29,21,90,91],[0,16,74,75,1,52,88,89],[0,16,78,79,1,52,92,93],[0,16,94,95,11,55,88,89],[0,16,82,83,53,54,88,89],[0,16,74,75,1,52,88,89,29,21,82,83,53,54,90,91],[0,21,84,85,96,97,88,91,29,16,86,87,98,99,90,89],[0,16,74,75,2,17,100,101],[0,16,94,95,5,19,100,101],[0,18,76,77,2,33,102,103],[0,18,104,105,106,107,100,108],[0,16,78,79,2,17,109,108],[0,16,82,83,15,30,100,101],[0,18,80,81,2,33,110,111],[0,18,112,113,114,115,100,108],[0,16,74,75,2,17,100,101,29,21,82,83,15,30,116,117],[0,21,84,85,118,119,116,101,29,16,86,87,120,121,100,117],[0,16,74,75,6,34,122,123],[0,16,74,75,8,41,124,125],[0,16,78,79,7,35,122,123],[0,16,82,83,9,42,122,123],[0,16,74,75,7,35,126,127],[0,16,74,75,9,42,128,129],[0,16,78,79,6,34,126,127],[0,16,78,79,8,41,128,129],[0,16,74,75,6,34,122,123,29,21,82,83,9,42,128,129],[0,16,74,75,7,35,126,127,29,21,82,83,8,41,124,125],[0,21,84,85,6,42,130,131,29,16,86,87,9,34,132,133],[0,21,84,85,7,41,134,135,29,16,86,87,8,35,136,137],[0,16,89,88,2,17,122,123],[0,16,89,88,12,33,126,127],[0,16,89,88,5,19,124,125],[0,16,89,88,15,30,128,129],[0,16,88,89,6,34,100,101],[0,16,89,88,7,35,109,108],[0,16,89,88,8,41,138,139],[0,16,89,88,9,42,116,117],[0,16,89,88,6,34,100,101,29,21,91,90,9,42,116,117],[0,16,89,88,7,35,109,108,29,21,91,90,8,41,138,139],[0,16,89,88,2,17,122,123,29,21,91,90,15,30,128,129],[0,16,89,88,118,121,132,131,29,21,91,90,120,119,130,133],[0,16,74,75,2,17,100,101,1,52,88,89,6,34,122,123],[0,16,74,75,12,33,109,108,1,52,88,89,7,35,126,127],[0,16,74,75,2,17,100,101,11,55,140,141,8,41,124,125],[0,16,74,75,2,17,100,101,53,54,90,91,9,42,128,129],[0,16,74,75,5,19,138,139,1,52,88,89,8,41,124,125],[0,16,74,75,15,30,116,117,1,52,88,89,9,42,128,129],[0,16,94,95,5,19,100,101,11,55,88,89,6,34,124,125],[0,16,94,95,15,30,109,108,11,55,88,89,7,35,128,129],[0,16,78,79,2,17,109,108,1,52,92,93,6,34,126,127],[0,16,78,79,12,33,100,101,1,52,92,93,7,35,122,123],[0,16,82,83,12,33,138,139,53,54,88,89,8,41,126,127],[0,16,82,83,2,17,116,117,53,54,88,89,9,42,122,123],[0,16,78,79,5,19,116,117,1,52,92,93,8,41,128,129],[0,16,82,83,15,30,100,101,1,52,90,91,9,42,122,123],[0,16,82,83,15,30,100,101,53,54,88,89,6,34,128,129],[0,16,82,83,5,19,109,108,53,54,88,89,7,35,124,125],[0,16,74,75,2,17,100,101,1,52,88,89,6,34,122,123,29,21,82,83,15,30,116,117,53,54,90,91,9,42,128,129],[0,16,74,75,12,33,109,108,1,52,88,89,7,35,126,127,29,21,82,83,5,19,138,139,53,54,90,91,8,41,124,125],[0,21,84,85,118,119,116,101,96,97,88,91,9,34,132,133,29,16,86,87,120,121,100,117,98,99,90,89,6,42,130,131],[0,21,84,85,142,143,138,108,96,97,88,91,8,35,136,137,29,16,86,87,144,145,109,139,98,99,90,89,7,41,134,135],[0,146,147],[0,148,149],[0,150,151],[0,146,147,152,153,154,155,156,157],[0,158,159],[0,146,147,1,160,161],[0,146,147,1,160,161,152,153,154,162,163,164,155,156,157,165,166,167],[0,158,159,1,168,169],[0,146,147,101,170,171],[0,146,147,100,172,173],[0,148,149,174,175,171],[0,148,149,100,176,177],[0,150,151,178,179,171],[0,150,151,100,180,181],[0,146,147,100,172,173,152,153,154,182,183,184,155,156,157,185,186,187],[0,158,159,101,188,189],[0,146,147,122,190,191],[0,146,147,123,192,193],[0,146,147,126,194,195],[0,146,147,127,196,197],[0,146,147,122,190,191,152,153,154,198,199,200,155,156,157,201,202,203],[0,158,159,123,204,205],[0,146,147,126,194,195,152,153,154,206,207,208,155,156,157,209,210,211],[0,158,159,129,212,213],[0,146,147,101,170,171,1,160,161,123,192,193],[0,146,147,108,214,215,1,160,161,127,196,197],[0,146,147,100,172,173,1,160,161,122,190,191],[0,146,147,109,216,217,1,160,161,126,194,195],[0,146,147,100,172,173,1,160,161,122,190,191,152,153,154,182,183,184,162,163,164,198,199,200,155,156,157,185,186,187,165,166,167,201,202,203],[0,158,159,101,188,189,1,168,169,123,204,205],[0,146,147,109,216,217,1,160,161,126,194,195,152,153,154,218,219,220,162,163,164,206,207,208,155,156,157,221,222,223,165,166,167,209,210,211],[0,158,159,117,224,225,1,168,169,129,212,213],[0,146,147,16,226,227],[0,148,149,18,228,229],[0,150,151,18,230,231],[0,150,151,16,232,233],[0,148,149,16,234,235],[0,146,147,18,236,237],[0,146,147,52,238,239],[0,146,147,16,226,227,1,160,161,52,238,239],[0,146,147,18,236,237,1,160,161,61,240,241],[0,146,147,16,226,227,100,172,173,101,170,171],[0,148,149,18,228,229,242,172,181,243,214,244],[0,150,151,18,230,231,245,172,177,246,214,247],[0,150,151,16,232,233,245,172,177,174,170,248],[0,148,149,16,234,235,242,172,181,178,170,249],[0,146,147,18,236,237,100,172,173,108,214,215],[0,146,147,16,226,227,122,190,191,123,192,193],[0,146,147,16,226,227,126,194,195,127,196,197],[0,146,147,18,236,237,126,194,195,123,192,193],[0,146,147,18,236,237,122,190,191,127,196,197],[0,146,147,52,238,239,122,190,191,101,170,171],[0,146,147,61,240,241,126,194,195,101,170,171],[0,146,147,52,238,239,100,172,173,123,192,193],[0,146,147,61,240,241,100,172,173,127,196,197],[0,146,147,16,226,227,100,172,173,101,170,171,1,160,161,52,239,238,122,190,191,123,192,193],[0,146,147,16,226,227,109,216,217,108,214,215,1,160,161,52,239,238,126,194,195,127,196,197],[0,146,147,18,236,237,109,216,217,101,170,171,1,160,161,61,241,240,126,194,195,123,192,193],[0,146,147,18,236,237,100,172,173,108,214,215,1,160,161,61,241,240,122,190,191,127,196,197],[0,16,2,17,158,250,251,252,159,253,254,255],[0,16,2,17,158,250,251,252,159,253,254,255,23,24,13,25,256,257,258,259,260,261,262,263,26,20,27,28,264,265,266,267,268,269,270,271,4,22,5,19,272,273,274,275,276,277,278,279],[0,16,2,17,158,250,251,252,159,253,254,255,29,21,15,30,280,281,282,283,284,285,286,287],[0,20,13,19,158,273,266,259,159,261,278,271],[0,20,13,19,158,273,266,259,159,261,278,271,29,31,32,33,280,288,289,290,284,291,292,293],[0,16,2,17,158,250,251,252,159,253,254,255,1,52,6,34,168,294,295,296,169,297,298,299],[0,16,2,17,158,250,251,252,159,253,254,255,53,54,9,42,300,301,302,303,304,305,306,307],[0,16,2,17,158,250,251,252,159,253,254,255,1,52,6,34,168,294,295,296,169,297,298,299,23,24,13,25,256,257,258,259,260,261,262,263,64,62,14,39,308,309,310,311,312,313,314,315,26,20,27,28,264,265,266,267,268,269,270,271,65,59,40,38,316,317,318,319,320,321,322,323,4,22,5,19,272,273,274,275,276,277,278,279,11,55,8,41,324,325,326,327,328,329,330,331],[0,16,2,17,158,250,251,252,159,253,254,255,66,67,44,45,332,333,334,335,336,337,338,339,23,24,13,25,256,257,258,259,260,261,262,263,68,69,46,47,340,341,342,343,344,345,346,347,26,20,27,28,264,265,266,267,268,269,270,271,70,71,48,49,348,349,350,351,352,353,354,355,4,22,5,19,272,273,274,275,276,277,278,279,72,73,50,51,356,357,358,359,360,361,362,363],[0,16,2,17,158,250,251,252,159,253,254,255,1,52,6,34,168,294,295,296,169,297,298,299,29,21,15,30,280,281,282,283,284,285,286,287,53,54,9,42,300,301,302,303,304,305,306,307],[0,20,13,19,158,273,266,259,159,261,278,271,1,59,14,41,168,325,318,311,169,313,330,323],[0,20,13,19,158,273,266,259,159,261,278,271,1,59,14,41,168,325,318,311,169,313,330,323,29,31,32,33,280,288,289,290,284,291,292,293,53,63,36,35,300,364,365,366,304,367,368,369],[0,16,2,17,158,250,251,252,159,253,254,255,100,101,75,74,370,371,188,372,373,374,375,189],[0,16,2,17,158,250,251,252,159,253,254,255,116,117,83,82,376,377,224,378,379,380,381,225],[0,16,2,17,158,250,251,252,159,253,254,255,100,101,75,74,370,371,188,372,373,374,375,189,23,24,13,25,256,257,258,259,260,261,262,263,382,383,384,385,386,387,388,389,390,391,392,393,26,20,27,28,264,265,266,267,268,269,270,271,394,395,396,397,398,399,400,401,402,403,404,405,4,22,5,19,272,273,274,275,276,277,278,279,138,139,95,94,406,407,408,409,410,411,412,413],[0,24,5,28,158,265,258,275,159,277,270,263,414,415,416,417,418,419,420,421,422,423,424,425,23,16,27,19,256,273,251,267,260,269,278,255,426,427,428,429,430,431,432,433,434,435,436,437,26,22,13,17,264,250,274,259,268,261,254,279,438,439,440,441,442,443,444,445,446,447,448,449,4,20,2,25,272,257,266,252,276,253,262,271,450,451,452,453,454,455,456,457,458,459,460,461],[0,16,2,17,158,250,251,252,159,253,254,255,100,101,75,74,370,371,188,372,373,374,375,189,29,21,15,30,280,281,282,283,284,285,286,287,116,117,83,82,376,377,224,378,379,380,381,225],[0,20,13,19,158,273,266,259,159,261,278,271,450,415,440,429,454,431,420,445,458,447,436,425],[0,20,13,19,158,273,266,259,159,261,278,271,462,463,464,465,466,467,468,469,470,471,472,473],[0,20,13,19,158,273,266,259,159,261,278,271,462,463,464,465,466,467,468,469,470,471,472,473,29,31,32,33,280,288,289,290,284,291,292,293,450,415,440,429,454,431,420,445,458,447,436,425],[0,16,2,17,158,250,251,252,159,253,254,255,123,122,88,89,204,474,475,476,205,477,478,479],[0,16,2,17,158,250,251,252,159,253,254,255,123,122,88,89,204,474,475,476,205,477,478,479,23,24,13,25,256,257,258,259,260,261,262,263,480,481,482,483,484,485,486,487,488,489,490,491,26,20,27,28,264,265,266,267,268,269,270,271,492,493,494,495,496,497,498,499,500,501,502,503,4,22,5,19,272,273,274,275,276,277,278,279,125,124,140,141,504,505,506,507,508,509,510,511],[0,16,2,17,158,250,251,252,159,253,254,255,123,122,88,89,204,474,475,476,205,477,478,479,29,21,15,30,280,281,282,283,284,285,286,287,129,128,90,91,212,512,513,514,213,515,516,517],[0,16,2,17,158,250,251,252,159,253,254,255,129,128,90,91,212,512,513,514,213,515,516,517],[0,16,2,17,158,250,251,252,159,253,254,255,129,128,90,91,212,512,513,514,213,515,516,517,23,24,13,25,256,257,258,259,260,261,262,263,518,519,520,521,522,523,524,525,526,527,528,529,26,20,27,28,264,265,266,267,268,269,270,271,530,531,532,533,534,535,536,537,538,539,540,541,4,22,5,19,272,273,274,275,276,277,278,279,127,126,92,93,542,543,544,545,546,547,548,549],[0,20,13,19,158,273,266,259,159,261,278,271,550,551,552,553,554,555,556,557,558,559,560,561,29,31,32,33,280,288,289,290,284,291,292,293,562,563,564,565,566,567,568,569,570,571,572,573],[0,16,2,17,158,250,251,252,159,253,254,255,100,101,75,74,370,371,188,372,373,374,375,189,1,52,6,34,168,294,295,296,169,297,298,299,122,123,89,88,475,476,204,474,479,478,477,205],[0,16,2,17,158,250,251,252,159,253,254,255,100,101,75,74,370,371,188,372,373,374,375,189,53,54,9,42,300,301,302,303,304,305,306,307,128,129,91,90,513,514,212,512,517,516,515,213],[0,16,2,17,158,250,251,252,159,253,254,255,116,117,83,82,376,377,224,378,379,380,381,225,1,52,6,34,168,294,295,296,169,297,298,299,128,129,91,90,513,514,212,512,517,516,515,213],[0,16,2,17,158,250,251,252,159,253,254,255,116,117,83,82,376,377,224,378,379,380,381,225,53,54,9,42,300,301,302,303,304,305,306,307,122,123,89,88,475,476,204,474,479,478,477,205],[0,16,2,17,158,250,251,252,159,253,254,255,100,101,75,74,370,371,188,372,373,374,375,189,1,52,6,34,168,294,295,296,169,297,298,299,122,123,89,88,475,476,204,474,479,478,477,205,23,24,13,25,256,257,258,259,260,261,262,263,382,383,384,385,386,387,388,389,390,391,392,393,64,62,14,39,308,309,310,311,312,313,314,315,481,480,483,482,486,487,484,485,491,490,489,488,26,20,27,28,264,265,266,267,268,269,270,271,394,395,396,397,398,399,400,401,402,403,404,405,65,59,40,38,316,317,318,319,320,321,322,323,493,492,495,494,498,499,496,497,503,502,501,500,4,22,5,19,272,273,274,275,276,277,278,279,138,139,95,94,406,407,408,409,410,411,412,413,11,55,8,41,324,325,326,327,328,329,330,331,124,125,141,140,506,507,504,505,511,510,509,508],[0,16,2,17,158,250,251,252,159,253,254,255,116,117,83,82,376,377,224,378,379,380,381,225,1,52,6,34,168,294,295,296,169,297,298,299,128,129,91,90,513,514,212,512,517,516,515,213,23,24,13,25,256,257,258,259,260,261,262,263,574,575,576,577,578,579,580,581,582,583,584,585,64,62,14,39,308,309,310,311,312,313,314,315,519,518,521,520,524,525,522,523,529,528,527,526,26,20,27,28,264,265,266,267,268,269,270,271,586,587,588,589,590,591,592,593,594,595,596,597,65,59,40,38,316,317,318,319,320,321,322,323,531,530,533,532,536,537,534,535,541,540,539,538,4,22,5,19,272,273,274,275,276,277,278,279,109,108,79,78,598,599,600,601,602,603,604,605,11,55,8,41,324,325,326,327,328,329,330,331,126,127,93,92,544,545,542,543,549,548,547,546],[0,24,5,28,158,265,258,275,159,277,270,263,414,415,416,417,418,419,420,421,422,423,424,425,66,69,50,49,332,349,342,359,336,361,354,347,493,123,483,140,498,507,204,485,503,490,509,205,23,16,27,19,256,273,251,267,260,269,278,255,426,427,428,429,430,431,432,433,434,435,436,437,68,67,48,51,340,357,334,351,344,353,362,339,124,480,89,494,506,499,484,474,511,478,501,488,26,22,13,17,264,250,274,259,268,261,254,279,438,439,440,441,442,443,444,445,446,447,448,449,70,73,46,45,348,333,358,343,352,345,338,363,122,492,141,482,475,487,496,505,479,510,489,500,4,20,2,25,272,257,266,252,276,253,262,271,450,451,452,453,454,455,456,457,458,459,460,461,72,71,44,47,356,341,350,335,360,337,346,355,481,125,495,88,486,476,504,497,491,502,477,508],[0,24,5,28,158,265,258,275,159,277,270,263,414,415,416,417,418,419,420,421,422,423,424,425,606,607,608,609,610,611,612,613,614,615,616,617,531,129,521,92,536,545,212,523,541,528,547,213,23,16,27,19,256,273,251,267,260,269,278,255,426,427,428,429,430,431,432,433,434,435,436,437,618,619,620,621,622,623,624,625,626,627,628,629,126,518,91,532,544,537,522,512,549,516,539,526,26,22,13,17,264,250,274,259,268,261,254,279,438,439,440,441,442,443,444,445,446,447,448,449,630,631,632,633,634,635,636,637,638,639,640,641,128,530,93,520,513,525,534,543,517,548,527,538,4,20,2,25,272,257,266,252,276,253,262,271,450,451,452,453,454,455,456,457,458,459,460,461,642,643,644,645,646,647,648,649,650,651,652,653,519,127,533,90,524,514,542,535,529,540,515,546],[0,16,2,17,158,250,251,252,159,253,254,255,100,101,75,74,370,371,188,372,373,374,375,189,1,52,6,34,168,294,295,296,169,297,298,299,122,123,89,88,475,476,204,474,479,478,477,205,29,21,15,30,280,281,282,283,284,285,286,287,116,117,83,82,376,377,224,378,379,380,381,225,53,54,9,42,300,301,302,303,304,305,306,307,128,129,91,90,513,514,212,512,517,516,515,213],[0,20,13,19,158,273,266,259,159,261,278,271,462,463,464,465,466,467,468,469,470,471,472,473,1,59,14,41,168,325,318,311,169,313,330,323,551,550,553,552,556,557,554,555,561,560,559,558,29,31,32,33,280,288,289,290,284,291,292,293,450,415,440,429,454,431,420,445,458,447,436,425,53,63,36,35,300,364,365,366,304,367,368,369,563,562,565,564,568,569,566,567,573,572,571,570],[0,16],[0,18],[0,16,26,20],[0,2,23,13],[0,3,4,32],[0,2,29,15],[0,3,29,27],[0,52],[0,63],[0,52,26,59],[0,63,26,54],[0,52,16,1],[0,18,1,61],[0,52,16,1,26,59,20,65],[0,31,1,63],[0,1,24,62],[0,31,1,63,26,21,65,54],[0,2,57,56],[0,60,3,16],[0,22,57,3],[0,2,28,20],[0,17,13,24],[0,20,19,13,4,24,17,27],[0,22,57,3,4,16,60,32],[0,22,57,3,23,20,30,12,26,24,33,15,4,16,60,32],[0,22,57,3,29,18,27,25],[0,22,3,57,1,55,10,37],[0,22,385,396,3,57,109,117],[0,22,57,3,159,279,654,655,158,274,656,657,29,18,25,27,284,658,262,269,280,659,257,267]],t.Spacegroup={"P 1":0,"P -1":1,"P 1 2 1":2,"P 1 21 1":3,"C 1 2 1":4,"P 1 m 1":5,"P 1 c 1":6,"C 1 m 1":7,"C 1 c 1":8,"P 1 2/m 1":9,"P 1 21/m 1":10,"C 1 2/m 1":11,"P 1 2/c 1":12,"P 1 21/c 1":13,"C 1 2/c 1":14,"P 2 2 2":15,"P 2 2 21":16,"P 21 21 2":17,"P 21 21 21":18,"C 2 2 21":19,"C 2 2 2":20,"F 2 2 2":21,"I 2 2 2":22,"I 21 21 21":23,"P m m 2":24,"P m c 21":25,"P c c 2":26,"P m a 2":27,"P c a 21":28,"P n c 2":29,"P m n 21":30,"P b a 2":31,"P n a 21":32,"P n n 2":33,"C m m 2":34,"C m c 21":35,"C c c 2":36,"A m m 2":37,"A b m 2":38,"A m a 2":39,"A b a 2":40,"F m m 2":41,"F d d 2":42,"I m m 2":43,"I b a 2":44,"I m a 2":45,"P 2/m 2/m 2/m":46,"P m m m":46,"P 2/n 2/n 2/n":47,"P n n n":47,"P 2/c 2/c 2/m":48,"P c c m":48,"P 2/b 2/a 2/n":49,"P b a n":49,"P 21/m 2/m 2/a":50,"P m m a":50,"P 2/n 21/n 2/a":51,"P n n a":51,"P 2/m 2/n 21/a":52,"P m n a":52,"P 21/c 2/c 2/a":53,"P c c a":53,"P 21/b 21/a 2/m":54,"P b a m":54,"P 21/c 21/c 2/n":55,"P c c n":55,"P 2/b 21/c 21/m":56,"P b c m":56,"P 21/n 21/n 2/m":57,"P n n m":57,"P 21/m 21/m 2/n":58,"P m m n":58,"P 21/b 2/c 21/n":59,"P b c n":59,"P 21/b 21/c 21/a":60,"P b c a":60,"P 21/n 21/m 21/a":61,"P n m a":61,"C 2/m 2/c 21/m":62,"C m c m":62,"C 2/m 2/c 21/a":63,"C m c a":63,"C 2/m 2/m 2/m":64,"C m m m":64,"C 2/c 2/c 2/m":65,"C c c m":65,"C 2/m 2/m 2/a":66,"C m m a":66,"C 2/c 2/c 2/a":67,"C c c a":67,"F 2/m 2/m 2/m":68,"F m m m":68,"F 2/d 2/d 2/d":69,"F d d d":69,"I 2/m 2/m 2/m":70,"I m m m":70,"I 2/b 2/a 2/m":71,"I b a m":71,"I 21/b 21/c 21/a":72,"I b c a":72,"I 21/m 21/m 21/a":73,"I m m a":73,"P 4":74,"P 41":75,"P 42":76,"P 43":77,"I 4":78,"I 41":79,"P -4":80,"I -4":81,"P 4/m":82,"P 42/m":83,"P 4/n":84,"P 42/n":85,"I 4/m":86,"I 41/a":87,"P 4 2 2":88,"P 4 21 2":89,"P 41 2 2":90,"P 41 21 2":91,"P 42 2 2":92,"P 42 21 2":93,"P 43 2 2":94,"P 43 21 2":95,"I 4 2 2":96,"I 41 2 2":97,"P 4 m m":98,"P 4 b m":99,"P 42 c m":100,"P 42 n m":101,"P 4 c c":102,"P 4 n c":103,"P 42 m c":104,"P 42 b c":105,"I 4 m m":106,"I 4 c m":107,"I 41 m d":108,"I 41 c d":109,"P -4 2 m":110,"P -4 2 c":111,"P -4 21 m":112,"P -4 21 c":113,"P -4 m 2":114,"P -4 c 2":115,"P -4 b 2":116,"P -4 n 2":117,"I -4 m 2":118,"I -4 c 2":119,"I -4 2 m":120,"I -4 2 d":121,"P 4/m 2/m 2/m":122,"P4/m m m":122,"P 4/m 2/c 2/c":123,"P4/m c c":123,"P 4/n 2/b 2/m":124,"P4/n b m":124,"P 4/n 2/n 2/c":125,"P4/n n c":125,"P 4/m 21/b 2/m":126,"P4/m b m":126,"P 4/m 21/n 2/c":127,"P4/m n c":127,"P 4/n 21/m 2/m":128,"P4/n m m":128,"P 4/n 2/c 2/c":129,"P4/n c c":129,"P 42/m 2/m 2/c":130,"P42/m m c":130,"P 42/m 2/c 2/m":131,"P42/m c m":131,"P 42/n 2/b 2/c":132,"P42/n b c":132,"P 42/n 2/n 2/m":133,"P42/n n m":133,"P 42/m 21/b 2/c":134,"P42/m b c":134,"P 42/m 21/n 2/m":135,"P42/m n m":135,"P 42/n 21/m 2/c":136,"P42/n m c":136,"P 42/n 21/c 2/m":137,"P42/n c m":137,"I 4/m 2/m 2/m":138,"I4/m m m":138,"I 4/m 2/c 2/m":139,"I4/m c m":139,"I 41/a 2/m 2/d":140,"I41/a m d":140,"I 41/a 2/c 2/d":141,"I41/a c d":141,"P 3":142,"P 31":143,"P 32":144,"H 3":145,"R 3":146,"P -3":147,"H -3":148,"R -3":149,"P 3 1 2":150,"P 3 2 1":151,"P 31 1 2":152,"P 31 2 1":153,"P 32 1 2":154,"P 32 2 1":155,"H 3 2":156,"R 3 2":157,"P 3 m 1":158,"P 3 1 m":159,"P 3 c 1":160,"P 3 1 c":161,"H 3 m":162,"R 3 m":163,"H 3 c":164,"R 3 c":165,"P -3 1 2/m":166,"P -3 1 m":166,"P -3 1 2/c":167,"P -3 1 c":167,"P -3 2/m 1":168,"P -3 m 1":168,"P -3 2/c 1":169,"P -3 c 1":169,"H -3 2/m":170,"H -3 m":170,"R -3 2/m":171,"R -3 m":171,"H -3 2/c":172,"H -3 c":172,"R -3 2/c":173,"R -3 c":173,"P 6":174,"P 61":175,"P 65":176,"P 62":177,"P 64":178,"P 63":179,"P -6":180,"P 6/m":181,"P 63/m":182,"P 6 2 2":183,"P 61 2 2":184,"P 65 2 2":185,"P 62 2 2":186,"P 64 2 2":187,"P 63 2 2":188,"P 6 m m":189,"P 6 c c":190,"P 63 c m":191,"P 63 m c":192,"P -6 m 2":193,"P -6 c 2":194,"P -6 2 m":195,"P -6 2 c":196,"P 6/m 2/m 2/m":197,"P 6/m m m":197,"P 6/m 2/c 2/c":198,"P 6/m c c":198,"P 63/m 2/c 2/m":199,"P 63/m c m":199,"P 63/m 2/m 2/c":200,"P 63/m m c":200,"P 2 3":201,"F 2 3":202,"I 2 3":203,"P 21 3":204,"I 21 3":205,"P 2/m -3":206,"P m -3":206,"P 2/n -3":207,"P n -3":207,"F 2/m -3":208,"F m -3":208,"F 2/d -3":209,"F d -3":209,"I 2/m -3":210,"I m -3":210,"P 21/a -3":211,"P a -3":211,"I 21/a -3":212,"I a -3":212,"P 4 3 2":213,"P 42 3 2":214,"F 4 3 2":215,"F 41 3 2":216,"I 4 3 2":217,"P 43 3 2":218,"P 41 3 2":219,"I 41 3 2":220,"P -4 3 m":221,"F -4 3 m":222,"I -4 3 m":223,"P -4 3 n":224,"F -4 3 c":225,"I -4 3 d":226,"P 4/m -3 2/m":227,"P m -3 m":227,"P 4/n -3 2/n":228,"P n -3 n":228,"P 42/m -3 2/n":229,"P m -3 n":229,"P 42/n -3 2/m":230,"P n -3 m":230,"F 4/m -3 2/m":231,"F m -3 m":231,"F 4/m -3 2/c":232,"F m -3 c":232,"F 41/d -3 2/m":233,"F d -3 m":233,"F 41/d -3 2/c":234,"F d -3 c":234,"I 4/m -3 2/m":235,"I m -3 m":235,"I 41/a -3 2/d":236,"I a -3 d":236,"P 1 1 2":237,"P 1 1 21":238,"B 1 1 2":239,"B 2":239,"A 1 2 1":240,"C 1 21 1":241,"I 1 2 1":242,"I 2":242,"I 1 21 1":243,"P 1 1 m":244,"P 1 1 b":245,"B 1 1 m":246,"B 1 1 b":247,"P 1 1 2/m":248,"P 1 1 21/m":249,"B 1 1 2/m":250,"P 1 1 2/b":251,"P 1 1 21/b":252,"B 1 1 2/b":253,"P 21 2 2":254,"P 2 21 2":255,"P 21 21 2 (a)":256,"P 21 2 21":257,"P 2 21 21":258,"C 2 2 21a)":259,"C 2 2 2a":260,"F 2 2 2a":261,"I 2 2 2a":262,"P 21/m 21/m 2/n a":263,"P 42 21 2a":264,"I 2 3a":265}}(o=e.SpacegroupTables||(e.SpacegroupTables={}))}(t.Structure||(t.Structure={}))}(t.Core||(t.Core={}))}(o||(o={}));var o;!function(t){!function(t){!function(e){function n(t,e,n){return o.buildPivotGroupSymmetry(t,e,n)}function r(t,e){return o.buildMates(t,e)}function i(t,e){return o.buildAssembly(t,e)}var o,s=t.Utils.DataTable;!function(n){function r(t,e){for(var n=t.x,r=t.y,i=t.z,o={x:0,y:0,z:0},s=0,a=e;s<a.length;s++){var u=a[s];o.x+=n[u],o.y+=r[u],o.z+=i[u]}var h=e.length>0?e.length:1;o.x/=h,o.y/=h,o.z/=h;for(var f=0,d=0,l=e;d<l.length;d++){var u=l[d];f=Math.max(c(u,o,t),f)}return{center:o,radius:Math.sqrt(f)}}function i(){return{x:0,y:0,z:0}}function o(t,e,n){var r=t.x-n.center.x,i=t.y-n.center.y,o=t.z-n.center.z;return Math.sqrt(r*r+i*i+o*o)-(e+n.radius)}function a(t,e,n,r,i,s){return s.x=n.x[e],s.y=n.y[e],s.z=n.z[e],T.transformVector3(s,s,r),o(s,n.r[e],t)<=i}function u(t,e,n){var r=n.x[t]-n.cX[e],i=n.y[t]-n.cY[e],o=n.z[t]-n.cZ[e];return r*r+i*i+o*o}function c(t,e,n){var r=n.x[t]-e.x,i=n.y[t]-e.y,o=n.z[t]-e.z;return r*r+i*i+o*o}function h(t,e,n,r){return{model:t,boundingInfo:e,spacegroup:n,radius:r,transform:T.empty(),transformed:{x:0,y:0,z:0},i:0,j:0,k:0,op:0}}function f(t,e){return T.transformVector3(t.transformed,e,t.transform)}function d(t){return l(t.i,t.j,t.k,t.op,T.clone(t.transform))}function l(t,e,n,r,i){return{isIdentity:!(t||e||n||r),id:r+1+"_"+(5+t)+(5+e)+(5+n),transform:i}}function p(t,e){for(var n=!0,r=0;r<4;r++){for(var i=0;i<4;i++){var o=e[4*i+r];if(r===i){if(Math.abs(o-1)>1e-7){n=!1;break}}else if(Math.abs(o)>1e-7){n=!1;break}}if(!n)break}return{isIdentity:n,id:t.toString(),transform:e}}function m(t,e){for(var n=t.data.atoms,r=t.data.residues,o=t.data.chains,a=t.data.entities,h=t.positions,f=h.x,d=h.y,l=h.z,p=s.builder(a.count),m=p.addColumn("x",function(t){return new Float64Array(t)}),y=p.addColumn("y",function(t){return new Float64Array(t)}),g=p.addColumn("z",function(t){return new Float64Array(t)}),v=p.addColumn("r",function(t){return new Float64Array(t)}),b=s.builder(o.count),_=b.addColumn("x",function(t){return new Float64Array(t)}),w=b.addColumn("y",function(t){return new Float64Array(t)}),x=b.addColumn("z",function(t){return new Float64Array(t)}),C=b.addColumn("r",function(t){return new Float64Array(t)}),I=s.builder(r.count),S=I.addColumn("x",function(t){return new Float64Array(t)}),A=I.addColumn("y",function(t){return new Float64Array(t)}),k=I.addColumn("z",function(t){return new Float64Array(t)}),E=I.addColumn("r",function(t){return new Float64Array(t)}),P=i(),T=0,F=i(),D=0,M=0,N=i(),R=0,O=i(),q=0,U=i(),B=0,z=0,L=a.count;z<L;z++){N.x=0,N.y=0,N.z=0;for(var j=a.chainStartIndex[z],V=a.chainEndIndex[z];j<V;j++){O.x=0,O.y=0,O.z=0;for(var X=o.residueStartIndex[j],Y=o.residueEndIndex[j];X<Y;X++){U.x=0,U.y=0,U.z=0;for(var Z=r.atomStartIndex[X],H=r.atomEndIndex[X];Z<H;Z++)U.x+=f[Z],U.y+=d[Z],U.z+=l[Z];P.x+=U.x,P.y+=U.y,P.z+=U.z,M=r.atomEndIndex[X]-r.atomStartIndex[X],O.x+=U.x,O.y+=U.y,O.z+=U.z,S[X]=U.x/M,A[X]=U.y/M,k[X]=U.z/M}N.x+=O.x,N.y+=O.y,N.z+=O.z,M=o.atomEndIndex[j]-o.atomStartIndex[j],_[j]=O.x/M,w[j]=O.y/M,x[j]=O.z/M}M=a.atomEndIndex[z]-a.atomStartIndex[z],m[z]=N.x/M,y[z]=N.y/M,g[z]=N.z/M}P.x/=n.count,P.y/=n.count,P.z/=n.count;for(var G=0,W=e;G<W.length;G++){var Z=W[G];F.x+=f[Z],F.y+=d[Z],F.z+=l[Z]}var Q=e.length>0?e.length:1;F.x/=Q,F.y/=Q,F.z/=Q;for(var J={x:f,y:d,z:l,cX:m,cY:y,cZ:g},K={x:f,y:d,z:l,cX:_,cY:w,cZ:x},$={x:f,y:d,z:l,cX:S,cY:A,cZ:k},z=0,L=a.count;z<L;z++){R=0;for(var j=a.chainStartIndex[z],V=a.chainEndIndex[z];j<V;j++){q=0;for(var X=o.residueStartIndex[j],Y=o.residueEndIndex[j];X<Y;X++){B=0;for(var Z=r.atomStartIndex[X],H=r.atomEndIndex[X];Z<H;Z++)B=Math.max(B,u(Z,X,$)),q=Math.max(q,u(Z,j,K)),R=Math.max(R,u(Z,z,J)),T=Math.max(T,c(Z,P,$));B=Math.sqrt(B),E[X]=B}q=Math.sqrt(q),C[j]=q}R=Math.sqrt(R),v[z]=R}T=Math.sqrt(T);for(var tt=0,et=e;tt<et.length;tt++){var Z=et[tt];D=Math.max(D,c(Z,F,$))}return D=Math.sqrt(D),{entities:p.seal(),chains:b.seal(),residues:I.seal(),allAtoms:{center:P,radius:T},target:{center:F,radius:D}}}function y(t){
var e=t.boundingInfo,n=t.spacegroup,r=[];t.transform=T.identity(),r[0]=d(t);for(var i=-3;i<=3;i++)for(var s=-3;s<=3;s++)for(var a=-3;a<=3;a++)for(var u=0===i&&0===s&&0===a?1:0,c=n.operatorCount;u<c;u++){n.getOperatorMatrix(u,i,s,a,t.transform),t.i=i,t.k=a,t.j=s,t.op=u;var h=f(t,e.allAtoms.center),l=o(h,e.allAtoms.radius,e.target);l<t.radius&&(r[r.length]=d(t))}return r}function g(e,n){for(var r=e.boundingInfo,i=e.radius,o=r.target,s=e.model,u=s.data.residues,c=s.data.chains,h=s.data.entities,f=t.Utils.ChunkedArray.create(function(t){return new Int32Array(t)},u.count,1),d=t.Utils.ChunkedArray.create(function(t){return new Int32Array(t)},u.count,1),l={x:0,y:0,z:0},p=0,m=0,y=0,g=0,v=0,b=h.count;v<b;v++){p=0;for(var _=!1,w=0,x=n;w<x.length;w++){for(var C=x[w],I=h.chainStartIndex[v],S=h.chainEndIndex[v];I<S;I++)if(a(o,I,r.chains,C.transform,i,l)){for(var A=!1,k=c.residueStartIndex[I],E=c.residueEndIndex[I];k<E;k++)a(o,k,r.residues,C.transform,i,l)&&(t.Utils.ChunkedArray.add(f,k),t.Utils.ChunkedArray.add(d,p),m+=u.atomEndIndex[k]-u.atomStartIndex[k],A=!0);A&&(y+=1,_=!0)}p++}_&&g++}return{residues:t.Utils.ChunkedArray.compact(f),operators:t.Utils.ChunkedArray.compact(d),atomCount:m,chainCount:y,entityCount:g}}function v(t,e,n,r,i){for(var o=0;o<i;o++)n[o][r]=t[o][e]}function b(t,n,r){for(var i,o,a,u,c=t.data.residues,h=c.chainIndex,f=c.entityIndex,d=c.atomStartIndex,l=c.atomEndIndex,p=t.data.atoms,m=t.positions,y=m.x,g=m.y,b=m.z,w=s.builder(n.atomCount),x=[],C=s.ofDefinition(e.Tables.Positions,n.atomCount),I=C.x,S=C.y,A=C.z,k=t.data.entities.getBuilder(n.entityCount),E=k,P=t.data.entities.getRawData(),F=E.getRawData(),D=E.chainStartIndex,M=E.chainEndIndex,N=E.residueStartIndex,R=E.residueEndIndex,O=E.atomStartIndex,q=E.atomEndIndex,U=0,B=t.data.chains.getBuilder(n.chainCount),z=B,L=t.data.chains.getRawData(),j=z.getRawData(),V=z.residueStartIndex,X=z.residueEndIndex,Y=z.atomStartIndex,Z=z.atomEndIndex,H=z.asymId,G=z.authAsymId,W=z.entityIndex,Q=B.addColumn("sourceChainIndex",function(t){return new Int32Array(t)}),J=B.addColumn("operatorIndex",function(t){return new Int32Array(t)}),K=0,$=t.data.residues.getBuilder(n.residues.length),tt=$,et=t.data.residues.getRawData(),nt=tt.getRawData(),rt=tt.atomStartIndex,it=tt.atomEndIndex,ot=tt.asymId,st=tt.authAsymId,at=tt.chainIndex,ut=tt.entityIndex,ct=0,ht=t.data.atoms.columns;ct<ht.length;ct++){var ft=ht[ct],dt=w.addColumn(ft.name,ft.creator);"residueIndex"===ft.name?o=dt:"chainIndex"===ft.name?a=dt:"entityIndex"===ft.name?u=dt:"id"===ft.name?i=dt:x[x.length]={src:p[ft.name],target:dt}}var lt,pt,mt=n.residues,yt=n.operators,gt={x:0,y:0,z:0},vt=0,bt=mt[0],_t=h[bt],wt=f[bt],xt=yt[0];v(P,f[bt],F,0,P.length),D[0]=0,N[0]=0,O[0]=0,v(L,h[bt],j,0,L.length),W[0]=0,V[0]=0,Y[0]=0,lt=t.data.chains.asymId[h[bt]],pt=t.data.chains.authAsymId[h[bt]];var Ct=r[yt[0]];Ct&&!Ct.isIdentity&&(H[K]=t.data.chains.asymId[h[bt]]+"-"+Ct.id,G[K]=t.data.chains.authAsymId[h[bt]]+"-"+Ct.id,Q[K]=h[bt],J[K]=xt,lt=H[K],pt=G[K]);for(var It=0,St=mt.length;It<St;It++){bt=mt[It];var At=yt[It];Ct=r[At],v(et,bt,nt,It,nt.length);var kt=f[bt],Et=h[bt],Pt=!1;kt!==wt?(X[K]=It,Z[K]=vt,K+=1,M[U]=K,R[U]=It,q[U]=vt,U+=1,v(P,kt,F,U,P.length),D[U]=K,N[U]=It,O[U]=vt,Pt=!0):Et!==_t?(X[K]=It,Z[K]=vt,K+=1,Pt=!0):At!==xt&&(X[K]=It,Z[K]=vt,K+=1,Pt=!0),Pt&&(v(L,Et,j,K,L.length),W[K]=U,V[K]=It,Y[K]=vt,Ct.isIdentity||(H[K]=t.data.chains.asymId[Et]+"-"+Ct.id,G[K]=t.data.chains.authAsymId[Et]+"-"+Ct.id),Q[K]=Et,J[K]=At,lt=H[K],pt=G[K]),_t=Et,wt=kt,xt=At,at[It]=K,ut[It]=U,rt[It]=vt,ot[It]=lt,st[It]=pt;for(var Tt=d[bt],Ft=l[bt];Tt<Ft;Tt++){gt.x=y[Tt],gt.y=g[Tt],gt.z=b[Tt],T.transformVector3(gt,gt,Ct.transform),I[vt]=gt.x,S[vt]=gt.y,A[vt]=gt.z,i[vt]=vt+1,o[vt]=It,a[vt]=K,u[vt]=U;for(var Dt=0,Mt=x;Dt<Mt.length;Dt++){var dt=Mt[Dt];dt.target[vt]=dt.src[Tt]}vt++}it[It]=vt}M[U]=K+1,R[U]=mt.length,q[U]=vt,X[K]=mt.length,Z[K]=vt;var Nt=w.seal(),Rt=$.seal(),Ot=B.seal(),qt=k.seal(),Ut=_(t,n,Rt);return e.Molecule.Model.create({id:t.id,modelId:t.modelId,data:{atoms:Nt,residues:Rt,chains:Ot,entities:qt,bonds:{component:t.data.bonds.component},secondaryStructure:Ut},positions:C,parent:t,source:e.Molecule.Model.Source.Computed,operators:r.map(function(t){return new e.Operator(t.transform,t.id,t.isIdentity)})})}function _(t,n,r){for(var i=t.data.residues.secondaryStructureIndex,o=t.data.secondaryStructure,s=r.asymId,a=r.seqNumber,u=r.insCode,c=r.secondaryStructureIndex,h=n.residues,f=n.operators,d=h.length,l=[],p=0;p<d;){for(var m=p,y=i[h[p]],g=f[p];m<d&&f[m]==g&&i[h[m]]==y;)m++;var v=o[y],b=new e.SecondaryStructureElement(v.type,new e.PolyResidueIdentifier(s[p],a[p],u[p]),new e.PolyResidueIdentifier(s[m-1],a[m-1],u[m-1]),v.info);b.startResidueIndex=p,b.endResidueIndex=m;for(var _=l.length,w=p;w<m;w++)c[w]=_;l[_]=b,p=m}return l}function w(t,n,r){var i=t.data.symmetryInfo;if(!i||i.cellSize[0]<1.1&&i.cellSize[1]<1.1&&i.cellSize[2]<1.1)return t;var o;o=r?e.Query.apply(r,t).unionAtomIndices():t.data.atoms.indices;var s=m(t,o),a=new e.Spacegroup(i),u=h(t,s,a,n),c=y(u);return b(t,g(u,c),c)}function x(t,n){for(var i=r(t.positions,t.positions.indices),s=new e.Spacegroup(t.data.symmetryInfo),a=T.empty(),u={x:0,y:0,z:0},c=[],h=-3;h<=3;h++)for(var f=-3;f<=3;f++)for(var d=-3;d<=3;d++)for(var p=0;p<s.operatorCount;p++)if(s.getOperatorMatrix(p,h,f,d,a),T.transformVector3(u,i.center,a),!(o(u,i.radius,i)>n)){var m=T.empty();T.copy(m,a),c.push(l(h,f,d,p,m))}return c}function C(e,n){for(var r=e.data,i=r.atoms,o=r.chains,s=r.entities,a=r.residues,u=t.Utils.ArrayBuilder.create(function(t){return new Int32Array(t)},a.count*n.length,1),c=t.Utils.ArrayBuilder.create(function(t){return new Int32Array(t)},a.count*n.length,1),h=n.length*i.count,f=n.length*o.count,d=s.count,l=0,p=s.count;l<p;l++)for(var m=0;m<n.length;m++)for(var y=s.chainStartIndex[l],g=s.chainEndIndex[l];y<g;y++)for(var v=o.residueStartIndex[y],b=o.residueEndIndex[y];v<b;v++)t.Utils.ArrayBuilder.add(u,v),t.Utils.ArrayBuilder.add(c,m);return{residues:u.array,operators:c.array,atomCount:h,chainCount:f,entityCount:d}}function I(t,e){var n=t.data.symmetryInfo;if(!n||n.cellSize[0]<1.1&&n.cellSize[1]<1.1&&n.cellSize[2]<1.1)return t;var r=x(t,e);return b(t,C(t,r),r)}function S(t,e,n,r){if(n<0)return void(e[e.length]=r.slice(0));for(var i=t[n],o=i.length,s=0;s<o;s++)r[n]=i[s],S(t,e,n-1,r)}function A(t,e){for(var n=t.data.assemblyInfo,r=[],i=0,o=0,s=e;o<s.length;o++){for(var a=s[o],u=T.identity(),c=0;c<a.length;c++)T.mul(u,u,n.operators[a[c]].operator);i++,r[r.length]=p(i,u)}return r}function k(e,n,r,i){for(var o=e.data,s=o.chains,a=o.entities,u=o.residues,c=i.residueIndices,h=i.operatorIndices,f=0,d=0,l=0,p=0,m=a.count;p<m;p++){for(var y=i.transformsOffset,g=!1,v=0,b=r;v<b.length;v++){for(var _=(b[v],a.chainStartIndex[p]),w=a.chainEndIndex[p];_<w;_++){for(var x=!1,C=s.residueStartIndex[_],I=s.residueEndIndex[_];C<I;C++)n[C]&&(t.Utils.ChunkedArray.add(c,C),t.Utils.ChunkedArray.add(h,y),f+=u.atomEndIndex[C]-u.atomStartIndex[C],x=!0);x&&(d+=1,g=!0)}y++}g&&l++}i.atomCount+=f,i.chainCount+=d,i.entityCount+=l}function E(e,n,r){for(var i=[],o=[],s=0;s<n.operators.length;s++)o[s]="";S(n.operators,i,n.operators.length-1,o);var a=A(e,i);r.transformsOffset+=r.transforms.length,(l=r.transforms).push.apply(l,a);var u=t.Utils.FastSet.create();n.asymIds.forEach(function(t){return u.add(t)});for(var c=e.data.residues.asymId,h=e.data.residues.count,f=r.mask,d=0;d<h;d++)f[d]=u.has(c[d]);k(e,f,a,r);var l}function P(e,n){for(var r={atomCount:0,chainCount:0,entityCount:0,transforms:[],transformsOffset:0,mask:new Int8Array(e.data.residues.count),residueIndices:t.Utils.ChunkedArray.create(function(t){return new Int32Array(t)},e.data.residues.count,1),operatorIndices:t.Utils.ChunkedArray.create(function(t){return new Int32Array(t)},e.data.residues.count,1)},i=0,o=n.gens;i<o.length;i++){E(e,o[i],r)}return b(e,{residues:t.Utils.ChunkedArray.compact(r.residueIndices),operators:t.Utils.ChunkedArray.compact(r.operatorIndices),atomCount:r.atomCount,chainCount:r.chainCount,entityCount:r.entityCount},r.transforms)}var T=t.Geometry.LinearAlgebra.Matrix4;n.buildPivotGroupSymmetry=w,n.buildMates=I,n.buildAssemblyEntry=E,n.buildAssembly=P}(o||(o={})),e.buildPivotGroupSymmetry=n,e.buildSymmetryMates=r,e.buildAssembly=i}(t.Structure||(t.Structure={}))}(t.Core||(t.Core={}))}(o||(o={}));var o;!function(t){!function(t){!function(e){!function(e){function n(t,n){return e.Builder.toQuery(t)(n.queryContext)}e.apply=n;var r=function(){function e(t,e){this.structure=t,this.mask=e}return Object.defineProperty(e.prototype,"atomCount",{get:function(){return this.mask.size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isComplete",{get:function(){return this.mask.size===this.structure.data.atoms.count},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tree",{get:function(){return this.lazyTree||this.makeTree(),this.lazyTree},enumerable:!0,configurable:!0}),e.prototype.hasAtom=function(t){return!!this.mask.has(t)},e.prototype.hasRange=function(t,e){for(var n=t;n<e;n++)if(this.mask.has(n))return!0;return!1},e.ofStructure=function(t){return new e(t,e.Mask.ofStructure(t))},e.ofFragments=function(t){return new e(t.context.structure,e.Mask.ofFragments(t))},e.ofAtomIndices=function(t,n){return new e(t,e.Mask.ofIndices(t,n))},e.prototype.makeTree=function(){for(var e=new Int32Array(this.mask.size),n=0,r=this.structure.positions,i=r.x,o=r.y,s=r.z,a=0,u=this.structure.positions.count;a<u;a++)this.mask.has(a)&&(e[n++]=a);this.lazyTree=t.Geometry.SubdivisionTree3D.create(e,function(t,e){return e(i[t],o[t],s[t])})},e}();e.Context=r,function(e){!function(e){function n(t){return new s(t.data.atoms.count)}function r(e,n){if(n.length/e.data.atoms.count<.25){for(var r=t.Utils.FastSet.create(),i=0,s=n;i<s.length;i++){var a=s[i];r.add(a)}return r}for(var u=new Int8Array(e.data.atoms.count),c=0,h=n;c<h.length;c++){var a=h[c];u[a]=1}return new o(u,n.length)}function i(e){for(var n=0,r=0,i=e.fragments;r<i.length;r++){var s=i[r];n+=s.atomCount}var a=e.context.structure.data.atoms.count;if(n/a<.25){for(var u=t.Utils.FastSet.create(),c=0,h=e.fragments;c<h.length;c++)for(var s=h[c],f=0,d=s.atomIndices;f<d.length;f++){var l=d[f];u.add(l)}return u}for(var u=new Int8Array(a),p=0,m=e.fragments;p<m.length;p++)for(var s=m[p],y=0,g=s.atomIndices;y<g.length;y++){var l=g[y];u[l]=1}for(var v=0,l=0;l<a;l++)0!==u[l]&&v++;return new o(u,v)}var o=function(){function t(t,e){this.mask=t,this.size=e}return t.prototype.has=function(t){return this.mask[t]},t}(),s=function(){function t(t){this.size=t}return t.prototype.has=function(t){return!0},t}();e.ofStructure=n,e.ofIndices=r,e.ofFragments=i}(e.Mask||(e.Mask={}))}(r=e.Context||(e.Context={}));var i=function(){function n(t,e,n){this._hashCode=0,this._hashComputed=!1,this.context=t,this.tag=e,this.atomIndices=n}return Object.defineProperty(n.prototype,"hashCode",{get:function(){if(this._hashComputed)return this._hashCode;for(var t=23,e=0,n=this.atomIndices;e<n.length;e++){t=31*t+n[e]|0}return this._hashCode=t,this._hashComputed=!0,t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"id",{get:function(){return this.context.structure.id+"_"+this.tag},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"atomCount",{get:function(){return this.atomIndices.length},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isHet",{get:function(){var t=this.context.structure.data.atoms.residueIndex[this.tag];return this.context.structure.data.residues.isHet[t]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"fingerprint",{get:function(){if(this._fingerprint)return this._fingerprint;for(var t=this.residueIndices,e=this.context.structure.data.residues,n=e.name,r=e.asymId,i=e.seqNumber,o=e.insCode,s=[],a=0,u=t;a<u.length;a++){var c=u[a],h=n[c]+" "+r[c]+" "+i[c];o[c]&&(h+=" i:"+o[c]),s[s.length]=h}return s.join("-")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"authFingerprint",{get:function(){if(this._authFingerprint)return this._authFingerprint;for(var t=this.residueIndices,e=this.context.structure.data.residues,n=e.authName,r=e.authAsymId,i=e.authSeqNumber,o=e.insCode,s=[],a=0,u=t;a<u.length;a++){var c=u[a],h=n[c]+" "+r[c]+" "+i[c];o[c]&&(h+=" i:"+o[c]),s[s.length]=h}return s.join("-")},enumerable:!0,configurable:!0}),n.prototype.find=function(t){var n=r.ofFragments(new o(this.context,[this]));return e.Builder.toQuery(t)(n)},n.prototype.computeIndices=function(){if(!this._residueIndices){for(var e=t.Utils.FastSet.create(),n=t.Utils.FastSet.create(),r=t.Utils.FastSet.create(),i=this.context.structure.data.atoms.residueIndex,o=this.context.structure.data.residues.chainIndex,s=this.context.structure.data.chains.entityIndex,a=0,u=this.atomIndices;a<u.length;a++){var c=u[a];e.add(i[c])}this._residueIndices=t.Utils.integerSetToSortedTypedArray(e);for(var h=0,f=this._residueIndices;h<f.length;h++){var c=f[h];n.add(o[c])}this._chainIndices=t.Utils.integerSetToSortedTypedArray(n);for(var d=0,l=this._chainIndices;d<l.length;d++){var c=l[d];r.add(s[c])}this._entityIndices=t.Utils.integerSetToSortedTypedArray(r)}},Object.defineProperty(n.prototype,"residueIndices",{get:function(){return this.computeIndices(),this._residueIndices},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"chainIndices",{get:function(){return this.computeIndices(),this._chainIndices},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"entityIndices",{get:function(){return this.computeIndices(),this._entityIndices},enumerable:!0,configurable:!0}),n.areEqual=function(t,e){if(t.atomCount!==e.atomCount)return!1;for(var n=t.atomIndices,r=e.atomIndices,i=0;i<n.length;i++)if(n[i]!==r[i])return!1;return t.tag===e.tag},n.ofSet=function(t,e){var r=new Int32Array(e.size);return e.forEach(function(t,e){e.array[e.index++]=t},{array:r,index:0}),Array.prototype.sort.call(r,function(t,e){return t-e}),new n(t,r[0],r)},n.ofArray=function(t,e,r){return new n(t,e,r)},n.ofIndex=function(t,e){var r=new Int32Array(1);return r[0]=e,new n(t,e,r)},n.ofIndexRange=function(t,e,r){for(var i=0,o=e;o<r;o++)t.hasAtom(o)&&i++;for(var s=new Int32Array(i),a=0,o=e;o<r;o++)t.hasAtom(o)&&(s[a++]=o);return new n(t,e,s)},n}();e.Fragment=i;var o=function(){function t(t,e){this.context=t,this.fragments=e}return t.empty=function(e){return new t(e,[])},Object.defineProperty(t.prototype,"length",{get:function(){return this.fragments.length},enumerable:!0,configurable:!0}),t.prototype.unionAtomIndices=function(){if(!this.length)return[];if(1===this.length)return this.fragments[0].atomIndices;for(var t=new Int8Array(this.context.structure.data.atoms.count),e=0,n=0,r=this.fragments;n<r.length;n++)for(var i=r[n],o=0,s=i.atomIndices;o<s.length;o++){var a=s[o];t[a]=1}for(var u=0,c=t;u<c.length;u++){var a=c[u];e+=a}for(var h=new Int32Array(e),f=0,a=0,d=t.length;a<d;a++)t[a]&&(h[f++]=a);return h},t.prototype.unionFragment=function(){if(!this.length)return new i(this.context,0,new Int32Array(0));if(1===this.length)return this.fragments[0];var t=this.unionAtomIndices();return new i(this.context,t[0],t)},t}();e.FragmentSeq=o;var s=function(){function t(t){this.ctx=t,this.fragments=[]}return t.prototype.add=function(t){this.fragments[this.fragments.length]=t},t.prototype.getSeq=function(){return new o(this.ctx,this.fragments)},t}();e.FragmentSeqBuilder=s;var a=function(){function e(e){this.ctx=e,this.fragments=[],this.byHash=t.Utils.FastMap.create()}return e.prototype.add=function(t){var e=t.hashCode;if(this.byHash.has(e)){for(var n=this.byHash.get(e),r=0,o=n;r<o.length;r++){var s=o[r];if(i.areEqual(t,s))return this}this.fragments[this.fragments.length]=t,n[n.length]=t}else this.fragments[this.fragments.length]=t,this.byHash.set(e,[t]);return this},e.prototype.getSeq=function(){return new o(this.ctx,this.fragments)},e}();e.HashFragmentSeqBuilder=a}(e.Query||(e.Query={}))}(t.Structure||(t.Structure={}))}(t.Core||(t.Core={}))}(o||(o={}));var o;!function(t){!function(t){!function(e){!function(e){function n(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return M.build(function(){return N.compileAtoms(t,function(t){return t.data.atoms.elementSymbol})})}function r(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return M.build(function(){return N.compileAtoms(t,function(t){return t.data.atoms.name})})}function i(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return M.build(function(){return N.compileAtoms(t,function(t){return t.data.atoms.id})})}function o(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return M.build(function(){return N.compileAtomRanges(!1,t,function(t){return t.data.residues})})}function s(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return M.build(function(){return N.compileAtomRanges(!1,t,function(t){return t.data.chains})})}function a(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return M.build(function(){return N.compileAtomRanges(!1,t,function(t){return t.data.entities})})}function u(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return M.build(function(){return N.compileAtomRanges(!0,t,function(t){return t.data.entities})})}function c(){return M.build(function(){return N.compileEverything()})}function h(t){return M.build(function(){return N.compileFromIndices(!1,t,function(t){return t.data.entities})})}function f(t){return M.build(function(){return N.compileFromIndices(!1,t,function(t){return t.data.chains})})}function d(t){return M.build(function(){return N.compileFromIndices(!1,t,function(t){return t.data.residues})})}function l(t){return M.build(function(){return N.compileAtomIndices(t)})}function p(t,e,n,r){return M.build(function(){return N.compileSequence(t,e,n,r)})}function m(){return M.build(function(){return N.compileHetGroups()})}function y(){return M.build(function(){return N.compileNonHetPolymer()})}function g(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return M.build(function(){return N.compilePolymerNames(t,!1)})}function v(){return x(M.build(function(){return N.compilePolymerNames(["CA","O","O5'","C3'","N3"],!1)}),m(),a({type:"water"}))}function b(){return M.build(function(){return N.compilePolymerNames(["N","CA","C","O","P","OP1","OP2","O3'","O5'","C3'","C5'","C4"],!1)})}function _(){return M.build(function(){return N.compilePolymerNames(["N","CA","C","O","P","OP1","OP2","O3'","O5'","C3'","C5'","C4"],!0)})}function w(t,e){return M.build(function(){return N.compileAtomsInBox(t,e)})}function x(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return M.build(function(){return N.compileOr(t)})}function C(t){return M.build(function(){return N.compileComplement(t)})}function I(t,e){return M.build(function(){return N.compileAmbientResidues(t,e)})}function S(t){return M.build(function(){return N.compileWholeResidues(t)})}function A(t){return M.build(function(){return N.compileUnion(t)})}function k(t,e){return M.build(function(){return N.compileInside(t,e)})}function E(t,e){return M.build(function(){return N.compileIntersectWith(t,e)})}function P(t,e){return M.build(function(){return N.compileFlatten(t,e)})}function T(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return o.apply(void 0,t.map(function(t){return{name:t}}))}function F(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return o.apply(void 0,t.map(function(t){return{authSeqNumber:t}}))}function D(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return s.apply(void 0,t.map(function(t){return{authAsymId:t}}))}var M;!function(t){function e(e,n){t.BuilderPrototype[e]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return n.call.apply(n,[void 0,this].concat(t))}}function n(e){return Object.create(t.BuilderPrototype,{compile:{writable:!1,configurable:!1,value:e}})}function r(t){return!!t.compile}function i(t){if("undefined"==typeof window)throw"parse can only be called from a browser.";(0,eval)("with (LiteMol.Core.Structure.Query) { window.__LiteMol_query = "+t+"; }");var e=window.__LiteMol_query;return window.__LiteMol_query=void 0,e.compile()}function o(t){return r(t)?t.compile():"string"==typeof t||t instanceof String?i(t):t}t.BuilderPrototype={},t.registerModifier=e,t.build=n,t.parse=i,t.toQuery=o}(M=e.Builder||(e.Builder={})),e.atomsByElement=n,e.atomsByName=r,e.atomsById=i,e.residues=o,e.chains=s,e.entities=a,e.notEntities=u,e.everything=c,e.entitiesFromIndices=h,e.chainsFromIndices=f,e.residuesFromIndices=d,e.atomsFromIndices=l,e.sequence=p,e.hetGroups=m,e.nonHetPolymer=y,e.polymerTrace=g,e.cartoons=v,e.backbone=b,e.sidechain=_,e.atomsInBox=w,e.or=x,M.registerModifier("complement",C),e.complement=C,M.registerModifier("ambientResidues",I),e.ambientResidues=I,M.registerModifier("wholeResidues",S),e.wholeResidues=S,M.registerModifier("union",A),e.union=A,M.registerModifier("inside",k),e.inside=k,M.registerModifier("intersectWith",E),e.intersectWith=E,M.registerModifier("flatten",P),e.flatten=P,e.residuesByName=T,e.residuesById=F,e.chainsById=D;var N;!function(n){function r(){return function(t){if(t.isComplete){var n=t.structure.data.atoms.indices;return new e.FragmentSeq(t,[new e.Fragment(t,n[0],n)])}for(var r=new Int32Array(t.atomCount),i=0,o=0,s=t.structure.data.atoms.indices;o<s.length;o++){var a=s[o];t.hasAtom(a)&&(r[i++]=a)}return new e.FragmentSeq(t,[e.Fragment.ofArray(t,r[0],r)])}}function i(n,r){return function(i){for(var o=t.Utils.FastSet.ofArray(n),s=r(i.structure),a=new e.FragmentSeqBuilder(i),u=0,c=s.length;u<c;u++)i.hasAtom(u)&&o.has(s[u])&&a.add(e.Fragment.ofIndex(i,u));return a.getSeq()}}function o(t){return function(n){for(var r=0,i=0,o=t;i<o.length;i++){var s=o[i];n.hasAtom(s)&&r++}if(!r)return e.FragmentSeq.empty(n);for(var a=0,u=new Int32Array(r),c=0,h=t;c<h.length;c++){var s=h[c];n.hasAtom(s)&&(u[a++]=s)}return new e.FragmentSeq(n,[e.Fragment.ofArray(n,u[0],u)])}}function s(n,r,i){return function(o){var s=i(o.structure),a=s.atomStartIndex,u=s.atomEndIndex,c=new e.FragmentSeqBuilder(o);if(n)for(var h=t.Utils.FastSet.ofArray(r),f=s.count,d=0;d<f;d++)h.has(d)||o.hasRange(a[d],u[d])&&c.add(e.Fragment.ofIndexRange(o,a[d],u[d]));else for(var l=0,p=r;l<p.length;l++){var d=p[l];o.hasRange(a[d],u[d])&&c.add(e.Fragment.ofIndexRange(o,a[d],u[d]))}return c.getSeq()}}function a(t,n,r){return function(i){for(var o=r(i.structure),s=o.atomStartIndex,a=o.atomEndIndex,u=new e.FragmentSeqBuilder(i),c=o.count,h=!1,f=n.map(function(t){return new C(t,o)}),d=0===f.length,l=0;l<c;l++)if(i.hasRange(s[l],a[l])){h=d;for(var p=0,m=f;p<m.length;p++){var y=m[p];if(y.isSatisfied(l)){h=!0;break}}t&&(h=!h),h&&u.add(e.Fragment.ofIndexRange(i,s[l],a[l]))}return u.getSeq()}}function u(t,n,r,i){return function(o){for(var s=o.structure.data,a=s.residues,u=s.chains,c=a.seqNumber,h=a.atomStartIndex,f=a.atomEndIndex,d=u.entityId,l=u.count,p=u.residueStartIndex,m=u.residueEndIndex,y=new e.FragmentSeqBuilder(o),g=o.structure.parent,v=u.sourceChainIndex,b=g&&v,_="string"==typeof n?{asymId:n}:n,w=new C(_,b?g.data.chains:u),x=0;x<l;x++)if(d[x]===t&&w.isSatisfied(b?v[x]:x)){for(var I=p[x],S=m[x],A=-1,k=-1;I<S;I++)if(c[I]>=r.seqNumber){A=I;break}if(I!==S){for(I=A;I<S&&!(c[I]>=i.seqNumber);I++);k=I,o.hasRange(h[A],f[k])&&y.add(e.Fragment.ofIndexRange(o,h[A],f[k]))}}return y.getSeq()}}function c(){return function(t){for(var n=t.structure.data.residues,r=n.atomStartIndex,i=n.atomEndIndex,o=n.isHet,s=n.entityIndex,a=n.count,u=t.structure.data.entities.type,c=new e.FragmentSeqBuilder(t),h=0;h<a;h++)t.hasRange(r[h],i[h])&&"water"!==u[s[h]]&&o[h]&&c.add(e.Fragment.ofIndexRange(t,r[h],i[h]));return c.getSeq()}}function h(){return function(t){for(var n=t.structure.data.residues,r=n.atomStartIndex,i=n.atomEndIndex,o=t.structure.data.entities,s=o.type,a=o.count,u=o.residueStartIndex,c=o.residueEndIndex,h=0,f=0;f<a;f++)if("polymer"===s[f])for(var d=u[f],l=c[f];d<l;d++)for(var p=r[d],m=i[d];p<m;p++)t.hasAtom(p)&&h++;if(!h)return e.FragmentSeq.empty(t);for(var y=new Int32Array(h),g=0,f=0;f<a;f++)if("polymer"===s[f])for(var d=u[f],l=c[f];d<l;d++)for(var p=r[d],m=i[d];p<m;p++)t.hasAtom(p)&&(y[g++]=p);return new e.FragmentSeq(t,[e.Fragment.ofArray(t,y[0],y)])}}function f(t,n){return function(r){for(var i=r.structure.positions,o=i.x,s=i.y,a=i.z,u=i.count,c=[],h=0;h<u;h++)if(r.hasAtom(h)){var f=o[h],d=s[h],l=a[h];f>=t.x&&f<=n.x&&d>=t.y&&d<=n.y&&l>=t.z&&l<=n.z&&(c[c.length]=h)}return c.length?new e.FragmentSeq(r,[new e.Fragment(r,c[0],c)]):e.FragmentSeq.empty(r)}}function d(t,n){var r=M.toQuery(t),i=M.toQuery(n);return function(t){return new e.FragmentSeq(t,r(e.Context.ofFragments(i(t))).fragments)}}function l(t,n,r){for(var i=0,o=0,s=n.atomIndices;o<s.length;o++){var a=s[o];r.has(a)&&i++}if(i){for(var u=new Int32Array(i),c=0,h=0,f=n.atomIndices;h<f.length;h++){var a=f[h];r.has(a)&&(u[c++]=a)}return e.Fragment.ofArray(t,u[0],u)}}function p(t,n){var r=M.toQuery(t),i=M.toQuery(n);return function(t){for(var n=r(t),o=e.Context.Mask.ofFragments(i(t)),s=new e.FragmentSeqBuilder(t),a=0,u=n.fragments;a<u.length;a++){var c=u[a],h=l(t,c,o);h&&s.add(h)}return s.getSeq()}}function m(t,n){var r=M.toQuery(t);return function(t){for(var i,o=r(t).fragments,s=new e.FragmentSeqBuilder(t),a=0;a<o.length;a++)i=o[a],n(i)&&s.add(i);return s.getSeq()}}function y(t){var n=M.toQuery(t);return function(t){for(var r=e.Context.Mask.ofFragments(n(t)),i=0,o=0,s=0,a=t.structure.data.atoms.count;s<a;s++)t.hasAtom(s)&&!r.has(s)&&i++;if(!i)return e.FragmentSeq.empty(t);for(var u=new Int32Array(i),s=0,a=t.structure.data.atoms.count;s<a;s++)t.hasAtom(s)&&!r.has(s)&&(u[o++]=s);return new e.FragmentSeq(t,[e.Fragment.ofArray(t,u[0],u)])}}function g(t){var n=t.map(function(t){return M.toQuery(t)});return function(t){for(var r=new e.HashFragmentSeqBuilder(t),i=0,o=n;i<o.length;i++)for(var s=o[i],a=s(t),u=0,c=a.fragments;u<c.length;u++){var h=c[u];r.add(h)}return r.getSeq()}}function v(n){var r=M.toQuery(n);return function(n){for(var i,o=r(n).fragments,s=t.Utils.FastSet.create(),a=0,u=0;u<o.length;u++)for(i=o[u].atomIndices,a=0;a<i.length;a++)s.add(i[a]);return 0===s.size?e.FragmentSeq.empty(n):new e.FragmentSeq(n,[e.Fragment.ofSet(n,s)])}}function b(n,r){return function(i){var o=i.structure,s=o.data.entities,a=o.data.atoms.name,u=[],c=0,h=t.Utils.FastSet.ofArray(n);if(r){for(var f=0;f<o.data.entities.count;f++)if("polymer"===s.type[f])for(var d=s.atomStartIndex[f],l=s.atomEndIndex[f],p=d;p<l;p++)i.hasAtom(p)&&!h.has(a[p])&&(u[c++]=p)}else for(var f=0;f<s.count;f++)if("polymer"===s.type[f])for(var d=s.atomStartIndex[f],l=s.atomEndIndex[f],p=d;p<l;p++)i.hasAtom(p)&&h.has(a[p])&&(u[c++]=p);return u.length?new e.FragmentSeq(i,[e.Fragment.ofArray(i,u[0],new Int32Array(u))]):e.FragmentSeq.empty(i)}}function _(n,r){var i=M.toQuery(n);return function(n){for(var o=i(n),s=n.tree,a=t.Geometry.SubdivisionTree3D.createContextRadius(s,r,!1),u=a.buffer,c=new e.HashFragmentSeqBuilder(n),h=n.structure.positions,f=h.x,d=h.y,l=h.z,p=n.structure.data.atoms.residueIndex,m=n.structure.data.residues.atomStartIndex,y=n.structure.data.residues.atomEndIndex,g=s.data,v=0,b=o.fragments;v<b.length;v++){for(var _=b[v],w=t.Utils.FastSet.create(),x=0,C=_.atomIndices;x<C.length;x++){var I=C[x];w.add(p[I]),a.nearest(f[I],d[I],l[I],r);for(var S=0,A=u.count;S<A;S++)w.add(p[g[u.indices[S]]])}var k={count:0,start:m,end:y};w.forEach(function(t,e){e.count+=e.end[t]-e.start[t]},k);var E=new Int32Array(k.count),P={indices:E,offset:0,start:m,end:y};w.forEach(function(t,e){for(var n=e.start[t],r=e.end[t];n<r;n++)e.indices[e.offset++]=n},P),Array.prototype.sort.call(E,function(t,e){return t-e}),c.add(e.Fragment.ofArray(n,E[0],E))}return c.getSeq()}}function w(n){var r=M.toQuery(n);return function(n){for(var i=r(n),o=new e.HashFragmentSeqBuilder(n),s=n.structure.data.atoms.residueIndex,a=n.structure.data.residues.atomStartIndex,u=n.structure.data.residues.atomEndIndex,c=0,h=i.fragments;c<h.length;c++){for(var f=h[c],d=t.Utils.FastSet.create(),l=0,p=f.atomIndices;l<p.length;l++){var m=p[l];d.add(s[m])}var y={count:0,start:a,end:u};d.forEach(function(t,e){e.count+=e.end[t]-e.start[t]},y);var g=new Int32Array(y.count),v={indices:g,offset:0,start:a,end:u};d.forEach(function(t,e){for(var n=e.start[t],r=e.end[t];n<r;n++)e.indices[e.offset++]=n},v),Array.prototype.sort.call(g,function(t,e){return t-e}),o.add(e.Fragment.ofArray(n,g[0],g))}return o.getSeq()}}function x(t,n){var r=M.toQuery(t);return function(t){for(var i=r(t),o=new e.HashFragmentSeqBuilder(t),s=0,a=i.fragments;s<a.length;s++)for(var u=a[s],c=n(u),h=0,f=c.fragments;h<f.length;h++){var d=f[h];o.add(d)}return o.getSeq()}}var C=function(){function t(t,e){this.columns=[];for(var n=0,r=Object.keys(t);n<r.length;n++){var i=r[n];void 0!==t[i]&&e[i]&&this.columns.push({value:t[i],array:e[i]})}}return t.prototype.isSatisfied=function(t){for(var e=0,n=this.columns;e<n.length;e++){var r=n[e];if(r.value!==r.array[t])return!1}return!0},t}();n.compileEverything=r,n.compileAtoms=i,n.compileAtomIndices=o,n.compileFromIndices=s,n.compileAtomRanges=a,n.compileSequence=u,n.compileHetGroups=c,n.compileNonHetPolymer=h,n.compileAtomsInBox=f,n.compileInside=d,n.compileIntersectWith=p,n.compileFilter=m,n.compileComplement=y,n.compileOr=g,n.compileUnion=v,n.compilePolymerNames=b,n.compileAmbientResidues=_,n.compileWholeResidues=w,n.compileFlatten=x}(N=e.Compiler||(e.Compiler={}))}(e.Query||(e.Query={}))}(t.Structure||(t.Structure={}))}(t.Core||(t.Core={}))}(o||(o={}));var o;return function(t){!function(t){!function(e){!function(e){!function(n){function r(t){return function(e,n){return function(r,i){return t(e(r,i),n(r,i))}}}function i(t){return function(e,n){return function(r,i){return t(e(r,i),n(r,i))}}}function o(t,e,n){return function(r,i){var o=t(r,i);return o>=e&&o<=n}}function s(t){return function(){return t}}function a(t,e,n){return function(r,i){var o=r.structure;return n(e(o))[t(o.data.atoms)[i]]}}function u(t){return e.Builder.build(function(){return function(n){for(var r=[],i=0,o=n.structure.data.atoms.count;i<o;i++)n.hasAtom(i)&&t(n,i)&&(r[r.length]=i);return r.length?new e.FragmentSeq(n,[e.Fragment.ofArray(n,r[0],new Int32Array(r))]):e.FragmentSeq.empty(n)}})}n.not=function(t){return function(e){return function(n,r){return t(e(n,r))}}}(function(t){return!t}),n.and=r(function(t,e){return t&&e}),n.or=r(function(t,e){return t||e});var c=t.Utils.FastSet.ofArray(["N","CA","C","O","P","OP1","OP2","O3'","O5'","C3'","C5'","C4"]);n.backbone=function(t,e){return"polymer"===n.entityType(t,e)&&c.has(n.atomName(t,e))},n.sidechain=function(t,e){return"polymer"===n.entityType(t,e)&&!c.has(n.atomName(t,e))},n.equal=i(function(t,e){return t===e}),n.notEqual=i(function(t,e){return t!==e}),n.greater=i(function(t,e){return t>e}),n.lesser=i(function(t,e){return t<e}),n.greaterEqual=i(function(t,e){return t>=e}),n.lesserEqual=i(function(t,e){return t<=e}),n.inRange=o,n.value=s,n.residueSeqNumber=a(function(t){return t.residueIndex},function(t){return t.data.residues},function(t){return t.seqNumber}),n.residueName=a(function(t){return t.residueIndex},function(t){return t.data.residues},function(t){return t.name}),n.elementSymbol=a(function(t){return t.indices},function(t){return t.data.atoms},function(t){return t.elementSymbol}),n.atomName=a(function(t){return t.indices},function(t){return t.data.atoms},function(t){return t.name}),n.entityType=a(function(t){return t.entityIndex},function(t){return t.data.entities},function(t){return t.type}),n.query=u}(e.Algebraic||(e.Algebraic={}))}(e.Query||(e.Query={}))}(t.Structure||(t.Structure={}))}(t.Core||(t.Core={}))}(o||(o={})),o.Core};if("object"==typeof module&&"object"==typeof module.exports)module.exports=__LiteMol_Core();else if("function"==typeof define&&define.amd)define(["require"],function(t){return __LiteMol_Core()});else{var __target=window?window:this;__target.LiteMol||(__target.LiteMol={}),__target.LiteMol.Core=__LiteMol_Core()}